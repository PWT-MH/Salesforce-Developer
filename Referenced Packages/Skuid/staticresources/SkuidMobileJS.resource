/*! Skuid 6.8.7 26-02-2015 */
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011â€“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery),/*! Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.io/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(a,b){"use strict";function c(){d.READY||(s.determineEventTypes(),r.each(d.gestures,function(a){u.register(a)}),s.onTouch(d.DOCUMENT,n,u.detect),s.onTouch(d.DOCUMENT,o,u.detect),d.READY=!0)}var d=function v(a,b){return new v.Instance(a,b||{})};d.VERSION="1.1.3",d.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},d.DOCUMENT=document,d.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,d.HAS_TOUCHEVENTS="ontouchstart"in a,d.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&d.IS_MOBILE||d.HAS_POINTEREVENTS,d.CALCULATE_INTERVAL=25;var e={},f=d.DIRECTION_DOWN="down",g=d.DIRECTION_LEFT="left",h=d.DIRECTION_UP="up",i=d.DIRECTION_RIGHT="right",j=d.POINTER_MOUSE="mouse",k=d.POINTER_TOUCH="touch",l=d.POINTER_PEN="pen",m=d.EVENT_START="start",n=d.EVENT_MOVE="move",o=d.EVENT_END="end",p=d.EVENT_RELEASE="release",q=d.EVENT_TOUCH="touch";d.READY=!1,d.plugins=d.plugins||{},d.gestures=d.gestures||{};var r=d.utils={extend:function(a,c,d){for(var e in c)!c.hasOwnProperty(e)||a[e]!==b&&d||(a[e]=c[e]);return a},on:function(a,b,c){a.addEventListener(b,c,!1)},off:function(a,b,c){a.removeEventListener(b,c,!1)},each:function(a,c,d){var e,f;if("forEach"in a)a.forEach(c,d);else if(a.length!==b){for(e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&c.call(d,a[e],e,a)===!1)return},inStr:function(a,b){return a.indexOf(b)>-1},inArray:function(a,b){if(a.indexOf){var c=a.indexOf(b);return-1===c?!1:c}for(var d=0,e=a.length;e>d;d++)if(a[d]===b)return d;return!1},toArray:function(a){return Array.prototype.slice.call(a,0)},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[],d=[],e=[],f=Math.min,g=Math.max;return 1===a.length?{pageX:a[0].pageX,pageY:a[0].pageY,clientX:a[0].clientX,clientY:a[0].clientY}:(r.each(a,function(a){b.push(a.pageX),c.push(a.pageY),d.push(a.clientX),e.push(a.clientY)}),{pageX:(f.apply(Math,b)+g.apply(Math,b))/2,pageY:(f.apply(Math,c)+g.apply(Math,c))/2,clientX:(f.apply(Math,d)+g.apply(Math,d))/2,clientY:(f.apply(Math,e)+g.apply(Math,e))/2})},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return 180*Math.atan2(d,c)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.clientX-b.clientX),d=Math.abs(a.clientY-b.clientY);return c>=d?a.clientX-b.clientX>0?g:i:a.clientY-b.clientY>0?h:f},getDistance:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==h||a==f},setPrefixedCss:function(a,b,c,d){var e=["","Webkit","Moz","O","ms"];b=r.toCamelCase(b);for(var f=0;f<e.length;f++){var g=b;if(e[f]&&(g=e[f]+g.slice(0,1).toUpperCase()+g.slice(1)),g in a.style){a.style[g]=(null==d||d)&&c||"";break}}},toggleBehavior:function(a,b,c){if(b&&a&&a.style){r.each(b,function(b,d){r.setPrefixedCss(a,d,b,c)});var d=c&&function(){return!1};"none"==b.userSelect&&(a.onselectstart=d),"none"==b.userDrag&&(a.ondragstart=d)}},toCamelCase:function(a){return a.replace(/[_-]([a-z])/g,function(a){return a[1].toUpperCase()})}},s=d.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(a,b,c,d){var e=b.split(" ");r.each(e,function(b){r.on(a,b,c),d&&d(b)})},off:function(a,b,c,d){var e=b.split(" ");r.each(e,function(b){r.off(a,b,c),d&&d(b)})},onTouch:function(a,b,c){var f=this,g=function(e){var g,h=e.type.toLowerCase(),i=d.HAS_POINTEREVENTS,j=r.inStr(h,"mouse");j&&f.preventMouseEvents||(j&&b==m&&0===e.button?(f.preventMouseEvents=!1,f.shouldDetect=!0):i&&b==m?f.shouldDetect=1===e.buttons||t.matchType(k,e):j||b!=m||(f.preventMouseEvents=!0,f.shouldDetect=!0),i&&b!=o&&t.updatePointer(b,e),f.shouldDetect&&(g=f.doDetect.call(f,e,b,a,c)),g==o&&(f.preventMouseEvents=!1,f.shouldDetect=!1,t.reset()),i&&b==o&&t.updatePointer(b,e))};return this.on(a,e[b],g),g},doDetect:function(a,b,c,d){var e=this.getTouchList(a,b),f=e.length,g=b,h=e.trigger,i=f;b==m?h=q:b==o&&(h=p,i=e.length-(a.changedTouches?a.changedTouches.length:1)),i>0&&this.started&&(g=n),this.started=!0;var j=this.collectEventData(c,g,e,a);return b!=o&&d.call(u,j),h&&(j.changedLength=i,j.eventType=h,d.call(u,j),j.eventType=g,delete j.changedLength),g==o&&(d.call(u,j),this.started=!1),g},determineEventTypes:function(){var b;return b=d.HAS_POINTEREVENTS?a.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e[m]=b[0],e[n]=b[1],e[o]=b[2],e},getTouchList:function(a,b){if(d.HAS_POINTEREVENTS)return t.getTouchList();if(a.touches){if(b==n)return a.touches;var c=[],e=[].concat(r.toArray(a.touches),r.toArray(a.changedTouches)),f=[];return r.each(e,function(a){r.inArray(c,a.identifier)===!1&&f.push(a),c.push(a.identifier)}),f}return a.identifier=1,[a]},collectEventData:function(a,b,c,d){var e=k;return r.inStr(d.type,"mouse")||t.matchType(j,d)?e=j:t.matchType(l,d)&&(e=l),{center:r.getCenter(c),timeStamp:Date.now(),target:d.target,touches:c,eventType:b,pointerType:e,srcEvent:d,preventDefault:function(){var a=this.srcEvent;a.preventManipulation&&a.preventManipulation(),a.preventDefault&&a.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return u.stopDetect()}}}},t=d.PointerEvent={pointers:{},getTouchList:function(){var a=[];return r.each(this.pointers,function(b){a.push(b)}),a},updatePointer:function(a,b){a==o||a!=o&&1!==b.buttons?delete this.pointers[b.pointerId]:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b)},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,d={};return d[j]=c===(b.MSPOINTER_TYPE_MOUSE||j),d[k]=c===(b.MSPOINTER_TYPE_TOUCH||k),d[l]=c===(b.MSPOINTER_TYPE_PEN||l),d[a]},reset:function(){this.pointers={}}},u=d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:r.extend({},b),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst,c=b.options;return r.each(this.gestures,function(d){!this.stopped&&b.enabled&&c[d.name]&&d.handler.call(d,a,b)},this),this.current&&(this.current.lastEvent=a),a.eventType==o&&this.stopDetect(),a}},stopDetect:function(){this.previous=r.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(a,b,c,e,f){var g=this.current,h=!1,i=g.lastCalcEvent,j=g.lastCalcData;i&&a.timeStamp-i.timeStamp>d.CALCULATE_INTERVAL&&(b=i.center,c=a.timeStamp-i.timeStamp,e=a.center.clientX-i.center.clientX,f=a.center.clientY-i.center.clientY,h=!0),(a.eventType==q||a.eventType==p)&&(g.futureCalcEvent=a),(!g.lastCalcEvent||h)&&(j.velocity=r.getVelocity(c,e,f),j.angle=r.getAngle(b,a.center),j.direction=r.getDirection(b,a.center),g.lastCalcEvent=g.futureCalcEvent||a,g.futureCalcEvent=a),a.velocityX=j.velocity.x,a.velocityY=j.velocity.y,a.interimAngle=j.angle,a.interimDirection=j.direction},extendEventData:function(a){var b=this.current,c=b.startEvent,d=b.lastEvent||c;(a.eventType==q||a.eventType==p)&&(c.touches=[],r.each(a.touches,function(a){c.touches.push({clientX:a.clientX,clientY:a.clientY})}));var e=a.timeStamp-c.timeStamp,f=a.center.clientX-c.center.clientX,g=a.center.clientY-c.center.clientY;return this.getCalculatedData(a,d.center,e,f,g),r.extend(a,{startEvent:c,deltaTime:e,deltaX:f,deltaY:g,distance:r.getDistance(c.center,a.center),angle:r.getAngle(c.center,a.center),direction:r.getDirection(c.center,a.center),scale:r.getScale(c.touches,a.touches),rotation:r.getRotation(c.touches,a.touches)}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),r.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}};d.Instance=function(a,b){var e=this;c(),this.element=a,this.enabled=!0,r.each(b,function(a,c){delete b[c],b[r.toCamelCase(c)]=a}),this.options=r.extend(r.extend({},d.defaults),b||{}),this.options.behavior&&r.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=s.onTouch(a,m,function(a){e.enabled&&a.eventType==m?u.startDetect(e,a):a.eventType==q&&u.detect(a)}),this.eventHandlers=[]},d.Instance.prototype={on:function(a,b){var c=this;return s.on(c.element,a,b,function(a){c.eventHandlers.push({gesture:a,handler:b})}),c},off:function(a,b){var c=this;return s.off(c.element,a,b,function(a){var d=r.inArray({gesture:a,handler:b});d!==!1&&c.eventHandlers.splice(d,1)}),c},trigger:function(a,b){b||(b={});var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return r.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this},dispose:function(){var a,b;for(r.toggleBehavior(this.element,this.options.behavior,!1),a=-1;b=this.eventHandlers[++a];)r.off(this.element,b.gesture,b.handler);return this.eventHandlers=[],s.off(this.element,e[m],this.eventStartHandler),null}},function(a){function b(b,d){var e=u.current;if(!(d.options.dragMaxTouches>0&&b.touches.length>d.options.dragMaxTouches))switch(b.eventType){case m:c=!1;break;case n:if(b.distance<d.options.dragMinDistance&&e.name!=a)return;var j=e.startEvent.center;if(e.name!=a&&(e.name=a,d.options.dragDistanceCorrection&&b.distance>0)){var k=Math.abs(d.options.dragMinDistance/b.distance);j.pageX+=b.deltaX*k,j.pageY+=b.deltaY*k,j.clientX+=b.deltaX*k,j.clientY+=b.deltaY*k,b=u.extendEventData(b)}(e.lastEvent.dragLockToAxis||d.options.dragLockToAxis&&d.options.dragLockMinDistance<=b.distance)&&(b.dragLockToAxis=!0);var l=e.lastEvent.direction;b.dragLockToAxis&&l!==b.direction&&(b.direction=r.isVertical(l)?b.deltaY<0?h:f:b.deltaX<0?g:i),c||(d.trigger(a+"start",b),c=!0),d.trigger(a,b),d.trigger(a+b.direction,b);var q=r.isVertical(b.direction);(d.options.dragBlockVertical&&q||d.options.dragBlockHorizontal&&!q)&&b.preventDefault();break;case p:c&&b.changedLength<=d.options.dragMaxTouches&&(d.trigger(a+"end",b),c=!1);break;case o:c=!1}}var c=!1;d.gestures.Drag={name:a,index:50,handler:b,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),d.gestures.Gesture={name:"gesture",index:1337,handler:function(a,b){b.trigger(this.name,a)}},function(a){function b(b,d){var e=d.options,f=u.current;switch(b.eventType){case m:clearTimeout(c),f.name=a,c=setTimeout(function(){f&&f.name==a&&d.trigger(a,b)},e.holdTimeout);break;case n:b.distance>e.holdThreshold&&clearTimeout(c);break;case p:clearTimeout(c)}}var c;d.gestures.Hold={name:a,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:b}}("hold"),d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==p&&b.trigger(this.name,a)}},d.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(a,b){if(a.eventType==p){var c=a.touches.length,d=b.options;if(c<d.swipeMinTouches||c>d.swipeMaxTouches)return;(a.velocityX>d.swipeVelocityX||a.velocityY>d.swipeVelocityY)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},function(a){function b(b,d){var e,f,g=d.options,h=u.current,i=u.previous;switch(b.eventType){case m:c=!1;break;case n:c=c||b.distance>g.tapMaxDistance;break;case o:!r.inStr(b.srcEvent.type,"cancel")&&b.deltaTime<g.tapMaxTime&&!c&&(e=i&&i.lastEvent&&b.timeStamp-i.lastEvent.timeStamp,f=!1,i&&i.name==a&&e&&e<g.doubleTapInterval&&b.distance<g.doubleTapDistance&&(d.trigger("doubletap",b),f=!0),(!f||g.tapAlways)&&(h.name=a,d.trigger(h.name,b)))}}var c=!1;d.gestures.Tap={name:a,index:100,handler:b,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),d.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(a,b){return b.options.preventMouse&&a.pointerType==j?void a.stopDetect():(b.options.preventDefault&&a.preventDefault(),void(a.eventType==q&&b.trigger("touch",a)))}},function(a){function b(b,d){switch(b.eventType){case m:c=!1;break;case n:if(b.touches.length<2)return;var e=Math.abs(1-b.scale),f=Math.abs(b.rotation);if(e<d.options.transformMinScale&&f<d.options.transformMinRotation)return;u.current.name=a,c||(d.trigger(a+"start",b),c=!0),d.trigger(a,b),f>d.options.transformMinRotation&&d.trigger("rotate",b),e>d.options.transformMinScale&&(d.trigger("pinch",b),d.trigger("pinch"+(b.scale<1?"in":"out"),b));break;case p:c&&b.changedLength<2&&(d.trigger(a+"end",b),c=!1)}}var c=!1;d.gestures.Transform={name:a,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:b}}("transform"),"function"==typeof define&&define.amd?define(function(){return d}):"undefined"!=typeof module&&module.exports?module.exports=d:a.Hammer=d}(window),/*! jQuery plugin for Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(a,b){"use strict";function c(a,c){Date.now||(Date.now=function(){return(new Date).getTime()}),a.utils.each(["on","off"],function(d){a.utils[d]=function(a,e,f){c(a)[d](e,function(a){var d=c.extend({},a.originalEvent,a);d.button===b&&(d.button=a.which-1),f.call(this,d)})}}),a.Instance.prototype.trigger=function(a,b){var d=c(this.element);return d.has(b.target).length&&(d=c(b.target)),d.trigger({type:a,gesture:b})},c.fn.hammer=function(b){return this.each(function(){var d=c(this),e=d.data("hammer");e?e&&b&&a.utils.extend(e.options,b):d.data("hammer",new a(this,b||{}))})}}"function"==typeof define&&define.amd?define(["hammerjs","jquery"],c):c(a.Hammer,a.jQuery||a.Zepto)}(window),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});var split;split=split||function(a){var b,c=String.prototype.split,d=/()??/.exec("")[1]===a;return b=function(b,e,f){if("[object RegExp]"!==Object.prototype.toString.call(e))return c.call(b,e,f);var g,h,i,j,k=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),m=0,e=new RegExp(e.source,l+"g");for(b+="",d||(g=new RegExp("^"+e.source+"$(?!\\s)",l)),f=f===a?-1>>>0:f>>>0;(h=e.exec(b))&&(i=h.index+h[0].length,!(i>m&&(k.push(b.slice(m,h.index)),!d&&h.length>1&&h[0].replace(g,function(){for(var b=1;b<arguments.length-2;b++)arguments[b]===a&&(h[b]=a)}),h.length>1&&h.index<b.length&&Array.prototype.push.apply(k,h.slice(1)),j=h[0].length,m=i,k.length>=f)));)e.lastIndex===h.index&&e.lastIndex++;return m===b.length?(j||!e.test(""))&&k.push(""):k.push(b.slice(m)),k.length>f?k.slice(0,f):k},String.prototype.split=function(a,c){return b(this,a,c)},b}(),!function(a,b){if("object"==typeof exports&&exports)b(exports);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(this,function(a){function b(a,b){return t.call(a,b)}function c(a){return!b(p,a)}function d(a){return"function"==typeof a}function e(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function f(a){return String(a).replace(/[&<>"'\/]/g,function(a){return w[a]})}function g(a){if(!v(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(e(a[0])+"\\s*"),new RegExp("\\s*"+e(a[1]))]}function h(b,d){function f(){if(A&&!B)for(;z.length;)delete y[z.pop()];else z=[];A=!1,B=!1}d=d||a.tags,b=b||"","string"==typeof d&&(d=d.split(o));for(var h,l,m,p,t,u,v=g(d),w=new k(b),x=[],y=[],z=[],A=!1,B=!1;!w.eos();){if(h=w.pos,m=w.scanUntil(v[0]))for(var C=0,D=m.length;D>C;++C)p=m.charAt(C),c(p)?z.push(y.length):B=!0,y.push(["text",p,h,h+1]),h+=1,"\n"===p&&f();if(!w.scan(v[0]))break;if(A=!0,l=w.scan(s)||"name",w.scan(n),"="===l?(m=w.scanUntil(q),w.scan(q),w.scanUntil(v[1])):"{"===l?(m=w.scanUntil(new RegExp("\\s*"+e("}"+d[1]))),w.scan(r),w.scanUntil(v[1]),l="&"):m=w.scanUntil(v[1]),!w.scan(v[1]))throw new Error("Unclosed tag at "+w.pos);if(t=[l,m,h,w.pos],y.push(t),"#"===l||"^"===l)x.push(t);else if("/"===l){if(u=x.pop(),!u)throw new Error('Unopened section "'+m+'" at '+h);if(u[1]!==m)throw new Error('Unclosed section "'+u[1]+'" at '+h)}else"name"===l||"{"===l||"&"===l?B=!0:"="===l&&(v=g(d=m.split(o)))}if(u=x.pop())throw new Error('Unclosed section "'+u[1]+'" at '+w.pos);return j(i(y))}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function j(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function k(a){this.string=a,this.tail=a,this.pos=0}function l(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function m(){this.cache={}}var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=RegExp.prototype.test,u=Object.prototype.toString,v=Array.isArray||function(a){return"[object Array]"===u.call(a)},w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};k.prototype.eos=function(){return""===this.tail},k.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},k.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},l.prototype.push=function(a){return new l(a,this)},l.prototype.lookup=function(a){var b;if(a in this.cache)b=this.cache[a];else{for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var e=a.split("."),f=0;null!=b&&f<e.length;)b=b[e[f++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this.cache[a]=b}return d(b)&&(b=b.call(this.view)),b},m.prototype.clearCache=function(){this.cache={}},m.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=h(a,b)),d},m.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof l?b:new l(b);return this.renderTokens(d,e,c,a)},m.prototype.renderTokens=function(b,c,e,f){function g(a){return k.render(a,c,e)}for(var h,i,j="",k=this,l=0,m=b.length;m>l;++l)switch(h=b[l],h[0]){case"#":if(i=c.lookup(h[1]),!i)continue;if(v(i))for(var n=0,o=i.length;o>n;++n)j+=this.renderTokens(h[4],c.push(i[n]),e,f);else if("object"==typeof i||"string"==typeof i)j+=this.renderTokens(h[4],c.push(i),e,f);else if(d(i)){if("string"!=typeof f)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,f.slice(h[3],h[5]),g),null!=i&&(j+=i)}else j+=this.renderTokens(h[4],c,e,f);break;case"^":i=c.lookup(h[1]),(!i||v(i)&&0===i.length)&&(j+=this.renderTokens(h[4],c,e,f));break;case">":if(!e)continue;i=this.parse(d(e)?e(h[1]):e[h[1]]),null!=i&&(j+=this.renderTokens(i,c,e,f));break;case"&":i=c.lookup(h[1]),null!=i&&(j+=i);break;case"name":i=c.lookup(h[1]),null!=i&&(j+=a.escape(i));break;case"text":j+=h[1]}return j},a.name="mustache.js",a.version="0.8.0",a.tags=["{{","}}"];var x=new m;a.clearCache=function(){return x.clearCache()},a.parse=function(a,b){return x.parse(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,e,f){var g=a.render(b,c,e);return d(f)?void f(g):g},a.escape=f,a.Scanner=k,a.Context=l,a.Writer=m}),function(a){function b(b){if("string"==typeof b.data&&(b.data={keys:b.data}),b.data&&b.data.keys&&"string"==typeof b.data.keys){var c=b.handler,d=b.data.keys.toLowerCase().split(" ");b.handler=function(e){if(this===e.target||!b.data.filterTextInputs||!(a.inArray(e.target.type,a.hotkeys.textAcceptingInputTypes)>-1||/textarea|select/i.test(e.target.nodeName))){var f=a.hotkeys.specialKeys[e.keyCode],g=String.fromCharCode(e.which).toLowerCase(),h="",i={};a.each(["alt","ctrl","meta","shift"],function(a,b){e[b+"Key"]&&f!==b&&(h+=b+"+")}),h=h.replace("alt+ctrl+meta+shift","hyper"),f&&(i[h+f]=!0),g&&(i[h+g]=!0,i[h+a.hotkeys.shiftNums[g]]=!0,"shift+"===h&&(i[a.hotkeys.shiftNums[g]]=!0));for(var j=0,k=d.length;k>j;j++)if(i[d[j]])return c.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"]},a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})}(this.jQuery),function(a){a.datepicker.parseDate=function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(c="object"==typeof c?c.toString():c+"",""===c)return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=!0,q=-1,r=-1,s=-1,t=-1,u=!1,v=function(a){var c=e+1<b.length&&b.charAt(e+1)===a;return c&&e++,c},w=function(a){var b=v(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e="y"!==a||p?1:d,f=new RegExp("^\\d{"+e+","+d+"}"),g=c.substring(i).match(f);if(!g)throw"Missing number at position "+i;return i+=g[0].length,parseInt(g[0],10)},x=function(b,d,e){var f=-1,g=a.map(v(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},y=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;e<b.length;e++)if(u)"'"!==b.charAt(e)||v("'")?y():u=!1;else switch(b.charAt(e)){case"d":s=w("d");break;case"D":x("D",l,m);break;case"o":t=w("o");break;case"m":r=w("m");break;case"M":r=x("M",n,o);break;case"y":q=w("y");break;case"@":h=new Date(w("@")),q=h.getFullYear(),r=h.getMonth()+1,s=h.getDate();break;case"!":h=new Date((w("!")-this._ticksTo1970)/1e4),q=h.getFullYear(),r=h.getMonth()+1,s=h.getDate();break;case"'":v("'")?y():u=!0;break;default:y()}if(i<c.length&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===q?q=(new Date).getFullYear():100>q&&(q+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=q?0:-100)),t>-1)for(r=1,s=t;;){if(f=this._getDaysInMonth(q,r-1),f>=s)break;r++,s-=f}if(h=this._daylightSavingAdjust(new Date(q,r-1,s)),h.getFullYear()!==q||h.getMonth()+1!==r||h.getDate()!==s)throw"Invalid date";return h}}(this.jQuery),/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
function(a){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):g+"",document.cookie=[encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend(c,{expires:-1})),!0):!1}}),function(){}(jQuery),/*!
 * jQuery blockUI plugin
 * Version 2.65.0-2013.09.02
 * Requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */
!function(){"use strict";function a(a){function b(b,d){var f,p,q=b==window,r=d&&void 0!==d.message?d.message:void 0;if(d=a.extend({},a.blockUI.defaults,d||{}),!d.ignoreIfBlocked||!a(b).data("blockUI.isBlocked")){if(d.overlayCSS=a.extend({},a.blockUI.defaults.overlayCSS,d.overlayCSS||{}),f=a.extend({},a.blockUI.defaults.css,d.css||{}),d.onOverlayClick&&(d.overlayCSS.cursor="pointer"),p=a.extend({},a.blockUI.defaults.themedCSS,d.themedCSS||{}),r=void 0===r?d.message:r,q&&n&&c(window,{fadeOut:0}),r&&"string"!=typeof r&&(r.parentNode||r.jquery)){var s=r.jquery?r[0]:r,t={};a(b).data("blockUI.history",t),t.el=s,t.parent=s.parentNode,t.display=s.style.display,t.position=s.style.position,t.parent&&t.parent.removeChild(s)}a(b).data("blockUI.onUnblock",d.onUnblock);var u,v,w,x,y=d.baseZ;u=a(k||d.forceIframe?'<iframe class="blockUI" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+d.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),v=a(d.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+y++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),d.theme&&q?(x='<div class="blockUI '+d.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:fixed">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):d.theme?(x='<div class="blockUI '+d.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:absolute">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):x=q?'<div class="blockUI '+d.blockMsgClass+' blockPage" style="z-index:'+(y+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+d.blockMsgClass+' blockElement" style="z-index:'+(y+10)+';display:none;position:absolute"></div>',w=a(x),r&&(d.theme?(w.css(p),w.addClass("ui-widget-content")):w.css(f)),d.theme||v.css(d.overlayCSS),v.css("position",q?"fixed":"absolute"),(k||d.forceIframe)&&u.css("opacity",0);var z=[u,v,w],A=a(q?"body":b);a.each(z,function(){this.appendTo(A)}),d.theme&&d.draggable&&a.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var B=m&&(!a.support.boxModel||a("object,embed",q?null:b).length>0);if(l||B){if(q&&d.allowBodyStretch&&a.support.boxModel&&a("html,body").css("height","100%"),(l||!a.support.boxModel)&&!q)var C=i(b,"borderTopWidth"),D=i(b,"borderLeftWidth"),E=C?"(0 - "+C+")":0,F=D?"(0 - "+D+")":0;a.each(z,function(a,b){var c=b[0].style;if(c.position="absolute",2>a)q?c.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+d.quirksmodeOffsetHack+') + "px"'):c.setExpression("height",'this.parentNode.offsetHeight + "px"'),q?c.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):c.setExpression("width",'this.parentNode.offsetWidth + "px"'),F&&c.setExpression("left",F),E&&c.setExpression("top",E);else if(d.centerY)q&&c.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),c.marginTop=0;else if(!d.centerY&&q){var e=d.css&&d.css.top?parseInt(d.css.top,10):0,f="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+e+') + "px"';c.setExpression("top",f)}})}if(r&&(d.theme?w.find(".ui-widget-content").append(r):w.append(r),(r.jquery||r.nodeType)&&a(r).show()),(k||d.forceIframe)&&d.showOverlay&&u.show(),d.fadeIn){var G=d.onBlock?d.onBlock:j,H=d.showOverlay&&!r?G:j,I=r?G:j;d.showOverlay&&v._fadeIn(d.fadeIn,H),r&&w._fadeIn(d.fadeIn,I)}else d.showOverlay&&v.show(),r&&w.show(),d.onBlock&&d.onBlock();if(e(1,b,d),q?(n=w[0],o=a(d.focusableElements,n),d.focusInput&&setTimeout(g,20)):h(w[0],d.centerX,d.centerY),d.timeout){var J=setTimeout(function(){q?a.unblockUI(d):a(b).unblock(d)},d.timeout);a(b).data("blockUI.timeout",J)}}}function c(b,c){var f,g=b==window,h=a(b),i=h.data("blockUI.history"),j=h.data("blockUI.timeout");j&&(clearTimeout(j),h.removeData("blockUI.timeout")),c=a.extend({},a.blockUI.defaults,c||{}),e(0,b,c),null===c.onUnblock&&(c.onUnblock=h.data("blockUI.onUnblock"),h.removeData("blockUI.onUnblock"));var k;k=g?a("body").children().filter(".blockUI").add("body > .blockUI"):h.find(">.blockUI"),c.cursorReset&&(k.length>1&&(k[1].style.cursor=c.cursorReset),k.length>2&&(k[2].style.cursor=c.cursorReset)),g&&(n=o=null),c.fadeOut?(f=k.length,k.stop().fadeOut(c.fadeOut,function(){0===--f&&d(k,i,c,b)})):d(k,i,c,b)}function d(b,c,d,e){var f=a(e);if(!f.data("blockUI.isBlocked")){b.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),c&&c.el&&(c.el.style.display=c.display,c.el.style.position=c.position,c.parent&&c.parent.appendChild(c.el),f.removeData("blockUI.history")),f.data("blockUI.static")&&f.css("position","static"),"function"==typeof d.onUnblock&&d.onUnblock(e,d);var g=a(document.body),h=g.width(),i=g[0].style.width;g.width(h-1).width(h),g[0].style.width=i}}function e(b,c,d){var e=c==window,g=a(c);if((b||(!e||n)&&(e||g.data("blockUI.isBlocked")))&&(g.data("blockUI.isBlocked",b),e&&d.bindEvents&&(!b||d.showOverlay))){var h="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";b?a(document).bind(h,d,f):a(document).unbind(h,f)}}function f(b){if("keydown"===b.type&&b.keyCode&&9==b.keyCode&&n&&b.data.constrainTabKey){var c=o,d=!b.shiftKey&&b.target===c[c.length-1],e=b.shiftKey&&b.target===c[0];if(d||e)return setTimeout(function(){g(e)},10),!1}var f=b.data,h=a(b.target);return h.hasClass("blockOverlay")&&f.onOverlayClick&&f.onOverlayClick(),h.parents("div."+f.blockMsgClass).length>0?!0:0===h.parents().children().filter("div.blockUI").length}function g(a){if(o){var b=o[a===!0?o.length-1:0];b&&b.focus()}}function h(a,b,c){var d=a.parentNode,e=a.style,f=(d.offsetWidth-a.offsetWidth)/2-i(d,"borderLeftWidth"),g=(d.offsetHeight-a.offsetHeight)/2-i(d,"borderTopWidth");b&&(e.left=f>0?f+"px":"0"),c&&(e.top=g>0?g+"px":"0")}function i(b,c){return parseInt(a.css(b,c),10)||0}a.fn._fadeIn=a.fn.fadeIn;var j=a.noop||function(){},k=/MSIE/.test(navigator.userAgent),l=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);document.documentMode||0;var m=a.isFunction(document.createElement("div").style.setExpression);a.blockUI=function(a){b(window,a)},a.unblockUI=function(a){c(window,a)},a.growlUI=function(b,c,d,e){var f=a('<div class="growlUI"></div>');b&&f.append("<h1>"+b+"</h1>"),c&&f.append("<h2>"+c+"</h2>"),void 0===d&&(d=3e3);var g=function(b){b=b||{},a.blockUI({message:f,fadeIn:"undefined"!=typeof b.fadeIn?b.fadeIn:700,fadeOut:"undefined"!=typeof b.fadeOut?b.fadeOut:1e3,timeout:"undefined"!=typeof b.timeout?b.timeout:d,centerY:!1,showOverlay:!1,onUnblock:e,css:a.blockUI.defaults.growlCSS})};g(),f.css("opacity"),f.mouseover(function(){g({fadeIn:0,timeout:3e4});var b=a(".blockMsg");b.stop(),b.fadeTo(300,1)}).mouseout(function(){a(".blockMsg").fadeOut(1e3)})},a.fn.block=function(c){if(this[0]===window)return a.blockUI(c),this;var d=a.extend({},a.blockUI.defaults,c||{});return this.each(function(){var b=a(this);d.ignoreIfBlocked&&b.data("blockUI.isBlocked")||b.unblock({fadeOut:0})}),this.each(function(){"static"==a.css(this,"position")&&(this.style.position="relative",a(this).data("blockUI.static",!0)),this.style.zoom=1,b(this,c)})},a.fn.unblock=function(b){return this[0]===window?(a.unblockUI(b),this):this.each(function(){c(this,b)})},a.blockUI.version=2.65,a.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var n=null,o=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(jQuery)}(),function(a){var b=a.blockUI.defaults;a.extend(b.css,{border:"none",padding:"15px",backgroundColor:"#888","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.75,color:"#EEE","font-weight":"bold",top:"200px"}),b.centerY=!1,a.extend(b.overlayCSS,{backgroundColor:"#FFF",opacity:.7})}(jQuery),function(a){var b=0;a.widget("ech.multiselect",{options:{header:!0,height:175,minWidth:225,classes:"",checkAllText:"Check all",uncheckAllText:"Uncheck all",noneSelectedText:"Select options",selectedText:"# selected",selectedList:0,show:null,hide:null,autoOpen:!1,multiple:!0,position:{}},_create:function(){var b=this.element.hide(),c=this.options;this.speed=a.fx.speeds._default,this._isOpen=!1,b=(this.button=a('<button type="button"><span class="ui-icon ui-icon-triangle-2-n-s"></span></button>')).addClass("ui-multiselect ui-widget ui-state-default ui-corner-all").addClass(c.classes).attr({title:b.attr("title"),"aria-haspopup":!0,tabIndex:b.attr("tabIndex")}).insertAfter(b),(this.buttonlabel=a("<span />")).html(c.noneSelectedText).appendTo(b);var b=(this.menu=a("<div />")).addClass("ui-multiselect-menu ui-widget ui-widget-content ui-corner-all").addClass(c.classes).appendTo(document.body),d=(this.header=a("<div />")).addClass("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix").appendTo(b);(this.headerLinkContainer=a("<ul />")).addClass("ui-helper-reset").html(function(){return!0===c.header?'<li><a class="ui-multiselect-all" href="#"><span class="ui-icon ui-icon-check"></span><span>'+c.checkAllText+'</span></a></li><li><a class="ui-multiselect-none" href="#"><span class="ui-icon ui-icon-closethick"></span><span>'+c.uncheckAllText+"</span></a></li>":"string"==typeof c.header?"<li>"+c.header+"</li>":""}).append('<li class="ui-multiselect-close"><a href="#" class="ui-multiselect-close"><span class="ui-icon ui-icon-circle-close"></span></a></li>').appendTo(d),(this.checkboxContainer=a("<ul />")).addClass("ui-multiselect-checkboxes ui-helper-reset").appendTo(b),this._bindEvents(),this.refresh(!0),c.multiple||b.addClass("ui-multiselect-single")},_init:function(){!1===this.options.header&&this.header.hide(),this.options.multiple||this.headerLinkContainer.find(".ui-multiselect-all, .ui-multiselect-none").hide(),this.options.autoOpen&&this.open(),this.element.is(":disabled")&&this.disable()},refresh:function(c){var d=this.element,e=this.options,f=this.menu,g=this.checkboxContainer,h=[],i="",j=d.attr("id")||b++;d.find("option").each(function(b){a(this);var c,d=this.parentNode,f=this.innerHTML,g=this.title,k=this.value,b="ui-multiselect-"+(this.id||j+"-option-"+b),l=this.disabled,m=this.selected,n=["ui-corner-all"],o=(l?"ui-multiselect-disabled ":" ")+this.className;"OPTGROUP"===d.tagName&&(c=d.getAttribute("label"),-1===a.inArray(c,h)&&(i+='<li class="ui-multiselect-optgroup-label '+d.className+'"><a href="#">'+c+"</a></li>",h.push(c))),l&&n.push("ui-state-disabled"),m&&!e.multiple&&n.push("ui-state-active"),i+='<li class="'+o+'">',i+='<label for="'+b+'" title="'+g+'" class="'+n.join(" ")+'">',i+='<input id="'+b+'" name="multiselect_'+j+'" type="'+(e.multiple?"checkbox":"radio")+'" value="'+k+'" title="'+f+'"',m&&(i+=' checked="checked"',i+=' aria-selected="true"'),l&&(i+=' disabled="disabled"',i+=' aria-disabled="true"'),i+=" /><span>"+f+"</span></label></li>"}),g.html(i),this.labels=f.find("label"),this.inputs=this.labels.children("input"),this._setButtonWidth(),this._setMenuWidth(),this.button[0].defaultValue=this.update(),c||this._trigger("refresh")},update:function(){var b=this.options,c=this.inputs,d=c.filter(":checked"),e=d.length,b=0===e?b.noneSelectedText:a.isFunction(b.selectedText)?b.selectedText.call(this,e,c.length,d.get()):/\d/.test(b.selectedList)&&0<b.selectedList&&e<=b.selectedList?d.map(function(){return a(this).next().html()}).get().join(", "):b.selectedText.replace("#",e).replace("#",c.length);return this.buttonlabel.html(b),b},_bindEvents:function(){function b(){return c[c._isOpen?"close":"open"](),!1}var c=this,d=this.button;d.find("span").bind("click.multiselect",b),d.bind({click:b,keypress:function(a){switch(a.which){case 27:case 38:case 37:c.close();break;case 39:case 40:c.open()}},mouseenter:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover-")},mouseleave:function(){a(this).removeClass("ui-state-hover-")},focus:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-focus")},blur:function(){a(this).removeClass("ui-state-focus")}}),this.header.delegate("a","click.multiselect",function(b){a(this).hasClass("ui-multiselect-close")?c.close():c[a(this).hasClass("ui-multiselect-all")?"checkAll":"uncheckAll"](),b.preventDefault()}),this.menu.delegate("li.ui-multiselect-optgroup-label a","click.multiselect",function(b){b.preventDefault();var d=a(this),e=d.parent().nextUntil("li.ui-multiselect-optgroup-label").find("input:visible:not(:disabled)"),f=e.get(),d=d.parent().text();!1!==c._trigger("beforeoptgrouptoggle",b,{inputs:f,label:d})&&(c._toggleChecked(e.filter(":checked").length!==e.length,e),c._trigger("optgrouptoggle",b,{inputs:f,label:d,checked:f[0].checked}))}).delegate("label","mouseenter.multiselect",function(){a(this).hasClass("ui-state-disabled")||(c.labels.removeClass("ui-state-hover-"),a(this).addClass("ui-state-hover-").find("input").focus())}).delegate("label","keydown.multiselect",function(b){switch(b.preventDefault(),b.which){case 9:case 27:c.close();break;case 38:case 40:case 37:case 39:c._traverse(b.which,this);break;case 13:a(this).find("input")[0].click()}}).delegate('input[type="checkbox"], input[type="radio"]',"click.multiselect",function(b){var d=a(this),e=this.value,f=this.checked,g=c.element.find("option");this.disabled||!1===c._trigger("click",b,{value:e,text:this.title,checked:f})?b.preventDefault():(d.focus(),d.attr("aria-selected",f),g.each(function(){this.value===e?this.selected=f:c.options.multiple||(this.selected=!1)}),c.options.multiple||(c.labels.removeClass("ui-state-active"),d.closest("label").toggleClass("ui-state-active",f),c.close()),c.element.trigger("change"),setTimeout(a.proxy(c.update,c),10))}),a(document).bind("mousedown.multiselect",function(b){c._isOpen&&!a.contains(c.menu[0],b.target)&&!a.contains(c.button[0],b.target)&&b.target!==c.button[0]&&c.close()}),a(this.element[0].form).bind("reset.multiselect",function(){setTimeout(a.proxy(c.refresh,c),10)})},_setButtonWidth:function(){var a=this.element.outerWidth(),b=this.options;/\d/.test(b.minWidth)&&a<b.minWidth&&(a=b.minWidth),this.button.css("width","100%")},_setMenuWidth:function(){{var a=this.menu;this.button.outerWidth()-parseInt(a.css("padding-left"),10)-parseInt(a.css("padding-right"),10)-parseInt(a.css("border-right-width"),10)-parseInt(a.css("border-left-width"),10)}},_traverse:function(b,c){var d=a(c),e=38===b||37===b,d=d.parent()[e?"prevAll":"nextAll"]("li:not(.ui-multiselect-disabled, .ui-multiselect-optgroup-label)")[e?"last":"first"]();d.length?d.find("label").trigger("mouseover"):(d=this.menu.find("ul").last(),this.menu.find("label")[e?"last":"first"]().trigger("mouseover"),d.scrollTop(e?d.height():0))},_toggleState:function(a,b){return function(){this.disabled||(this[a]=b),b?this.setAttribute("aria-selected",!0):this.removeAttribute("aria-selected")}},_toggleChecked:function(b,c){var d=c&&c.length?c:this.inputs,e=this;d.each(this._toggleState("checked",b)),d.eq(0).focus(),this.update();var f=d.map(function(){return this.value}).get();this.element.find("option").each(function(){!this.disabled&&-1<a.inArray(this.value,f)&&e._toggleState("selected",b).call(this)}),d.length&&this.element.trigger("change")},_toggleDisabled:function(b){this.button.attr({disabled:b,"aria-disabled":b})[b?"addClass":"removeClass"]("ui-state-disabled");var c=this.menu.find("input"),c=b?c.filter(":enabled").data("ech-multiselect-disabled",!0):c.filter(function(){return!0===a.data(this,"ech-multiselect-disabled")}).removeData("ech-multiselect-disabled");c.attr({disabled:b,"arial-disabled":b}).parent()[b?"addClass":"removeClass"]("ui-state-disabled"),this.element.attr({disabled:b,"aria-disabled":b})},open:function(){var b=this.button,c=this.menu,d=this.speed,e=this.options,f=[];if(!1!==this._trigger("beforeopen")&&!b.hasClass("ui-state-disabled")&&!this._isOpen){var g=c.find("ul").last(),h=e.show,i=b.offset();a.isArray(e.show)&&(h=e.show[0],d=e.show[1]||this.speed),h&&(f=[h,d]),g.scrollTop(0).height(e.height),a.ui.position&&!a.isEmptyObject(e.position)?(e.position.of=e.position.of||b,c.show().position(e.position).hide()):c.css({top:i.top+b.outerHeight(),left:i.left}),a.fn.show.apply(c,f),this.labels.eq(0).trigger("mouseover").trigger("mouseenter").find("input").trigger("focus"),b.addClass("ui-state-active"),this._isOpen=!0,this._trigger("open")}},close:function(){if(!1!==this._trigger("beforeclose")){var b=this.options,c=b.hide,d=this.speed,e=[];a.isArray(b.hide)&&(c=b.hide[0],d=b.hide[1]||this.speed),c&&(e=[c,d]),a.fn.hide.apply(this.menu,e),this.button.removeClass("ui-state-active").trigger("blur").trigger("mouseleave"),this._isOpen=!1,this._trigger("close")}},enable:function(){this._toggleDisabled(!1)},disable:function(){this._toggleDisabled(!0)},checkAll:function(){this._toggleChecked(!0),this._trigger("checkAll")},uncheckAll:function(){this._toggleChecked(!1),this._trigger("uncheckAll")},getChecked:function(){return this.menu.find("input").filter(":checked")},destroy:function(){return a.Widget.prototype.destroy.call(this),this.button.remove(),this.menu.remove(),this.element.show(),this},isOpen:function(){return this._isOpen},widget:function(){return this.menu},getButton:function(){return this.button},_setOption:function(b,c){var d=this.menu;switch(b){case"header":d.find("div.ui-multiselect-header")[c?"show":"hide"]();break;case"checkAllText":d.find("a.ui-multiselect-all span").eq(-1).text(c);break;case"uncheckAllText":d.find("a.ui-multiselect-none span").eq(-1).text(c);break;case"height":d.find("ul").last().height(parseInt(c,10));break;case"minWidth":this.options[b]=parseInt(c,10),this._setButtonWidth(),this._setMenuWidth();break;case"selectedText":case"selectedList":case"noneSelectedText":this.options[b]=c,this.update();break;case"classes":d.add(this.button).removeClass(this.options.classes).addClass(c);break;case"multiple":d.toggleClass("ui-multiselect-single",!c),this.options.multiple=c,this.element[0].multiple=c,this.refresh()}a.Widget.prototype._setOption.apply(this,arguments)}})}(jQuery),function(a){var b=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;a.widget("ech.multiselectfilter",{options:{label:"Filter:",width:null,placeholder:"Enter keywords",autoReset:!1},_create:function(){var b=this.options,c=a(this.element),d=this.instance=c.data("echMultiselect")||c.data("multiselect")||c.data("ech-multiselect");this.header=d.menu.find(".ui-multiselect-header").addClass("ui-multiselect-hasfilter");var e=this.wrapper=a('<div class="ui-multiselect-filter">'+(b.label.length?b.label:"")+'<input placeholder="'+b.placeholder+'" type="search"'+(/\d/.test(b.width)?'style="width:'+b.width+'px"':"")+" /></div>").prependTo(this.header);this.inputs=d.menu.find('input[type="checkbox"], input[type="radio"]'),this.input=e.find("input").bind({keydown:function(a){13===a.which&&a.preventDefault()},keyup:a.proxy(this._handler,this),click:a.proxy(this._handler,this)}),this.updateCache(),d._toggleChecked=function(b,c){var e=c&&c.length?c:this.labels.find("input"),f=this,g=d._isOpen?":disabled, :hidden":":disabled";e=e.not(g).each(this._toggleState("checked",b)),this.update();var h=e.map(function(){return this.value}).get();this.element.find("option").filter(function(){!this.disabled&&a.inArray(this.value,h)>-1&&f._toggleState("selected",b).call(this)}),e.length&&this.element.trigger("change")};var f=a(document).bind("multiselectrefresh",a.proxy(function(){this.updateCache(),this._handler()},this));this.options.autoReset&&f.bind("multiselectclose",a.proxy(this._reset,this))},_handler:function(c){var d=a.trim(this.input[0].value.toLowerCase()),e=this.rows,f=this.inputs,g=this.cache;if(d){e.hide();var h=RegExp(d.replace(b,"\\$&"),"gi");this._trigger("filter",c,a.map(g,function(a,b){return-1!==a.search(h)?(e.eq(b).show(),f.get(b)):null}))}else e.show();this.instance.menu.find(".ui-multiselect-optgroup-label").each(function(){var b=a(this),c=b.nextUntil(".ui-multiselect-optgroup-label").filter(function(){return"none"!==a.css(this,"display")}).length;b[c?"show":"hide"]()})},_reset:function(){this.input.val("").trigger("keyup")},updateCache:function(){this.rows=this.instance.menu.find(".ui-multiselect-checkboxes li:not(.ui-multiselect-optgroup-label)"),this.cache=this.element.children().map(function(){var b=a(this);return"optgroup"===this.tagName.toLowerCase()&&(b=b.children()),b.map(function(){return this.innerHTML.toLowerCase()}).get()}).get()},widget:function(){return this.wrapper},destroy:function(){a.Widget.prototype.destroy.call(this),this.input.val("").trigger("keyup"),this.wrapper.remove()}})}(jQuery),function(a){a.number=function(a,b,c,d){d=void 0===d?",":d,c=void 0===c?".":c,b=isFinite(+b)?Math.abs(b):0;var e="\\u"+("0000"+c.charCodeAt(0).toString(16)).substr(-4);a=(a+"").replace(RegExp(e,"g"),".").replace(RegExp("[^0-9+-Ee.]","g"),"");var f=isFinite(+a)?+a:0,g="",h=function(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c};return g=(b?h(f,b):""+Math.round(f)).split("."),g[0].length>3&&(g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,d)),b>(g[1]||"").length&&(g[1]=g[1]||"",g[1]+=Array(b-g[1].length+1).join("0")),g.join(c)}}(jQuery),function(a){a.fn.setCursorPosition=function(a){return this.each(function(b,c){if(c.setSelectionRange)c.setSelectionRange(a,a);else if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveEnd("character",a),d.moveStart("character",a),d.select()}}),this},a.fn.getCursorPosition=function(){var b=a(this).get(0),c=0;if("selectionStart"in b)c=b.selectionStart;else if("selection"in document){b.focus();var d=document.selection.createRange(),e=document.selection.createRange().text.length;d.moveStart("character",-b.value.length),c=d.text.length-e}return c}}(jQuery),window.sforce=window.sforce||{},sforce.internal={},sforce.StringBuffer=function(){this.buffer=[],this.append=function(a){return this.buffer.push(a),this},this.toString=function(){return this.buffer.join("")}},sforce.Base64Binary=function(a){this.input=a},sforce.Base64Binary.prototype.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sforce.Base64Binary.prototype.toString=function(){var a,b,c,d,e,f=[],g="",h="",i=0;do a=this.input.charCodeAt(i++),b=this.input.charCodeAt(i++),g=this.input.charCodeAt(i++),c=a>>2,d=(3&a)<<4|b>>4,e=(15&b)<<2|g>>6,h=63&g,isNaN(b)?e=h=64:isNaN(g)&&(h=64),f.push(this.keyStr.charAt(c)+this.keyStr.charAt(d)+this.keyStr.charAt(e)+this.keyStr.charAt(h)),a=b=g="",c=d=e=h="";while(i<this.input.length);return f.join("")},sforce.Base64Binary.prototype.decode=function(a){var b,c,d,e,f,g=[],h="",i="",j=0,k=/[^A-Za-z0-9\+\/\=]/g;k.exec(a)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/', and '='\nExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=this.keyStr.indexOf(a.charAt(j++)),e=this.keyStr.indexOf(a.charAt(j++)),f=this.keyStr.indexOf(a.charAt(j++)),i=this.keyStr.indexOf(a.charAt(j++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,h=(3&f)<<6|i,g.push(String.fromCharCode(b)),64!=f&&g.push(String.fromCharCode(c)),64!=i&&g.push(String.fromCharCode(h)),b=c=h="",d=e=f=i="";while(j<a.length);return g.join("")},sforce.internal.dateToString=function(a){var b=a,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate();return c+"-"+d+"-"+e},sforce.internal.dateTimeToString=function(a){var b=a,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getTimezoneOffset(),j=0>i?"+":"-";i=Math.abs(i);var k=i/60,l=i%60;9>=h&&(h="0"+h);var m=b.getMilliseconds();0!==m&&(m="."+m,m.length>4&&(m=m.substring(0,4)),h+=m);var n;return 0===i?n="Z":(10>l&&(l="0"+l),10>k&&(k="0"+k),n=j+k+":"+l),9>=d&&(d="0"+d),9>=e&&(e="0"+e),9>=f&&(f="0"+f),9>=g&&(g="0"+g),c+"-"+d+"-"+e+"T"+f+":"+g+":"+h+n},sforce.internal.stringToDate=function(a){var b=!1;if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),b=!0),10!=a.length)throw"Unable to parse date, "+a+" length != 10";if("-"!=a.charAt(4)||"-"!=a.charAt(7))throw"Unable to parse date";var c=a.substring(0,4),d=a.substring(5,7),e=a.substring(8,10),f=new Date(c,d-1,e,0,0,0);return f.setMilliseconds(0),f},sforce.internal.stringToDateTime=function(a){var b=!1;if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),b=!0),a.length<19)throw"Unable to parse dateTime";if("-"!=a.charAt(4)||"-"!=a.charAt(7)||"T"!=a.charAt(10))throw"Unable to parse dateTime";if(":"!=a.charAt(13)||":"!=a.charAt(16))throw"Unable to parse dateTime";var c=a.substring(0,4),d=a.substring(5,7),e=a.substring(8,10),f=a.substring(11,13),g=a.substring(14,16),h=a.substring(17,19),i=new Date(c,d-1,e,f,g,h),j=19;if(j<a.length&&"."==a.charAt(j)){for(var k=0,l=++j;j<a.length&&sforce.internal.isDigit(a.charAt(j));)j++;var m=a.substring(l,j);3==m.length?k=m:m.length<3?k=(m+"000").substring(0,3):(k=m.substring(0,3),m.charAt(3)>="5"&&++k),i.setMilliseconds(k)}var n=6e4*i.getTimezoneOffset();if(j+5<a.length&&("+"==a.charAt(j)||"-"==a.charAt(j))){if(!(sforce.internal.isDigit(a.charAt(j+1))&&sforce.internal.isDigit(a.charAt(j+2))&&":"==a.charAt(j+3)&&sforce.internal.isDigit(a.charAt(j+4))&&sforce.internal.isDigit(a.charAt(j+5))))throw"Unable to parse dateTime";var o=10*(a.charAt(j+1)-"0")+a.charAt(j+2)-"0",p=10*(a.charAt(j+4)-"0")+a.charAt(j+5)-"0",q=6e4*(60*o+p);"+"==a.charAt(j)&&(q=-q),i=new Date(i.getTime()-n+q),j+=6}if(j<a.length&&"Z"==a.charAt(j)&&(j++,i=new Date(i.getTime()-n)),j<a.length)throw"Unable to parse dateTime";return i},sforce.internal.isDigit=function(a){return"0"==a||"1"==a||"2"==a||"3"==a||"4"==a||"5"==a||"6"==a||"7"==a||"8"==a||"9"==a?!0:!1},sforce.Xml=function(){},sforce.Xml.prototype.toXml=function(a,b,c){c.writeStartElement(b,a),this._xsiType&&c.writeXsiType(this._xsiType);for(var d in this)if("_name"==d||"_xsiType"==d);else{var e=this[d];if("function"!=typeof e)if("array"==typeof e)for(var f=0;f<e.length;f++)this.writeValue(a,c,d,e[f]);else this.writeValue(a,c,d,e)}c.writeEndElement(b,a)},sforce.Xml.prototype.writeValue=function(a,b,c,d){return null===d?void b.writeNameValueNode("fieldsToNull",c):void("undefined"!=typeof d&&(d.toXml?d.toXml(a,c,b):b.writeNameValueNode(c,d)))},sforce.Xml.prototype.get=function(a){return this[a]?this[a]:null},sforce.Xml.prototype.set=function(a,b){this[a]=b},sforce.Xml.prototype.getArray=function(a){var b=this[a];return b?b.join?b:[b]:[]},sforce.Xml.prototype.getBoolean=function(a){return"true"==this[a]?!0:!1},sforce.Xml.prototype.getDate=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDate(this[a]):null},sforce.Xml.prototype.getDateTime=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDateTime(this[a]):null},sforce.Xml.prototype.getInt=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseInt(this[a],10);throw"Unable to parse int field: "+a},sforce.Xml.prototype.getFloat=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseFloat(this[a]);throw"Unable to parse float field: "+a},sforce.Xml.prototype.getBase64Binary=function(a){if(this[a])return sforce.Base64Binary.prototype.decode(this[a]);throw"Unable to parse base64Binary field: "+a},sforce.Xml.prototype.toString=function(){var a=new sforce.StringBuffer;a.append("{");for(var b in this){var c=this[b];if(c)if("object"==typeof c)a.append(b).append(":").append(c.toString());else if(c.join){a.append(b).append(":").append("[");for(var d=0;d<c.length;d++)a.append(c[d]),d<c.length-1&&a.append(", ");a.append("]")}else{if("function"==typeof c)continue;a.append(b).append(":").append("'"+c+"'")}else a.append(b).append(":").append(""+c);a.append(", ")}return a.append("}"),a.toString()},sforce.internal.Debug=function(){this.output=null,this.trace=!1,this.apexTrace=!1,this.win=null,this.traceQueue=[],this.quiet=!1,this.open=function(){this.println("","print")},this.println=function(a,b){if(!this.quiet){if("function"==typeof println)return void println(a,b);null!==this.win&&this.win.document||(this.output=null,this.win=window.open("undefined"!=typeof window.UserContext?UserContext.getUrl("/soap/ajax/31.0/debugshell.html"):"/soap/ajax/31.0/debugshell.html","","width=800,height=400,toolbar=no,location=no,directories=no,alwaysRaised=yes,status=no,menubar=no,scrollbars=yes,copyhistory=yes,resizable=yes")),null===this.output&&this.findOutput(),null!==this.output?(sforce.debug.traceQueue.length>0&&this.traceCallback(),this.win.println(a,b)):(sforce.debug.traceQueue.push({message:a,type:b}),setTimeout(sforce.debug.traceCallback,1e3))}},this.traceCallback=function(){if(sforce.debug.findOutput(),null===sforce.debug.output)return void setTimeout(sforce.debug.traceCallback,1e3);for(var a=0;a<sforce.debug.traceQueue.length;a++){var b=sforce.debug.traceQueue[a];sforce.debug.win.println(b.message,b.type)}sforce.debug.traceQueue=[]},this.findOutput=function(){return null===this.output&&(this.output=this.win.document.getElementById("output")),this.output},this.logXml=function(a){a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a="<textarea cols=80 rows=5 wrap=hard>"+a+"</textarea>",this.println(a,"printxml")},this.log=function(a){this.println(a,"print")},this.logApex=function(a){var b=a.indexOf("<debugLog>"),c=a.indexOf("</debugLog>");-1===b?b=0:b+="<debugLog>".length,-1===c&&(c=a.length);var d=a.substring(b,c);this.println(d,"printxml")}},sforce.debug=new sforce.internal.Debug,sforce.internal._connections=[],sforce.internal.ConnectionHolder=function(a,b){this.connection=a,this.callback=b,this.timedout=!1},sforce.Transport=function(a){this.url=a,this.connection=null,this.newConnection=function(){try{this.connection=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{this.connection=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){this.connection=new XMLHttpRequest}}return this.connection},this.send=function(a,b,c,d){this.newConnection(),c&&(this.connection.onreadystatechange=this.httpConnectionCallback);var e=new sforce.internal.ConnectionHolder(this.connection,b);sforce.internal._connections.push(e),this.connection.open("POST",this.url,c),this.connection.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),this.connection.setRequestHeader("SOAPAction",'""'),this.connection.setRequestHeader("Accept","text/xml"),this.connection.send(a),c&&"undefined"!=typeof d&&this.setTimeoutOn(e,d),c||this.httpConnectionCallback()},this.setTimeoutOn=function(a,b){function c(){4!==a.connection.readyState&&(a.timedout=!0,a.connection.abort())
}setTimeout(c,b)},this.httpConnectionCallback=function(){for(var a=0;a<sforce.internal._connections.length;a++){var b=sforce.internal._connections[a];if(null!==b)if(b.timedout)sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1),b.callback.httpCallback("Remote invocation timed out",!1);else if(4==b.connection.readyState){sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1);var c=200==b.connection.status;sforce.debug.trace&&(sforce.debug.log("Response : status - "+b.connection.status),sforce.debug.logXml(b.connection.responseText)),sforce.debug.apexTrace&&sforce.debug.logApex(b.connection.responseText),b.connection.responseXML&&b.connection.responseXML.documentElement?b.callback.httpCallback(b.connection.responseXML.documentElement,c):b.callback.httpCallback("Remote invocation failed, due to: "+b.connection.responseText+" status code: ",b.connection.status)}}}},sforce.XmlWriter=function(){this.buffer=new sforce.StringBuffer,this.namespaces={},this.prefixCount=0,this.writingStartElement=!1},sforce.XmlWriter.prototype.writeStartElement=function(a,b,c){this.writingStartElement&&this.buffer.append(">"),this.buffer.append("<");var d=!1;b&&(this.namespaces[b]||""===this.namespaces[b]||(d=!0),c||(c=this.getPrefix(b)),null!==c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))),this.buffer.append(a),d===!0&&this.writeNamespace(b,c),this.writingStartElement=!0},sforce.XmlWriter.prototype.writeEndElement=function(a,b){if(this.writingStartElement)this.buffer.append("/>");else{if(this.buffer.append("</"),b){var c=this.getPrefix(b);c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))}this.buffer.append(a),this.buffer.append(">")}this.writingStartElement=!1},sforce.XmlWriter.prototype.writeNamespace=function(a,b){b&&""!==b?(this.namespaces[a]=b,this.buffer.append(" "),this.buffer.append("xmlns:"),this.buffer.append(b)):(this.namespaces[a]="",this.buffer.append(" "),this.buffer.append("xmlns")),this.buffer.append('="'),this.buffer.append(a),this.buffer.append('"')},sforce.XmlWriter.prototype.writeText=function(a){if(!this.writingStartElement)throw"Can only write text after a start element";this.buffer.append(">"),this.writingStartElement=!1,"string"==typeof a&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;")),this.buffer.append(a)},sforce.XmlWriter.prototype.writeXsiType=function(a){this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:type",a)},sforce.XmlWriter.prototype.writeAttribute=function(a,b){this.buffer.append(" "+a+'="'+b+'"')},sforce.XmlWriter.prototype.getPrefix=function(a){var b=this.namespaces[a];return b||""===b?b:(b="ns"+this.prefixCount,this.prefixCount++,this.namespaces[a]=b,b)},sforce.XmlWriter.prototype.toString=function(){return this.buffer.toString()},sforce.XmlWriter.prototype.soapNS="http://schemas.xmlsoap.org/soap/envelope/",sforce.XmlWriter.prototype.startEnvelope=function(){this.writeStartElement("Envelope",this.soapNS,"se")},sforce.XmlWriter.prototype.endEnvelope=function(){this.writeEndElement("Envelope",this.soapNS)},sforce.XmlWriter.prototype.startHeader=function(){this.writeStartElement("Header",this.soapNS,"se")},sforce.XmlWriter.prototype.endHeader=function(){this.writeEndElement("Header",this.soapNS)},sforce.XmlWriter.prototype.startBody=function(){this.writeStartElement("Body",this.soapNS,"se")},sforce.XmlWriter.prototype.endBody=function(){this.writeEndElement("Body",this.soapNS)},sforce.XmlWriter.prototype.writeNameValueNode=function(a,b){if(null===b)return this.writeStartElement(a),this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:nill","true"),void this.writeEndElement(a);if(b.toUTCString&&(b=sforce.internal.dateTimeToString(b)),"boolean"==typeof b&&(b=b?"true":"false"),b&&b.join)for(var c=0;c<b.length;c++)this.writeStartElement(a),this.writeText(b[c]),this.writeEndElement(a);else this.writeStartElement(a),this.writeText(b),this.writeEndElement(a)},sforce.XmlReader=function(a){this.envelope=a},sforce.XmlReader.prototype.getEnvelope=function(){if(this.isTag("Envelope",this.envelope))return this.envelope;throw"Unable to find soap envelope, but found "+this.envelope.nodeName},sforce.XmlReader.prototype.getBody=function(){return this.getChild("Body",this.envelope)},sforce.XmlReader.prototype.getHeader=function(){return this.getChild("Header",this.envelope)},sforce.XmlReader.prototype.getChild=function(a,b){for(var c=b.childNodes,d=0;d<c.length;d++)if(1==c[d].nodeType&&this.isTag(a,c[d]))return c[d];return null},sforce.XmlReader.prototype.getFirstElement=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(1==b[c].nodeType)return b[c];return null},sforce.XmlReader.prototype.isTag=function(a,b){var c=b.nodeName.split(":");return 2==c.length&&c[1]==a?!0:1==c.length&&c[0]==a?!0:!1},sforce.XmlReader.prototype.isNameValueNode=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(3!=b[c].nodeType)return!1;return!0},sforce.XmlReader.prototype.getTextValue=function(a){if(3==a.nodeType)return a.nodeValue;var b=a.getAttribute("xsi:nil");if("true"==b)return null;for(var c="",d=a.childNodes,e=0;e<d.length;e++){if(3!=d[e].nodeType)throw"Not a simple name value node";c+=d[e].nodeValue}return c},sforce.XmlReader.prototype.toXmlObject=function(a){var b=a.getAttribute("xsi:nil");if("true"==b)return null;var c=new sforce.Xml,d=[];for(d.push({node:a,obj:c});d.length>0;)for(var e=d.shift(),f=e.node.firstChild;null!==f;f=f.nextSibling)if(1==f.nodeType){var g=f.nodeName,h=g.indexOf(":");g=-1==h?g:g.substring(h+1);for(var i,j=!0,k="",l=f.firstChild;null!==l;l=l.nextSibling){if(3!=l.nodeType){j=!1;break}k+=l.nodeValue}if(j?i="true"==f.getAttribute("xsi:nil")?null:k:(i=new sforce.Xml,d.push({node:f,obj:i})),e.obj[g])if(e.obj[g].push)e.obj[g].push(i);else{var m=e.obj[g];"Id"===g&&m===i||(e.obj[g]=[],e.obj[g].push(m),e.obj[g].push(i))}else e.obj[g]=i}return c},sforce.SoapTransport=function(){this.connectionCallback=null,this.result=null,this.fault=null,this.isAsync=!0,this.isArray=!1},sforce.SoapTransport.prototype.onFailure=function(a){var b="ERROR: ........... ";alert(b+a),this.result=null},sforce.SoapTransport.prototype.send=function(a,b,c,d){this.isArray=c;var e=new sforce.Transport(a);if(this.isAsync=d?!0:!1,!this.isAsync){if(e.send(b.toString(),this,this.isAsync),null!==this.fault)throw this.fault;return this.result}this.connectionCallback=d,e.send(b.toString(),this,this.isAsync,d.timeout)},sforce.SoapTransport.prototype.httpCallback=function(a,b){try{if(b===!0){var c=new sforce.XmlReader(a);c.getEnvelope();var d=c.getBody(),e=c.getFirstElement(d);if(null===e)throw"Unable to find operation response element";for(var f=[],g=e.childNodes,h=0;h<g.length;h++)1==g[h].nodeType&&f.push(c.isNameValueNode(g[h])?c.getTextValue(g[h]):c.toXmlObject(g[h]));if(this.isArray)this.result=f;else{if(f.length>1)throw"Found more than one response: "+f;this.result=f[0]}if(this.isAsync)try{if(this.beforeCallback(),"function"==typeof this.connectionCallback)this.connectionCallback(this.result);else{if(!this.connectionCallback.onSuccess)throw"Unable to find onSuccess method in the callback object";this.connectionCallback.onSuccess(this.result,this.connectionCallback.source)}}finally{this.afterCallback()}}else if("undefined"!=typeof a.nodeName){var i=new sforce.XmlReader(a);i.getEnvelope();var j=i.getBody(),k=i.getFirstElement(j),l=i.toXmlObject(k);this.sendFault(l)}else this.sendFault(a)}catch(m){this.sendFault(m)}},sforce.SoapTransport.prototype.sendFault=function(a){if(this.isAsync)if(this.connectionCallback.onFailure)try{this.beforeCallback(),this.connectionCallback.onFailure(a,this.connectionCallback.source)}finally{this.afterCallback()}else this.onFailure(a);else this.fault=a},sforce.SoapTransport.prototype.beforeCallback=function(){},sforce.SoapTransport.prototype.afterCallback=function(){},sforce.SObject=function(a){this.type=a},sforce.SObject.prototype=new sforce.Xml("sObjects"),sforce.LeadConvert=function(){},sforce.LeadConvert.prototype=new sforce.Xml("leadConverts"),sforce.MergeRequest=function(){},sforce.MergeRequest.prototype=new sforce.Xml("request"),sforce.QuickAction=function(){},sforce.QuickAction.prototype=new sforce.Xml("quickActions"),sforce.MatchOptions=function(){},sforce.MatchOptions.prototype=new sforce.Xml("matchOptions"),sforce.Connection=function(){this.sessionId=null,this.updateMru=null,this.allowFieldTruncation=null,this.disableFeedTracking=null,this.streamingEnabled=null,this.allOrNone=null,this.client=null,this.defaultNamespace=null,this.batchSize=null,this.loginScopeHeader=null,this.emailHeader=null,this.assignmentRuleHeader=null,this.transferToUserId=null,this.debuggingHeader=null,this.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/31.0"):"/services/Soap/u/31.0"},sforce.internal.Parameter=function(a,b,c){this.name=a,this.value=b,this.isArray=c},sforce.Connection.prototype.sforceNs="urn:partner.soap.sforce.com",sforce.Connection.prototype.sobjectNs="sobject.partner.soap.sforce.com",sforce.Connection.prototype.writeOne=function(a,b,c,d){null===c?a.writeNameValueNode(b,null):c.toXml?c.toXml(d,b,a):a.writeNameValueNode(b,c)},sforce.Connection.prototype.init=function(a,b){this.sessionId=a,this.serverUrl=b},sforce.Connection.prototype.login=function(a,b){var c=new sforce.internal.Parameter("username",a,!1),d=new sforce.internal.Parameter("password",b,!1),e=this.invoke("login",[c,d],!1,null);return this.sessionId=e.sessionId,e},sforce.Connection.prototype.describeSObject=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!1);return this.invoke("describeSObject",[c],!1,b)},sforce.Connection.prototype.describeSObjects=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!0);return this.invoke("describeSObjects",[c],!0,b)},sforce.Connection.prototype.describeGlobal=function(a){return this.invoke("describeGlobal",[],!1,a)},sforce.Connection.prototype.describeLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeLayout",[d,e],!1,c)},sforce.Connection.prototype.describeAvailableQuickActions=function(a,b){var c=new sforce.internal.Parameter("parentType",a,!1);return this.invoke("describeAvailableQuickActions",[c],!0,b)},sforce.Connection.prototype.describeQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActionNames",a,!0);return this.invoke("describeQuickActions",[c],!0,b)},sforce.Connection.prototype.performQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActions",a,!0);return this.invoke("performQuickActions",[c],!0,b)},sforce.Connection.prototype.describeCompactLayouts=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeCompactLayouts",[d,e],!1,c)},sforce.Connection.prototype.describePrimaryCompactLayouts=function(a,b){var c=new sforce.internal.Parameter("sObjectTypes",a,!0);return this.invoke("describePrimaryCompactLayouts",[c],!0,b)},sforce.Connection.prototype.describeApprovalLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("approvalProcessNames",b,!0);return this.invoke("describeApprovalLayout",[d,e],!1,c)},sforce.Connection.prototype.describeTabs=function(a){return this.invoke("describeTabs",[],!0,a)},sforce.Connection.prototype.describeAllTabs=function(a){return this.invoke("describeAllTabs",[],!0,a)},sforce.Connection.prototype.describeTheme=function(a){return this.invoke("describeTheme",[],!0,a)},sforce.Connection.prototype.describeGlobalTheme=function(a){return this.invoke("describeGlobalTheme",[],!0,a)},sforce.Connection.prototype.describeSoftphoneLayout=function(a){return this.invoke("describeSoftphoneLayout",[],!1,a)},sforce.Connection.prototype.describeMiniLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1),e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeMiniLayout",[d,e],!1,c)},sforce.Connection.prototype.describeSearchScopeOrder=function(a){return this.invoke("describeSearchScopeOrder",[],!0,a)},sforce.Connection.prototype.create=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("create",[c],!0,b)},sforce.Connection.prototype.update=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("update",[c],!0,b)},sforce.Connection.prototype.upsert=function(a,b,c){var d=new sforce.internal.Parameter("externalIDFieldName",a,!1),e=new sforce.internal.Parameter("sObjects",b,!0);return this.invoke("upsert",[d,e],!0,c)},sforce.Connection.prototype.deleteIds=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("delete",[c],!0,b)},sforce.Connection.prototype.impersonateUser=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("impersonateUser",[c],!0,b)},sforce.Connection.prototype.query=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("query",[c],!1,b)},sforce.Connection.prototype.queryAll=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("queryAll",[c],!1,b)},sforce.Connection.prototype.queryMore=function(a,b){var c=new sforce.internal.Parameter("queryLocator",a,!1);return this.invoke("queryMore",[c],!1,b)},sforce.Connection.prototype.retrieve=function(a,b,c,d){var e=new sforce.internal.Parameter("fieldList",a,!1),f=new sforce.internal.Parameter("sObjectType",b,!1),g=new sforce.internal.Parameter("ids",c,!0);return this.invoke("retrieve",[e,f,g],!0,d)},sforce.Connection.prototype.match=function(a,b,c){var d=new sforce.internal.Parameter("sObjects",a,!0),e=new sforce.internal.Parameter("matchOptions",b,!1);return this.invoke("match",[d,e],!1,c)},sforce.Connection.prototype.getUserInfo=function(a){return this.invoke("getUserInfo",[],!1,a)},sforce.Connection.prototype.resetPassword=function(a,b){var c=new sforce.internal.Parameter("userId",a,!1);return this.invoke("resetPassword",[c],!1,b)},sforce.Connection.prototype.setPassword=function(a,b,c){var d=new sforce.internal.Parameter("userId",a,!1),e=new sforce.internal.Parameter("password",b,!1);return this.invoke("setPassword",[d,e],!1,c)},sforce.Connection.prototype.search=function(a,b){var c=new sforce.internal.Parameter("searchString",a,!1);return this.invoke("search",[c],!1,b)},sforce.Connection.prototype.getDeleted=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getDeleted",[e,f,g],!1,d)},sforce.Connection.prototype.getUpdated=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getUpdated",[e,f,g],!1,d)},sforce.Connection.prototype.getServerTimestamp=function(a){return this.invoke("getServerTimestamp",[],!1,a)},sforce.Connection.prototype.convertLead=function(a,b){var c=new sforce.internal.Parameter("leadConverts",a,!0);return this.invoke("convertLead",[c],!0,b)},sforce.Connection.prototype.merge=function(a,b){var c=new sforce.internal.Parameter("request",a,!0);return this.invoke("merge",[c],!0,b)},sforce.Connection.prototype.undelete=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("undelete",[c],!0,b)},sforce.Connection.prototype.process=function(a,b){var c=new sforce.internal.Parameter("actions",a,!0);return this.invoke("process",[c],!0,b)},sforce.Connection.prototype.sendEmail=function(a,b){var c=new sforce.internal.Parameter("messages",a,!0);return this.invoke("sendEmail",[c],!0,b)},sforce.Connection.prototype.emptyRecycleBin=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("emptyRecycleBin",[c],!0,b)},sforce.Connection.prototype.invalidateSessions=function(a,b){var c=new sforce.internal.Parameter("sessionIds",a,!0);return this.invoke("invalidateSessions",[c],!0,b)},sforce.Connection.prototype.logout=function(a){return this.invoke("logout",[],!0,a)},sforce.Connection.prototype.remoteFunction=function(a){function b(){if(sforce.debug.trace&&sforce.debug.log("callback called ..."),4==c.readyState)if(200==c.status)if("text/plain"==a.mimeType)a.onSuccess(c.responseText,c);else{if("text/xml"!=a.mimeType)throw"unsupported mime type: "+a.mimeType;if(!c.responseXML||!c.responseXML.documentElement)throw"Response not text/xml mime type: "+c.responseText;a.onSuccess(c.responseXML.documentElement,c)}else a.onFailure?a.onFailure(c.responseText,c):sforce.debug.log(c.responseText)}if(!a.url)throw"url not defined";if(!a.onSuccess)throw"onSuccess method not defined";if(a.method||(a.method="GET"),a.mimeType||(a.mimeType="text/plain"),"undefined"==typeof a.async&&(a.async=!0),"undefined"==typeof a.cache&&(a.cache=!1),"text/plain"!=a.mimeType&&"text/xml"!=a.mimeType)throw"Unknown mime type "+a.mimeType;sforce.debug.trace&&sforce.debug.log("Open connection to ... "+a.url);var c=(new sforce.Transport).newConnection(),d="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/proxy"):"/services/proxy";if(d=a.cache?d+"?end-point-url="+a.url:d+"?no-cache="+(new Date).getTime(),c.open(a.method,d,a.async),a.requestHeaders)for(var e in a.requestHeaders)"function"!=typeof a.requestHeaders[e]&&c.setRequestHeader(e,a.requestHeaders[e]);c.setRequestHeader("SalesforceProxy-Endpoint",a.url),c.setRequestHeader("SalesforceProxy-SID",this.sessionId),a.async&&(c.onreadystatechange=b),sforce.debug.trace&&sforce.debug.log("Sending ..."),c.send(a.requestData?a.requestData:null),sforce.debug.trace&&sforce.debug.log("Done Sending ..."),a.async||b()},sforce.Connection.prototype.writeHeader=function(a,b){if(a.startHeader(),a.writeNamespace(b,"sfns"),null!==this.sessionId&&(a.writeStartElement("SessionHeader",b),a.writeNameValueNode("sessionId",this.sessionId),a.writeEndElement("SessionHeader",b)),"undefined"!=typeof this.organizationId)throw"Use sforce.connection.loginScopeHeader.organizationId instead of sforce.connection.organizationId";if(null!==this.loginScopeHeader&&(a.writeStartElement("LoginScopeHeader",b),null!==this.loginScopeHeader.organizationId&&a.writeNameValueNode("organizationId",this.loginScopeHeader.organizationId),null!==this.loginScopeHeader.portalId&&a.writeNameValueNode("portalId",this.loginScopeHeader.portalId),a.writeEndElement("LoginScopeHeader",b)),(null!==this.client||null!==this.defaultNamespace)&&(a.writeStartElement("CallOptions",b),null!==this.client&&a.writeNameValueNode("client",this.client),null!==this.defaultNamespace&&a.writeNameValueNode("defaultNamespace",this.defaultNamespace),a.writeEndElement("CallOptions",b)),null!==this.batchSize&&(a.writeStartElement("QueryOptions",b),a.writeNameValueNode("batchSize",this.batchSize),a.writeEndElement("QueryOptions",b)),null!==this.allowFieldTruncation&&(a.writeStartElement("AllowFieldTruncationHeader",b),a.writeNameValueNode("allowFieldTruncation",this.allowFieldTruncation),a.writeEndElement("AllowFieldTruncationHeader",b)),null!==this.disableFeedTracking&&(a.writeStartElement("DisableFeedTrackingHeader",b),a.writeNameValueNode("disableFeedTracking",this.disableFeedTracking),a.writeEndElement("DisableFeedTrackingHeader",b)),null!==this.streamingEnabled&&(a.writeStartElement("StreamingEnabledHeader",b),a.writeNameValueNode("StreamingEnabled",this.streamingEnabled),a.writeEndElement("StreamingEnabledHeader",b)),null!==this.allOrNone&&(a.writeStartElement("AllOrNoneHeader",b),a.writeNameValueNode("allOrNone",this.allOrNone),a.writeEndElement("AllOrNoneHeader",b)),null!==this.updateMru&&(a.writeStartElement("MruHeader",b),a.writeNameValueNode("updateMru",this.updateMru),a.writeEndElement("MruHeader",b)),null!==this.emailHeader&&(a.writeStartElement("EmailHeader",b),this.emailHeader.triggerAutoResponseEmail&&a.writeNameValueNode("triggerAutoResponseEmail",this.emailHeader.triggerAutoResponseEmail),this.emailHeader.triggerOtherEmail&&a.writeNameValueNode("triggerOtherEmail",this.emailHeader.triggerOtherEmail),this.emailHeader.triggerUserEmail&&a.writeNameValueNode("triggerUserEmail",this.emailHeader.triggerUserEmail),a.writeEndElement("EmailHeader",b)),null!==this.assignmentRuleHeader&&(a.writeStartElement("AssignmentRuleHeader",b),this.assignmentRuleHeader.assignmentRuleId&&a.writeNameValueNode("assignmentRuleId",this.assignmentRuleHeader.assignmentRuleId),this.assignmentRuleHeader.useDefaultRule&&a.writeNameValueNode("useDefaultRule",this.assignmentRuleHeader.useDefaultRule),a.writeEndElement("AssignmentRuleHeader",b)),null!==this.transferToUserId&&(a.writeStartElement("UserTerritoryDeleteHeader",b),a.writeNameValueNode("transferToUserId",this.transferToUserId),a.writeEndElement("UserTerritoryDeleteHeader",b)),null!==this.debuggingHeader){if(a.writeStartElement("DebuggingHeader",b),this.debuggingHeader.debugLevel&&a.writeNameValueNode("debugLevel",this.debuggingHeader.debugLevel),this.debuggingHeader.debugCategories)for(var c=this.debuggingHeader.debugCategories,d=0;d<c.length;d++){var e=c[d].split(",");2==e.length&&(a.writeStartElement("categories"),a.writeNameValueNode("category",e[0]),a.writeNameValueNode("level",e[1]),a.writeEndElement("categories"))}a.writeEndElement("DebuggingHeader",b)}a.endHeader()},sforce.Connection.prototype.namespaceMap=[{ns:sforce.Connection.prototype.sforceNs,prefix:null},{ns:sforce.Connection.prototype.sobjectNs,prefix:"ns1"}],sforce.Connection.prototype.invoke=function(a,b,c,d){return this._invoke(a,b,c,d,this.namespaceMap,this.serverUrl,this.sforceNs,this.sobjectNs)},sforce.Connection.prototype._invoke=function(a,b,c,d,e,f,g,h){if(d)if("function"==typeof d);else{if(!d.onSuccess)throw"onSuccess not defined in the callback";if(!d.onFailure)throw"onFailure not defined in the callback"}var i=new sforce.XmlWriter;i.startEnvelope(),this.writeHeader(i,g),i.startBody(),i.writeStartElement(a);for(var j=0;j<e.length;j++)i.writeNamespace(e[j].ns,e[j].prefix);for(var j=0;j<b.length;j++){var k=b[j];if("undefined"==typeof k.value)throw"arg "+j+" '"+k.name+"' not specified";if(null!==k.value){if(k.isArray&&!k.value.push)throw"arg "+j+" '"+k.name+"' is an array. But passed in value is not an array";if(!k.isArray&&k.value.push)throw"arg "+j+" '"+k.name+"' is not an array. But passed in value is an array"}if(null===k.value)this.writeOne(i,k.name,null,h);else if(k.value.push)for(var l=0;l<k.value.length;l++){var m=k.value[l];if(!m)throw"Array element at "+l+" is null.";this.writeOne(i,k.name,m,h)}else this.writeOne(i,k.name,k.value,h)}i.writeEndElement(a),i.endBody(),i.endEnvelope(),sforce.debug.trace&&(sforce.debug.log("Request: server- "+f),sforce.debug.logXml(i.toString()));var n=new sforce.SoapTransport;return n.send(f,i,c,d)},sforce.QueryResultIterator=function(a){this.queryResult=a,this.index=0,this.records=this.queryResult.getArray("records")},sforce.QueryResultIterator.prototype.hasNext=function(){return this.records.length>this.index?!0:(null!==this.queryResult.queryLocator&&(this.queryResult=sforce.connection.queryMore(this.queryResult.queryLocator),this.records=this.queryResult.getArray("records"),this.index=0),this.records.length>this.index?!0:!1)},sforce.QueryResultIterator.prototype.next=function(){if(this.records.length>this.index){var a=this.records[this.index];return this.index++,a}throw"Index out of bound : "+this.index},sforce.Email=function(){},sforce.Email.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage=function(){},sforce.MassEmailMessage.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage.prototype._xsiType="MassEmailMessage",sforce.SingleEmailMessage=function(){},sforce.SingleEmailMessage.prototype=new sforce.Xml("messages"),sforce.SingleEmailMessage.prototype._xsiType="SingleEmailMessage",sforce.ProcessRequest=function(){},sforce.ProcessRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest=function(){},sforce.ProcessSubmitRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest.prototype._xsiType="ProcessSubmitRequest",sforce.ProcessWorkitemRequest=function(){},sforce.ProcessWorkitemRequest.prototype=new sforce.Xml("actions"),sforce.ProcessWorkitemRequest.prototype._xsiType="ProcessWorkitemRequest",sforce.connection=new sforce.Connection;var UserContext="undefined"!=typeof window.UserContext?window.UserContext:{siteUrlPrefix:"",getUrl:function(a){return"undefined"!=typeof a&&"undefined"!=typeof UserContext.siteUrlPrefix&&UserContext.siteUrlPrefix?0!=a.indexOf("/")?a:0==a.indexOf(UserContext.siteUrlPrefix)?a:UserContext.siteUrlPrefix+a:a}};"undefined"!=typeof __sfdcSiteUrlPrefix&&(UserContext.siteUrlPrefix=__sfdcSiteUrlPrefix),sforce.connection.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/31.0"):"/services/Soap/u/31.0","undefined"!=typeof __sfdcSessionId&&(sforce.connection.sessionId=__sfdcSessionId),window.Sfdc&&Sfdc.xdomain&&(window.sforce=window.sforce||{},sforce.console=function(){function a(){var a=null;try{a=top.location.href}catch(b){}return"string"==typeof a&&top.isServiceDeskPage}function b(a,b,c){if(c.event){var d,e,f=a===n,g="chatOnNewMessage"===a||"chatOnTypingUpdate"===a||"chatOnCustomEvent"===a||"chatOnCriticalWaitState"===a||"chatOnAgentSend"===a||"chatOnFileTransferCompleted"===a;return a===m?d=[{fn:b,id:c.callObjectId}]:f?(d={},d[c.eventType]=[b]):g?(d={},d[a+c.eventId]=[b]):d=[b],new(e=function(){this.add=function(b,c){var e=!0;return a===m?d.push({fn:b,id:c.callObjectId}):f?(d[c.eventType]||(e=!1,d[c.eventType]=[]),d[c.eventType].push(b)):g?(d[a+c.eventId]||(e=!1,d[a+c.eventId]=[]),d[a+c.eventId].push(b)):d.push(b),e},this.del=function(a,b){if(f){var c=d[b.eventType],e={unregisterFrameForEvent:!1,unregisterFrameForEveryEvent:!1};if(!c)return e;for(var g=0;g<c.length;g++)if(c[g]===a){c.splice(g,1);break}0===c.length&&(e.unregisterFrameForEvent=!0);for(var h in d)if(d.hasOwnProperty(h)&&d[h].length>0)return e;return e.unregisterFrameForEveryEvent=!0,i.removeFunction(n),e}},this.call=function(b,c,e,h){var i,j;if(f)for(i=d[c.eventType]?d[c.eventType]:[],delete c.eventType,j=0;j<i.length;j++)i[j].call(b,c,e,h);else if(g)for(i=d[a+c.eventId]?d[a+c.eventId]:[],delete c.eventId,j=0;j<i.length;j++)i[j].call(b,c,e,h);else for(j=0;j<d.length;){if("function"==typeof d[j].fn){if(d[j].id&&d[j].id!==c.id)continue;d[j].fn.call(b,c,e,h),d[j].id===c.id&&(d.splice(j,1),j--)}else d[j].call(b,c,e,h);j++}}})}return function(c){i.removeFunction(a),b.call(this,c)}}function c(){var a=window.location.toString(),b="://",c=["/","?","#"],d=a.indexOf(b),e="";if(-1!==d){var f=a.split(b);e=f[0]+b,a=f[1];for(var g=0;g<c.length;g++){var h=a.indexOf(c[g]);if(-1!==h){a=a.substring(0,h);break}}}return e+a}function d(d,e,f){var g;if(a()){var j=top.Sfdc.crossdomain.CrossDomainApiRegistry.getFunction(d),m=top.Sfdc.xdomain.EmbeddedVFPages;if(frameId=window.name,window.parent!==window.top&&m&&(frameId=m[frameId]||frameId),"function"==typeof f&&e.event){if(i.getFunction(d)){if(g=i.getFunction(d).func.add(f,e))return{success:!0}}else i.registerFunction(d,b(d,f,e),this);return j.func.call(j.scope,e,{frameId:frameId},function(a){i.getFunction(d).func.call(this,a)})}return j.func.call(j.scope,e,{frameId:frameId},f)}if("function"==typeof f){var n=e.event?d:d+"_"+l;if(e.event&&i.getFunction(n)){if(g=i.getFunction(n).func.add(f,e))return}else i.registerFunction(n,b(n,f,e),this)}var o={};o.pathToTargetProxy=h?Sfdc.xdomain.sfdcXDomainProxy:"",o.name=d,o.args=e,o.calleeName=k,o.txn_id=l,o.pathToOriginProxy=c()+(h?"/support/console/xdomain/30.0/crossDomainProxy.html":""),l++,r.usePostMessage()?r.doPostMessage(o):h.call(o)}function e(a){return!!a}function f(a){return a&&"string"==typeof a}function g(a){return a&&"function"==typeof a}var h,i,j="31.0",k="sfdc-console",l=0,m="onCallEnd",n="addEventListener",o="addPushNotificationListener",p=function(){this.registry={}};p.prototype.registerFunction=function(a,b,c){this.registry[a]={func:b,scope:c}},p.prototype.getFunction=function(a){return this.registry[a]},p.prototype.removeFunction=function(a){delete this.registry[a]};var q=function(){var a=null;return{isCanvasContext:function(){return!("undefined"==typeof Sfdc||!Sfdc.canvas||!Sfdc.canvas.client)},getParsedRequest:function(){if(!a){var b=Sfdc.canvas.client.signedrequest();if(b)if("string"==typeof b)try{a=JSON.parse(b)}catch(c){return null}else a=b}return a},parseAuthenticationParams:function(b){if(this.isCanvasContext()&&(a=this.getParsedRequest())){var c;a.context?c=a.context.environment:a.payload&&(c=a.payload.environment),c&&c.parameters&&(b.sfdcIFrameOrigin=c.parameters.sfdcIframeOrigin,b.nonce=c.parameters.nonce)}},isInConsole:function(){if(this.isCanvasContext()&&(a=this.getParsedRequest())){var b=a.context.environment;if(b&&b.parameters.isInConsole)return!0}return!1}}}(),r={nonce:null,sfdcIFrameOrigin:null,INTEGRATION_API:"integrationApi/",usePostMessage:function(){return window.postMessage&&this.sfdcIFrameOrigin&&this.nonce?!0:(this.parseAuthenticationParams(),!!(window.postMessage&&this.sfdcIFrameOrigin&&this.nonce))},parseAuthenticationParams:function(){var a=this.parseUrlQueryString(location.search);this.sfdcIFrameOrigin=a.sfdcIFrameOrigin?a.sfdcIFrameOrigin.toLowerCase():null,this.nonce=a.nonce,this.sfdcIFrameOrigin&&this.nonce||q.parseAuthenticationParams(this)},initialize:function(){window.attachEvent?window.attachEvent("onmessage",this.processPostMessage):window.addEventListener("message",this.processPostMessage,!1)},registry:new p,parser:function(){function a(a){return"[object Array]"===Object.prototype.toString.apply(a)}function b(a){for(var b="",c="",d=0;d<a.length;d++)c+=b+encodeURIComponent(a[d]),b=g;return c}var c="b",d="s",e="a",f="&",g=";",h=":",i="=";return{parse:function(a){for(var b={},d=a.split(f),j=0;j<d.length;j++){var k,l=d[j].split(i),m=l[1].split(h);if(m[0]===e){var n=m[1].split(g);k=[];for(var o=0;o<n.length;o++)k[o]=decodeURIComponent(n[o])}else k=decodeURIComponent(m[1]);m[0]===c&&(k="true"===k),b[decodeURIComponent(l[0])]=k}return b},stringify:function(g){var j="",k="";for(var l in g)if(g.hasOwnProperty(l)){var m;a(g[l])?k+=j+encodeURIComponent(l)+i+e+h+b(g[l]):(m="boolean"==typeof g[l]?c:d,k+=j+encodeURIComponent(l)+i+m+h+encodeURIComponent(g[l])),j=f}return k}}}(),doPostMessage:function(a){var b=(a.calleeName+"_proxyFrame_"+a.txn_id,{});"undefined"!=typeof a.name&&(b.xdomain_name=a.name),"undefined"!=typeof a.calleeName&&(b.xdomain_targetFrame=a.calleeName),"undefined"!=typeof a.txn_id&&(b.xdomain_txnId=a.txn_id),"undefined"!=typeof a.pathToOriginProxy&&(b.xdomain_pathToOriginProxy=a.pathToOriginProxy),"undefined"!=typeof a.targetParentFrame&&(b.xdomain_targetParentFrame=a.targetParentFrame),b.xdomain_originFrame=window.name,b.nonce=this.nonce;var c=this.parser.stringify(b);"undefined"!=typeof a.args&&(c+="&"+this.parser.stringify(a.args)),top.postMessage(this.INTEGRATION_API+c,this.sfdcIFrameOrigin)},processPostMessage:function(a){var b,c,d={};if(a.origin===r.sfdcIFrameOrigin&&(!a.data||0===a.data.indexOf(r.INTEGRATION_API))){var e=a.data.replace(r.INTEGRATION_API,"");c=r.parser.parse(e),c.args=r.parser.parse(c.args),b=i.getFunction(c.name),d.frameId=c.originFrame,"undefined"!=typeof b&&b.func.call(b.scope,c.args,d)}},parseUrlQueryString:function(a){var b={};if("string"!=typeof a)return b;if("?"===a.charAt(0)&&(a=a.slice(1)),0===a.length)return b;for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e[1]?decodeURIComponent(e[1]):null}return b}};a()?i=new p:r.usePostMessage()?(i=r.registry,r.initialize()):window.Sfdc&&Sfdc.xdomain?(h=Sfdc.xdomain.Caller,i=Sfdc.xdomain.CrossDomainApiRegistry):window.console&&console.log;var s=function(){var a="SFORCE_CONSOLE",b=":",c="_TAB",d="SFORCE_PRESENCE",e={CLOSE_TAB:a+b+"CLOSE_TAB",OPEN_TAB:a+b+"OPEN_TAB",CONSOLE_LOGOUT:a+b+"LOGOUT",PRESENCE:{LOGIN_SUCCESS:d+b+"LOGIN_SUCCESS",STATUS_CHANGED:d+b+"STATUS_CHANGED",SFDC_LOGOUT:d+b+"SFDC_LOGOUT",WORK_ASSIGNED:d+b+"WORK_ASSIGNED",WORK_ACCEPTED:d+b+"WORK_ACCEPTED",WORK_DECLINED:d+b+"WORK_DECLINED",WORK_CLOSED:d+b+"WORK_CLOSED"}},f=function(a,b){return a&&b?a.indexOf(b)+b.length===a.length:!1
};return{getTypes:function(){return e},getFullyQualifiedEventType:function(a,d){return f(a,c)&&d&&d.tabId&&(a=[a,d.tabId].join(b)),a},isConsoleEventType:function(a){for(var b in e)if(e.hasOwnProperty(b)&&e[b]===a)return!0;return!1}}}();return{openPrimaryTab:function(a,b,c,f,g,h){var i={};a&&(i.id=a),"undefined"!=typeof b&&(i.url=b),"undefined"!=typeof c&&(i.activate=e(c)),"undefined"!=typeof f&&(i.label=f),"undefined"!=typeof h&&(i.name=h),i.version=j,d("openPrimaryTab",i,g)},openSubtab:function(a,b,c,f,g,h,i){var k={};a&&(k.workspaceId=a),"undefined"!=typeof b&&(k.url=b),"undefined"!=typeof c&&(k.activate=e(c)),"undefined"!=typeof f&&(k.label=f),g&&(k.id=g),i&&(k.name=i),k.version=j,d("openSubTab",k,h)},openSubtabByPrimaryTabName:function(a,b,c,f,g,h,i){var k={};a&&(k.workspaceName=a),"undefined"!=typeof b&&(k.url=b),"undefined"!=typeof c&&(k.activate=e(c)),"undefined"!=typeof f&&(k.label=f),g&&(k.id=g),i&&(k.name=i),k.version=j,d("openSubtabByWorkSpaceName",k,h)},getEnclosingTabId:function(a){var b={};b.version=j,d("getEnclosingTabId",b,a)},getEnclosingPrimaryTabId:function(a){var b={};return b.version=j,d("getEnclosingPrimaryTabId",b,a)},getEnclosingPrimaryTabObjectId:function(a){var b={};b.version=j,d("getEnclosingPrimaryTabObjectId",b,a)},getPrimaryTabIds:function(a){var b={};b.version=j,d("getPrimaryTabIds",b,a)},getSubtabIds:function(a,b){var c={};c.version=j,a&&(c.primaryTabId=a),d("getSubtabIds",c,b)},getPageInfo:function(a,b){var c={};c.version=j,a&&(c.tabId=a),d("getPageInfo",c,b)},getFocusedSubtabObjectId:function(a){var b={};b.version=j,d("getFocusedSubtabObjectId",b,a)},resetSessionTimeOut:function(){var a={};a.version=j,d("resetSessionTimeOut",a)},setTabTitle:function(a,b){var c={};c.label=a,b&&(c.tabId=b),c.version=j,d("setTabTitle",c)},closeTab:function(a){var b={};b.id=a,b.version=j,d("closeTab",b)},isInConsole:function(){var a=location.search;return 0!==a.length&&(a.indexOf("?isdtp=")>-1||a.indexOf("&isdtp=")>-1)||q.isInConsole()},refreshSubtabById:function(a,b,c){var f={};a&&(f.id=a),"undefined"!=typeof b&&(f.activate=e(b)),f.version=j,d("refreshSubtabById",f,c)},refreshSubtabByNameAndPrimaryTabName:function(a,b,c,f){var g={};a&&(g.name=a),b&&(g.workspaceName=b),"undefined"!=typeof c&&(g.activate=e(c)),g.version=j,d("refreshSubtabByNameAndWorkspaceName",g,f)},refreshSubtabByNameAndPrimaryTabId:function(a,b,c,f){var g={};a&&(g.name=a),b&&(g.workspaceId=b),"undefined"!=typeof c&&(g.activate=e(c)),g.version=j,d("refreshSubtabByNameAndWorkspaceId",g,f)},refreshPrimaryTabById:function(a,b,c){var f={};a&&(f.id=a),"undefined"!=typeof b&&(f.activate=e(b)),f.version=j,d("refreshPrimaryTabById",f,c)},refreshPrimaryTabByName:function(a,b,c){var f={};a&&(f.name=a),"undefined"!=typeof b&&(f.activate=e(b)),f.version=j,d("refreshPrimaryTabByName",f,c)},focusSubtabById:function(a,b){var c={};a&&(c.id=a),c.version=j,d("focusSubtabById",c,b)},focusSubtabByNameAndPrimaryTabName:function(a,b,c){var e={};a&&(e.name=a),b&&(e.workspaceName=b),e.version=j,d("focusSubtabByNameAndWorkspaceName",e,c)},focusSubtabByNameAndPrimaryTabId:function(a,b,c){var e={};a&&(e.name=a),b&&(e.workspaceId=b),e.version=j,d("focusSubtabByNameAndWorkspaceId",e,c)},focusPrimaryTabById:function(a,b){var c={};a&&(c.id=a),c.version=j,d("focusPrimaryTabById",c,b)},focusPrimaryTabByName:function(a,b){var c={};a&&(c.name=a),c.version=j,d("focusPrimaryTabByName",c,b)},setTabUnsavedChanges:function(a,b,c){var f={};"undefined"!=typeof a&&(f.isDirty=e(a)),f.version=j,c&&(f.subtabId=c),d("setTabDirty",f,b)},onTabSave:function(a){var b={};b.version=j,b.event=!0,d("onTabSave",b,a)},onFocusedSubtab:function(a){var b={};b.version=j,b.event=!0,d("onFocusedSubtab",b,a)},onFocusedPrimaryTab:function(a){var b={};b.version=j,b.event=!0,d("onFocusedPrimaryTab",b,a)},onEnclosingTabRefresh:function(a){var b={};b.version=j,b.event=!0,d("onEnclosingTabRefresh",b,a)},getFocusedPrimaryTabId:function(a){var b={};b.version=j,d("getFocusedPrimaryTabId",b,a)},getFocusedPrimaryTabObjectId:function(a){var b={};b.version=j,d("getFocusedPrimaryTabObjectId",b,a)},getFocusedSubtabId:function(a){var b={};b.version=j,d("getFocusedSubtabId",b,a)},isInCustomConsoleComponent:function(a){var b={};b.version=j,d("isInCustomConsoleComponent",b,a)},setCustomConsoleComponentButtonText:function(a,b){var c={};c.version=j,c.text=a,d("setCustomConsoleComponentButtonText",c,b)},setCustomConsoleComponentButtonStyle:function(a,b){var c={};c.version=j,c.style=a,d("setCustomConsoleComponentButtonStyle",c,b)},setCustomConsoleComponentButtonIconUrl:function(a,b){var c={};c.version=j,c.iconUrl=a,d("setCustomConsoleComponentButtonIconUrl",c,b)},setCustomConsoleComponentWindowVisible:function(a,b){var c={};c.version=j,c.visible=e(a),d("setCustomConsoleComponentWindowVisible",c,b)},isCustomConsoleComponentWindowHidden:function(a){var b={};b.version=j,d("isCustomConsoleComponentWindowHidden",b,a)},onCustomConsoleComponentButtonClicked:function(a){var b={};b.version=j,b.event=!0,d("onCustomConsoleComponentButtonClicked",b,a)},scrollCustomConsoleComponentButtonText:function(a,b,c,f){var g={};g.version=j,g.interval=a,g.pixelsToScroll=b,g.isLeftScrolling=e(c),d("scrollCustomConsoleComponentButtonText",g,f)},removeScrollCustomConsoleComponentButtonText:function(a){var b={};b.version=j,d("removeScrollCustomConsoleComponentButtonText",b,a)},blinkCustomConsoleComponentButtonText:function(a,b,c){var e={};e.version=j,e.alternateText=a,e.interval=b,d("blinkCustomConsoleComponentButtonText",e,c)},removeBlinkCustomConsoleComponentButtonText:function(a){var b={};b.version=j,d("removeBlinkCustomConsoleComponentButtonText",b,a)},setCustomConsoleComponentPopoutable:function(a,b){var c={};c.version=j,c.popoutable=!!a,d("setCustomConsoleComponentPopoutable",c,b)},isCustomConsoleComponentPoppedOut:function(a){var b={};b.version=j,d("isCustomConsoleComponentPoppedOut",b,a)},addEventListener:function(a,b,c){if(f(a)&&g(b)){s.isConsoleEventType(a)&&(a=s.getFullyQualifiedEventType(a,c));var e={};e.version=j,e.event=!0,e.eventType=a,d(n,e,b)}},removeEventListener:function(a,b,c){if(f(a)&&g(b)){s.isConsoleEventType(a)&&(a=s.getFullyQualifiedEventType(a,c));var e={};e.version=j,e.eventType=a;var h=i.getFunction(n).func.del(b,e);h&&(e.unregisterFrameForEvent=h.unregisterFrameForEvent,e.unregisterFrameForEveryEvent=h.unregisterFrameForEveryEvent),(e.removeFrameFromEvent||e.removeFrameFromEveryEvent)&&d("removeEventListener",e)}},fireEvent:function(a,b,c){if(f(a)){var e={};e.version=j,e.eventType=a,e.message=b,d("fireEvent",e,c)}},ConsoleEvent:s.getTypes(),addPushNotificationListener:function(a,b){var c={};return i.getFunction(o)?(window.console&&console.log,!1):(c.version=j,c.entities=a,c.event=!0,void d(o,c,b))},removePushNotificationListener:function(a){if(i.getFunction(o)){i.removeFunction(o);var b={};b.version=j,d("removePushNotificationListener",b,a)}},addToBrowserTitleQueue:function(a,b){var c={};c.version=j,a&&(c.title=a),d("addToBrowserTitleQueue",c,b)},removeFromBrowserTitleQueue:function(a,b){var c={};c.version=j,a&&(c.title=a),d("removeFromBrowserTitleQueue",c,b)},getTabLink:function(a,b,c){var e={};e.version=j,a&&(e.level=a),b&&(e.tabId=b),d("getTabLink",e,c)},setTabStyle:function(a,b,c){var e={};a&&(e.css=a),b&&(e.tabId=b),e.version=j,d("setTabStyle",e,c)},setTabTextStyle:function(a,b,c){var e={};a&&(e.css=a),b&&(e.tabId=b),e.version=j,d("setTabTextStyle",e,c)},setTabIcon:function(a,b,c){var e={};a&&(e.iconUrl=a),b&&(e.tabId=b),e.version=j,d("setTabIcon",e,c)},TabLink:{PARENT_AND_CHILDREN:"complete",TAB_ONLY:"thistabonly",SALESFORCE_URL:"standard"},setTabLink:function(a){var b={};b.version=j,b.link=window.location.href,d("setTabLink",b,a)},generateConsoleUrl:function(a,b){var c={};c.version=j,a&&(c.urls=a),d("generateConsoleUrl",c,b)},openConsoleUrl:function(a,b,c,f,g,h){var i={};i.version=j,a&&(i.tabId=a),b&&(i.consoleUrl=b),"undefined"!=typeof c&&(i.active=e(c)),f&&(i.tabLabels=f),g&&(i.tabNames=g),d("openConsoleUrl",i,h)},getSelectedNavigationTab:function(a){var b={};b.version=j,d("getSelectedNavigationTab",b,a)},setSelectedNavigationTab:function(a,b,c){var e={};e.version=j,c&&(e.listViewUrl=c),b&&(e.navigationTabId=b),d("setSelectedNavigationTab",e,a)},getNavigationTabs:function(a){var b={};b.version=j,d("getNavigationTabs",b,a)},focusNavigationTab:function(a){var b={};b.version=j,d("focusNavigationTab",b,a)},refreshNavigationTab:function(a){var b={};b.version=j,d("refreshNavigationTab",b,a)},modules:{CTI:"CTI",CHAT:"CHAT"},helper:function(){return{execute:function(){return d.apply(null,arguments)},getVersion:function(){return j}}}(),include:function(a,b,c){var d="/support/console/"+this.helper.getVersion()+"/integration_"+a+".js",e=document.getElementsByTagName("head")[0],f=document.createElement("script"),g=function(){b.call(c),e.removeChild(f)};f.type="text/javascript",f.onreadystatechange=function(){"complete"===this.readyState&&g()},f.onload=g,f.src=d,e.appendChild(f)}}}(),sforce.console.cti=function(a){var b=function(b,c,d){return c.version=a.getVersion(),a.execute(b,c,d)};return{getCallObjectIds:function(a){var c={};b("getCallObjectIds",c,a)},setCallObjectIds:function(a,c){var d={};d.callObjectIds=a,b("setCallObjectIds",d,c)},getCallAttachedData:function(a,c,d){var e={};e.callObjectId=a,"object"==typeof d&&d.hasOwnProperty("getCallType")&&(e.getCallType=d.getCallType),b("getCallAttachedData",e,c)},setCallAttachedData:function(a,c,d,e){var f={};f.callObjectId=a,f.callData=c,f.callType=d,b("setCallAttachedData",f,e)},onCallBegin:function(a){var c={};c.event=!0,b("onCallBegin",c,a)},fireOnCallBegin:function(a,c,d,e){var f={};f.callObjectId=a,f.callType=c,f.callLabel=d,b("fireOnCallBegin",f,e)},fireOnCallEnd:function(a,c,d,e){var f={};f.callObjectId=a,f.callDuration=c,f.callDisposition=d,b("fireOnCallEnd",f,e)},onCallEnd:function(a,c){var d={};d.callObjectId=c?c:null,d.event=!0,b("onCallEnd",d,a)},sendCTIMessage:function(a,c){var d={};d.msg=a,b("sendCTIMessage",d,c)},onSendCTIMessage:function(a){var c={};c.event=!0,b("onSendCTIMessage",c,a)},onCallLogSaved:function(a){var c={};c.event=!0,b("onCallLogSaved",c,a)},fireOnCallLogSaved:function(a,c){var d={};d.id=a,b("fireOnCallLogSaved",d,c)}}}(sforce.console.helper),sforce.console.chat=function(a){var b=function(b,c,d){return c.version=a.getVersion(),a.execute(b,c,d)};return{getDetailsByPrimaryTabId:function(a,c){var d={};d.primaryTabId=a,b("chatGetDetailsByPrimaryTabId",d,function(a){c.call(this,{success:a.success,primaryTabId:a.primaryTabId?a.primaryTabId:null,details:a.result?JSON.parse(a.result):null})})},getDetailsByChatKey:function(a,c){var d={};d.chatKey=a,b("chatGetDetailsByChatKey",d,function(a){c.call(this,{success:a.success,primaryTabId:a.primaryTabId?a.primaryTabId:null,details:a.result?JSON.parse(a.result):null})})},getChatLog:function(a,c){var d={};d.chatKey=a,b("chatGetChatLog",d,function(a){var b=a.result?JSON.parse(a.result):null;c.call(this,{success:a.success,messages:b?b.messages:null,customEvents:b?b.customEvents:null})})},getAgentInput:function(a,c){var d={};d.chatKey=a,b("chatGetAgentInput",d,c)},setAgentInput:function(a,c,d){var e={};e.chatKey=a,e.text=c,b("chatSetAgentInput",e,d)},sendMessage:function(a,c,d){var e={};e.chatKey=a,e.message=c,b("chatSendMessage",e,d)},onNewMessage:function(a,c){var d={};d.chatKey=a,d.event=!0,d.eventId=a,b("chatOnNewMessage",d,c)},onAgentSend:function(a,c){var d={};d.chatKey=a,d.event=!0,d.eventId=a,b("chatOnAgentSend",d,c)},onTypingUpdate:function(a,c){var d={};d.chatKey=a,d.event=!0,d.eventId=a,b("chatOnTypingUpdate",d,c)},onCustomEvent:function(a,c,d){var e={};e.chatKey=a,e.type=c,e.event=!0,e.eventId=a+c,b("chatOnCustomEvent",e,d)},sendCustomEvent:function(a,c,d,e){var f={};f.chatKey=a,f.type=c,f.data=d,b("chatSendCustomEvent",f,e)},getMaxCapacity:function(a){var c={};b("getMaxCapacity",c,a)},getEngagedChats:function(a){var c={};b("getEngagedChats",c,function(b){a.call(this,{success:b.success,chatKey:1===b.chatKey.length&&0===b.chatKey[0].length?[]:b.chatKey})})},getChatRequests:function(a){var c={};b("getChatRequests",c,function(b){a.call(this,{success:b.success,chatKey:1===b.chatKey.length&&0===b.chatKey[0].length?[]:b.chatKey})})},getAgentState:function(a){var c={};b("getAgentState",c,a)},setAgentState:function(a,c){var d={};d.state=a,b("setAgentState",d,c)},onAgentStateChanged:function(a){var c={};c.event=!0,b("onAgentStateChanged",c,a)},onCurrentCapacityChanged:function(a){var c={};c.event=!0,b("onCurrentCapacityChanged",c,a)},onChatRequested:function(a){var c={};c.event=!0,b("onChatRequested",c,a)},onChatStarted:function(a){var c={};c.event=!0,b("onChatStarted",c,a)},onChatEnded:function(a){var c={};c.event=!0,b("onChatEnded",c,a)},onChatDeclined:function(a){var c={};c.event=!0,b("onChatDeclined",c,a)},onChatTransferredOut:function(a){var c={};c.event=!0,b("onChatTransferredOut",c,a)},onChatCanceled:function(a){var c={};c.event=!0,b("onChatCanceled",c,a)},onChatCriticalWaitState:function(a,c){var d={};d.event=!0,d.chatId=a,b("onChatCriticalWaitState",d,c)},acceptChat:function(a,c){var d={};d.chatKey=a,d.eventId=a,b("acceptChat",d,c)},endChat:function(a,c){var d={};d.chatKey=a,b("endChat",d,c)},declineChat:function(a,c){var d={};d.chatKey=a,b("declineChat",d,c)},initFileTransfer:function(a,c,d){var e={};e.chatKey=a,e.entityId=c,b("initFileTransfer",e,d)},cancelFileTransferByAgent:function(a,c){var d={};d.chatKey=a,b("cancelFileTransfer",d,c)},onFileTransferCompleted:function(a,c){var d={};d.chatKey=a,b("onFileTransferCompleted",d,c)}}}(sforce.console.helper),sforce.console.presence=function(a){function b(a){return"string"==typeof a&&a.length>0}var c=function(b,c,d){return c.version=a.getVersion(),a.execute(b,c,d)};return{login:function(a,d){var e={};b(a)&&(e.statusId=a),c("loginPresence",e,d)},getServicePresenceStatusId:function(a){var b={};c("getPresenceStatusId",b,a)},setServicePresenceStatus:function(a,d){var e={};b(a)&&(e.statusId=a),c("setPresenceStatus",e,d)},logout:function(a){var b={};c("logoutPresence",b,a)},getAgentWorks:function(a){var b={};c("getPresenceWorks",b,a)},acceptAgentWork:function(a,d){var e={};b(a)&&(e.workId=a),c("acceptPresenceWork",e,d)},declineAgentWork:function(a,d){var e={};b(a)&&(e.workId=a),c("declinePresenceWork",e,d)},closeAgentWork:function(a,d){var e={};b(a)&&(e.workId=a),c("closePresenceWork",e,d)}}}(sforce.console.helper)),window.skuid||(window.skuid={}),function(a,b){a.Mustache=window.Mustache,a.$=a.jQuery=b.noConflict()}(window.skuid,jQuery);var $j=jQuery.noConflict();if("object"!=typeof JSON)throw $j("#bodyTable").find(".nx-page").css("font-size","14pt").empty().text("Skuid cannot run in this Web Browser.  Please make sure you are using Internet Explorer 8 or higher and are not in Compatibility Mode."),"";!function(a){var b=a.$;if(!window.console){var c=window.console={};c.warn=c.info=c.error=c.trace=c.log=c.time=c.timeEnd=function(){}}b(function(){var c,d=b("#bodyTable"),e=a?a.page:null,f=b("<div>").prop("id","skuidEditBtnContainer"),g=b("<div>").prop("id","skuidEditBtn").text(a.label.read("edit_page")).appendTo(f);b("<div>").addClass("inline sk-icon sk-icon-configure").css("margin-right","4px").prependTo(g),a.responsive.handleResize(),f.on("mouseover",function(){f.not(":animated").animate({width:"90px"},400)}).on("mouseleave",function(){f.animate({width:"16px"},400)});var h=b('a.zen-trigger[title="Publisher Type Overflow Menu"]'),i=h.next();h.click(function(){i.toggle()}),i.click(function(){i.hide()});var j=window.location.href.toLowerCase(),k=-1!==j.indexOf("page=pagebuilder")||-1!==j.indexOf("/pagebuilder")||-1!==j.indexOf("/skuid__pagebuilder"),l=e?e.unsavedChangesWarning:null;if(e&&e.editable&&!e.runningOnForceSite&&!a.mobile){k||(f.appendTo("body"),f.show().click(function(){window.open("/apex/skuid__PageBuilder?id="+e.id,"_blank")})),c=d.find(".nx-page");var m,n,o,p=e.getAllProblems();e.problemsIndicator?m=e.problemsWrapper:(m=b("<div>").addClass("nx-page-problems-wrapper clearfix"),n=b("<div>").addClass("nx-page-problems-indicator nx-error").css({display:"inline-block","text-align":"left",padding:"7px"}).click(function(){o.toggle()}),o=b('<div class="nx-page-problems-container">').hide(),b.extend(e,{problemsIndicator:n,problemsWrapper:m,problemsContainer:o}),m.append(n,o),c.prepend(m)),p.length?b.each(p,function(){e.displayProblem(this)}):m.hide(),e.updateProblemsWrapper()}l&&b(window).on("beforeunload.skuid",function(){var c;return b.each(a.model.list(),function(){return this.hasChanged?(c=a.label.read("unsaved_changes_warning"),!1):void 0}),c}),b(".nx-field > :input:visible:not(.hasDatepicker)").first().focus();var q=window.Visualforce&&Visualforce.remoting&&Visualforce.remoting.Util?Visualforce.remoting.Util.error:null,r=!1;q&&(Visualforce.remoting.Util.error=function(a,b){var c=function(){r||window.confirm('You need to log in again, your session has expired.\n\nPress "OK" to go to the login page now.\n\nPress "Cancel" to remain on this page. Refresh your browser to go to the login page.')?window.location.reload():r=!0};b&&-1!==b.message.indexOf("Logged in?")?c():b&&-1!==b.message.indexOf("Page not allowed for the profile")?c():b&&-1!==b.message.indexOf("Remoting request invalid")?c():q&&q(a,b)})})}(skuid),function(a){var b=null!==navigator.userAgent.match(/iPad/i);a.fn.skootip=function(c,d){var e,f=this;return c&&f.attr("title",c),d=d||{position:{my:"center bottom",at:"center top-10",collision:"fit",using:function(b,c){a(this).css("top",b.top).css("left",b.left);var d=b.left+c.element.width/2,f=c.target.left+c.target.width/2;e=Math.floor(f-d-4)}},show:{delay:700},open:function(b,c){var d=a("<div>").addClass("sk-hastooltip").css("left",e+"px");c.tooltip.append(d)}},b?f:f.tooltip(d)}}(skuid.$),function(a){var b=a.$,c=a.events={},d={},e=function(a,c){d[a]&&b.each(d[a],function(a,d){d&&d.apply(b,c||[])})},f=function(a,b){return d[a]||(d[a]=[]),d[a].push(b),[a,b]},g=function(a){var c=a[0];d[c]&&b.each(d[c],function(b){this==a[1]&&d[c].splice(b,1)})};c._cache=d,c.publish=e,c.subscribe=f,c.unsubscribe=g}(skuid),function(a){function b(b,c){var d="DATE"===c,e="DATETIME"===c;if((d||e)&&(d&&!a.time.parseSFDate(b)||e&&!a.time.parseSFDateTime(b))){var f=new Date;return"TODAY"===b||"NOW"===b||("YESTERDAY"===b?f.setTime(f.getTime()-864e5):"TOMORROW"===b?f.setTime(f.getTime()+864e5):f=!1),f?e?a.time.getSFDateTime(f):a.time.getSFDate(f):null}return b}function c(b){var c,d,e=b[0],f={};return b.length<2?!1:(a.utils.isString(b[1])?(d={},d[b[1]]=b[2],c=b[3]):(d=b[1],c=b[2]),f[e.Id]=d,this.updates=f,void(this.options=c))}function d(a,b){a&&b&&a._GUID&&!(a._GUID in b)&&(b[a._GUID]=a)}function e(a,b){a&&b&&a._GUID&&a._GUID in b&&delete b[a._GUID]}function f(){return""+J++}function g(a,b){var c=new K(b);return c.register(a),c}function h(b){var c;return c=a.utils.isString(b)?x(b):b,c?(c.unregister(),c):void 0}function i(b,c){c||(c={});var d=!1,e=a.utils,f=G.Deferred(),g=[],h={},i={},j=[],k=c.rollbackOnAnyError;if(k===!0&&(h.rollbackOnAnyError=!0),G.each(b,function(){var b,c,f=this;return f.id in i||f.isBeingSaved?!0:(i[f.id]=f,f.isBeingSaved=!0,b={id:f.id},c={"[object Object]":1,"[object Array]":1},G.each(f.changes,function(b,d){"__deleted"in d&&a.model.isNewId(b)?f.removeRowById(b):G.each(d,function(a,b){(e.endsWith(a,"__r")||e.endsWith(a,"__pr")||e.toClass.call(b)in c)&&delete d[a]})}),G.each(this.registeredLists,function(){j=j.concat(this.validateRequiredFields())}),G.extend(b,{changes:f.changes}),b.updates=[],f.fields&&G.each(f.fields,function(){"childRelationship"!==this.type&&this.query!==!1&&b.updates.push({id:this.id,targetObjects:this.targetObjects})}),b.type=f.objectName,void(f.hasChanged&&a.utils.size(f.changes)&&(g.push(b),d=!0)))}),j.length&&(d=!1),d)h.operations=g,a.RemotingStubs.save(JSON.stringify(h),function(b,d){var e=[],g={};if(d.status){b.totalsuccess=!0;var h={},j={};G.each(i,function(a){h[a]=!0}),G.each(b.deleteResults,function(){var a=this,c=i[a.source];this.success?c.removeRowById(a.id):(b.totalsuccess=!1,h[a.source]=!1,G(this.errors).each(function(){e.push(this)}),c.undeleteRow(c.getRowById(a.id),{notify:!1})),G(this.messages).each(function(){e.push(this)})}),G.each(b.insertResults,function(){var a=this;if(this.success){var c,d,f,k,l=i[a.source],m=a.oldId,n=a.id,o=a.record,p=l.registeredFieldsByRowThenField,q=l.registeredItemsByRow;o&&(o=a.record=JSON.parse(o)),m in l.changes&&delete l.changes[m],m in l.originals&&delete l.originals[m],c=l.getRowById(m),g[m]=c,c.Id=n,c.Id15=n.substring(0,15),l.dataMap[n]=c,delete l.dataMap[m],d=m in p?p[m]:!1,f=m in q?q[m]:!1,d!==!1&&(p[n]=d,delete p[m]),f!==!1&&(q[n]=f,delete q[m]),o&&(k=j[l.id],k||(k=j[l.id]={}),k[c.Id]=o)}else b.totalsuccess=!1,h[a.source]=!1,G(this.errors).each(function(){e.push(this)});G(this.messages).each(function(){e.push(this)})}),G.each(b.updateResults,function(){var a,c,d,f=this,g=f.id,k=f.record;f.success?(a=i[f.source],g in a.changes&&delete a.changes[g],g in a.originals&&delete a.originals[g],c=a.getRowById(g),k&&(k=f.record=JSON.parse(k),d=j[a.id],d||(d=j[a.id]={}),d[c.Id]=k)):(b.totalsuccess=!1,h[f.source]=!1,G(this.errors).each(function(){e.push(this)})),G(this.messages).each(function(){e.push(this)})}),a.utils.size(j)&&G.each(j,function(a,b){i[a].updateRows(b,{preventSetActive:!1,preventTrackChanges:!0})}),G.each(a.model.list(),function(){var b=this,c=b.conditions,d={};b.hasChanged&&G.each(b.changes,function(a,c){G.each(c,function(c,e){if(e){var f,h,i=g[e];i&&(f=b.getField(c),f&&"REFERENCE"===f.displaytype&&(h=d[a],h||(h=d[a]={}),h[c]=i.Id,h[f.rel]=i))}})}),c&&c.length&&G.each(c,function(a,b){if("modelmerge"===b.type){var c,d=x(b.model),e=b.mergeField,f=d&&e?d.getField(e):null;(f&&"REFERENCE"===f.displaytype||"Id"===e)&&(O(b.operator)?(c=b.values,c&&c.length&&G.each(c,function(a,b){var d=g[b];d&&(c[a]=d.Id)})):b.value&&b.value in g&&(b.value=g[b.value].Id))}}),a.utils.size(d)&&b.updateRows(d)}),G.each(i,function(a,b){b.isBeingSaved=!1});var k={};G.each(i,function(a,b){b.hasChanged=!h[a],G.each(b.registeredLists,function(){this.render({doNotCache:!0})}),G.each(b.registeredEditors,function(a,c){c._GUID in k||(k[c._GUID]=c),c.hadErrors!==!0&&(c.hadErrors=b.hasChanged)})});var l={models:i,initiatorId:c.initiatorId,insertResults:b.insertResults,updateResults:b.updateResults,deleteResults:b.deleteResults,totalsuccess:b.totalsuccess};e&&e.length&&(l.messages=G.map(e,function(a){return a.message})),a.utils.size(k)&&(G.each(k,function(){this.handleSave(!this.hadErrors,l),this.hadErrors=!1}),G.each(k,function(){c.initiatorId&&this._GUID!==c.initiatorId||this.handleMessages(e,{initiatorId:c.initiatorId})})),a.events.publish("models.saved",[l]),f.resolve(l),c.callback&&c.callback(l)}else f.reject(b)},{escape:!1});else{var l=j.length>0,m={models:i,initiatorId:c.initiatorId};m.totalsuccess=!l,l&&(m.messages=G.map(j,function(a){return a.message}));var n={};G.each(i,function(a,b){b.isBeingSaved=!1,G.each(b.registeredEditors,function(a,b){b._GUID in n||(n[b._GUID]=b)})}),a.utils.size(n)&&(G.each(n,function(){this.handleSave(m.totalsuccess,m)}),l&&G.each(n,function(){c.initiatorId&&this._GUID!==c.initiatorId||this.handleMessages(j,m)})),a.events.publish("models.saved",[m]),c.callback&&c.callback(m),f.resolve(m)}return f.promise()}function j(b,c){if(b){b instanceof Array||(b=[b]),c||(c={});var d,e={},f={};G.each(b,function(b,g){G.each(g.changes,function(a){g.originals[a]||g.removeRowById(a)}),d=g.changes,g.changes={};var h={},i={};G.each(g.originals,function(b){var c=g.getRowById(b),d=i[b]={};a.model.isNewId(b)?(G.each(c,function(a){return"Id"===a||"Id15"===a?!0:void(d[a]="")}),h[b]={Id:b}):G.each(this,function(a,b){"__notdeleted"===a&&g.undeleteRow(c,{notify:!1}),d[a]=b})}),a.utils.size(i)&&g.updateRows(i,{preventSetActive:!1,preventTrackChanges:!0});var j=jQuery.extend(!0,{},g.originals);g.originals=h,g.hasChanged=!1,g.notifyFieldsOfChange(j,c),g.registeredLists&&G.each(g.registeredLists,function(){this._GUID in e||(e[this._GUID]=this)}),g.registeredEditors&&G.each(g.registeredEditors,function(){this._GUID in f||(f[this._GUID]=this)})}),G.each(e,function(a,b){b.render({resetItemModes:!0,resetPagination:!0,changedRows:d,destroyDeletedRows:!0})});var g={},h={models:g,initiatorId:c.initiatorId};return G.each(b,function(a,b){g[b.id]=b}),G.each(f,function(a,b){b.handleCancel&&b.handleCancel(h)}),a.events.publish("models.cancelled",[h]),b}}function k(a,b){return o(a,b,{loadAllMetadata:!0})}function l(a,b){return o(a,b)}function m(a,b){return o(a,b,{syncOnly:!0})}function n(a,b){return o(a,b,{addOnly:!0})}function o(b,c,d){d=d||{};var e=G.Deferred(),f=[],g=[],h={},i=["registeredConditions","registeredEditors","registeredFields","registeredFieldsByRowThenField","registeredItems","registeredItemsByRow","registeredLists","originals","data","dataMap","changes","fieldsMap","debug","soql","recordTypeInfos","actions"];return G.each(b,function(){var a=this;if(a.hasChanged)throw"Model '"+a.id+"' has unsaved changes. To update this model's data, you must first save or cancel the changes.";if(d.syncOnly){var b=a.getConditionByName("_sync",!1);if(!a.fieldsMap.IsDeleted){var c={id:"IsDeleted"};a.fields.push(c),a.fieldsMap.IsDeleted=c}b||(b={name:"_sync",type:"fieldvalue",field:"LastModifiedDate",inactive:!1,operator:"gte",encloseValueInQuotes:!1},a.addCondition(b)),a.setCondition(b,a.lastSyncTime),a.queryAllRows=!0}d.addOnly||(delete a.offsetPageNumber,delete a.offsetPageSize),a.isProcessing++,h[a.id]=++a.calloutIterator;var e=G.extend({},a);G.each(i,function(){this in e&&delete e[this]}),f.push(e),g.push(a)}),a.RemotingStubs.load(JSON.stringify(f),function(b,f){if(f.status){var i=JSON.parse(b);G.each(i,function(b,c){var e=g[b];if(e.isProcessing--,"function"==typeof e.lastSuccessfulCallout&&(e.lastSuccessfulCallout=e.lastSuccessfulCallout()),!(h[e.id]>e.lastSuccessfulCallout))return!0;if(e.lastSuccessfulCallout=h[e.id],d.loadAllMetadata)G.extend(e,c),e.initialize();else{if(d.syncOnly){var f=e.getConditionByName("_sync",!1);e.deactivateCondition(f),e.queryAllRows=!1;var i=[];G.each(c.data,function(){this.IsDeleted?e.removeRowById(this.Id):i.push(this)}),e.adoptRows(i,{notify:!1})}else d.addOnly?e.adoptRows(c.data,{doAppend:!0,notify:!1}):e.data=c.data||[];e.isAggregate?A(e):s(e),G.each(e.conditions,function(a,b){var d=c.conditions[a];d&&(b.values=d.values),G.extend(b,d)}),a.utils.createMapForArray([e],"data","dataMap","Id"),e.canRetrieveMoreRows=c.canRetrieveMoreRows,e.recordsLimit=c.recordsLimit,e.lastSyncTime=c.lastSyncTime,e.debug=c.debug,e.soql=c.soql}});var j={};G.each(i,function(a){var b=g[a];b.registeredItems&&G.each(b.registeredItems,function(){this.fields&&G.each(this.fields,function(){this.destroy()})}),b.registeredFields&&G.each(b.registeredFields,function(){this.render&&this.render(),b.unregisterField(this)}),b.registeredLists&&G.each(b.registeredLists,function(){this.render({doNotCache:!0})}),b.registeredEditors&&G.each(b.registeredEditors,function(a,b){b._GUID in j||(j[b._GUID]=b)})}),G.each(j,function(a,b){b.handleDataRefresh&&b.handleDataRefresh({updatedModels:g})});var k={},l={models:k,initiatorId:d.initiatorId};G.each(g,function(a,b){k[b.id]=b}),a.events.publish("models.loaded",[l]),c&&c(),e.resolve()}},{escape:!1}),e.promise()}function p(b,c){c||(c={});var d={};G.each(b,function(a,b){b.registeredItems&&G.each(b.registeredItems,function(){this.fields&&G.each(this.fields,function(){this.destroy()})}),b.registeredFields&&G.each(b.registeredFields,function(){this.render&&this.render(),b.unregisterField(this)}),b.registeredLists&&G.each(b.registeredLists,function(){this.render({doNotCache:!0})}),b.registeredEditors&&G.each(b.registeredEditors,function(a,b){b._GUID in d||(d[b._GUID]=b)})}),G.each(d,function(a,c){c.handleDataRefresh&&c.handleDataRefresh({updatedModels:b})});var e={},f={models:e,initiatorId:c.initiatorId};G.each(b,function(a,b){e[b.id]=b}),a.events.publish("models.loaded",[f])}function q(a){var b=a;if(b.doClone&&b.realToFakeIdMap){var c={};b.conditions&&G.each(b.conditions,function(a,d){var e=d.field,f=d.value,g=b.getField(e);if(g&&g.createable&&(-1!==e.indexOf(".")||!f&&f!==!1&&0!==f||G.each(b.data,function(a,b){e in b||(b[e]=f)}),"REFERENCE"===g.displaytype&&"modelmerge"===d.type&&d.model)){var h=x(d.model);h&&h.realToFakeIdMap&&(c[e]=h)}}),b.data&&G.each(b.data,function(a,c){c.Id&&c.Id in b.realToFakeIdMap&&(c.Id=b.realToFakeIdMap[c.Id])}),b.fields&&G.each(b.fields,function(a,d){if("REFERENCE"===d.displaytype){var e=[];c[d.id]?e.push(c[d.id].realToFakeIdMap):G.each(d.referenceTo,function(a,b){var c=I[b.keyPrefix];c&&c.length&&G.each(c,function(a,b){b.realToFakeIdMap&&e.push(b.realToFakeIdMap)})}),e.length&&G.each(b.data,function(a,b){G.each(e,function(a,c){return b[d.id]in c?(b[d.id]=c[b[d.id]],!1):void 0})})}}),G(function(){var a={};b.data&&b.data.length&&b.fields&&b.fields.length&&G.each(b.data,function(c,d){var e={};G.each(b.fields,function(a,c){e[c.id]=b.getFieldValue(d,c.id,!0)}),a[d.Id]=e}),b.updateRows(a,{_alwaysAddChanges:!0,notifyFields:!1})})}}function r(a){var b=a.data&&a.data.length<1;if(b&&a.createRowIfNoneFound===!0){var c=a.createRow();G(function(){a.updateRow(c,"Id",c.Id),a.originals[c.Id]={}})}}function s(a){G.each(a.data,function(a,b){b.Id15=b.Id?b.Id.substring(0,15):null})}function t(a){var b=a.type,c=a.mergeField;if("modelmerge"===b&&a.model&&c&&!a.inactive){var d=x(a.model);if(d&&d.data&&d.data.length)if(O(a.operator)){var e=[];G.each(d.data,function(){e.push(d.getFieldValue(this,c,!0))}),a.values=e}else{var f=a.row;(!f||0>f||f>=d.data.length)&&(a.row=0);var g=d.getFieldValue(d.data[a.row],c,!0);null!==g&&a.value!==g&&(a.value=g)}}}function u(a){a.conditions||(a.conditions=[]),G.each(a.conditions,function(a,b){t(b)})}function v(){var a=[];return G.each(H,function(b,c){a.push(c)}),a}function w(){return H}function x(a){var b=H[a];return b}function y(a){return I[a]}function z(){G.each(H,function(a,b){C(b),b.trigger("load")}),G.each(H,function(a,b){delete b.realToFakeIdMap})}function A(a){a.isAggregate&&a.data&&G.each(a.data,function(a,b){b.Id=f()})}function B(b){var c=b?b.actions:null,d=b?b.id:null,e=a.utils.startsWith;c&&c.length&&G.each(c,function(c,f){var g=f.events,h=f.actions=a.utils.makeXMLDoc(f.actions),i=f.fields;g.length&&G.each(g,function(c,f){a.events.subscribe(f,function(c){var g=!1;if(e(f,"models.")&&c.models[d]&&("models.saved"!==f||c.totalsuccess))g=!0;else if(e(f,"row.")&&c.modelId===d)if("row.updated"===f&&i&&i.length){for(var j=Object.keys(c.updates),k=0;k<j.length;k++)if(G.inArray(j[k],i)>-1){g=!0;break}}else g=!0;if(g){var l=G.extend({model:x(d),initiatorId:d},c);a.actions.runActionsNode(h,b,l)}})})})}function C(b){var c="aggregate"===b.type;b.isAggregate=c,a.utils.createMapForArray([b],"fields","fieldsMap",["id","name"]);var d=[];return b.fields&&G.each(b.fields,function(a,b){"childRelationship"===b.type&&b.subFields&&d.push(b)}),d.length&&a.utils.createMapForArray(d,"subFields","subFieldsMap","id"),c?A(b):(q(b),s(b)),a.utils.createMapForArray([b],"data","dataMap","Id"),u(b),r(b),B(b),b}function D(b){return!(a.utils.isString(b)&&(15===b.length||18===b.length))}function E(a){if(a){var b=S(a);return!(!b||!b.length||-1===b.indexOf("clone_"))}return!1}var F=a.model={},G=a.$,H={},I={},J=1,K=function(a){var b=this;G.extend(b,a),b.conditions||(b.conditions=[]),b.fields||(b.fields=[]),b.data||(b.data=[]),b.changes={},b.originals={},b.registeredFields={},b.registeredFieldsByRowThenField={},b.registeredItems={},b.registeredItemsByRow={},b.registeredLists={},b.registeredEditors={},b.hasChanged=!1,b.isProcessing=0,b.calloutIterator=0,b.lastSuccessfulCallout=0,b.events={}},L=function(b){var c,d,e,f,g,h=this;if(b&&b.attr){if(d="false"!==b.attr("enclosevalueinquotes"),e=h.sourceType=b.attr("sourcetype")||"fieldvalue",f=b.attr("fieldmodel"),"fieldvalue"===e){if(h.field=b.attr("field"),g=b.attr("nosourcerowbehavior"),g&&(h.noSourceRowBehavior=g),f){h.fieldModel=f;var i,j=F.getModel(f);j&&j.data&&j.data.length&&(i=j.data[0],h.fieldRow=i.Id)}}else"param"===e?h.sourceParam=b.attr("sourceparam"):"userinfo"===e?h.sourceUserInfoType=b.attr("sourceuserinfotype"):a.utils.endsWith(e,"property")&&(h.sourceProperty=b.attr("sourceproperty"),f&&(h.fieldModel=f));
if(h.operator=b.attr("operator")||"=",h.type=b.attr("type")||"fieldvalue",h.value=b.attr("value"),h.state=b.attr("state"),h.inactive="true"===b.attr("inactive")||!1,h.mergeField=b.attr("mergefield"),h.encloseValueInQuotes=d,c=a.utils.adjustValueBasedOnQuotedness,h.value=c(h.value,d),"userinfo"===h.type)h.userInfoType=b.attr("userinfotype");else if("multiple"===h.type){var k=h.values=[];b.children("values").first().children().each(function(){var b=a.utils.getXML(this);b.length>8?(b=a.utils.decodeXML(b.substring(7,b.length-8)),k.push(c(b,d))):k.push("")})}}else h.operator="=",h.inactive=!1,h.type="fieldvalue"};K.prototype.isSingleRow=function(){var a=this,b=!1;return a.conditions&&a.conditions.length&&G.each(a.conditions,function(a,c){return c.field&&"id"===c.field.toLowerCase()&&c.type&&"param"===c.type?(b=!0,!1):void 0}),b},K.prototype.getFieldValues=function(a,b,c){var d=[],e=this;return G.each(b,function(){d.push(e.getFieldValue(a,this,c))}),d},K.prototype.getFieldValue=function(b,c,d){var e=a.utils.getObjectProperty(b,c);return d?e:a.utils.encodeHTML(e)},K.prototype.getField=function(a,b){var c=this.fieldsMap,d=c;if(d&&(d=a in c?c[a]:!1,!d&&b&&b in c)){var e=c[b];"childRelationship"===e.type&&e.subFieldsMap&&a in e.subFieldsMap&&(d=e.subFieldsMap[a])}return d},K.prototype.getFirstRow=function(){return this.data[0]},K.prototype.getRowById=function(a){return a in this.dataMap?this.dataMap[a]:!1},K.prototype.getNameFieldValueForRow=function(b,c){var d,e=this,f=e.objectName,g=a.utils;return d=-1!==G.inArray(f,["Lead","User","Contact"])?g.mergeAsText("row","{{#Name}}{{{Name}}}{{/Name}}{{^Name}}{{{FirstName}}} {{{LastName}}}{{/Name}}",{createFields:!1},e,b):e.getFieldValue(b,g.getNameField(f),!0),c!==!0&&(d=g.encodeHTML(d)),d},K.prototype.load=function(a){return k([this],a)},K.prototype.updateData=function(a){return l([this],a)},K.prototype.sync=function(a){return m([this],a)},K.prototype.getMoreData=function(a){return n([this],a)},K.prototype.loadNextOffsetPage=function(a){var b=this;if(b.canRetrieveMoreRows&&!b.isProcessing){if(b.offsetPageNumber&&b.offsetPageSize)b.offsetPageNumber++;else if(b.offsetPageSize=b.recordsLimit>2e3?2e3:b.recordsLimit||100,b.data.length>0){var c=b.offsetPageSize>0?Math.ceil(b.data.length/b.offsetPageSize):1;b.offsetPageNumber=c>1?c:2}else b.offsetPageNumber=1;b.getMoreData(function(){a&&a()})}},K.prototype.loadAllRemainingRecords=function(a){a=a||{};var b=this,c=b.recordsLimit,d=function(){if(b.canRetrieveMoreRows){var e=b.data.length;a.stepCallback&&a.stepCallback(e+1,e+c),b.loadNextOffsetPage(d)}else a.finishCallback&&a.finishCallback(b.data.length)};d()},K.prototype.getRows=function(b){return a.utils.filterRowsByConditions(this.data,b)},K.prototype.adoptRow=function(a,b){var c=this.adoptRows([a],b);return c&&c.length?c[0]:null},K.prototype.adoptRows=function(b,c){c||(c={});var d=this,e=[];return G.each(b,function(b,f){f.Id||(f.Id=a.utils.generateGUID());var g=d.getRowById(f.Id);g?G.extend(g,f):(c.doAppend?d.data.push(f):d.data.unshift(f),d.dataMap[f.Id]=f,g=f),e.push(g)}),c.notify!==!1&&d.notifyEditorsOfDataRefresh(),e},K.prototype.abandonRow=function(b){var c=this;if(b){var d=b.Id,e=G.inArray(b,c.data);return-1!=e&&c.data.splice(e,1),d in c.dataMap&&delete c.dataMap[d],d in c.changes&&delete c.changes[d],d in c.originals&&delete c.originals[d],d in c.registeredItemsByRow&&G.each(c.registeredItemsByRow[d],function(){c.unregisterItem(this)}),d in c.registeredFieldsByRowThenField&&G.each(c.registeredFieldsByRowThenField[d],function(a,b){b.length&&G.each(b,function(){c.unregisterField(this)})}),c.registeredLists&&G.each(c.registeredLists,function(){this.handleRowDeletion&&this.handleRowDeletion(d)}),0===a.utils.size(c.changes)&&(c.hasChanged=!1),b}},K.prototype.abandonAllRows=K.prototype.emptyData=function(){var a=this;a.data=[],a.dataMap={},a.changes={},a.originals={},a.registeredItems&&G.each(a.registeredItems,function(){this.fields&&G.each(this.fields,function(){this.destroy()})}),a.registeredFields&&G.each(a.registeredFields,function(){this.destroy()}),a.registeredLists&&G.each(a.registeredLists,function(){this.render({doNotCache:!0})}),G.each(a.registeredEditors,function(b,c){c.handleDataRefresh&&c.handleDataRefresh({updatedModels:[a]})})},K.prototype.createRow=function(c){c||(c={});var d=a.utils,e=this,g=e.hasChanged,h={Id:f()},i={};if(c.editModeForNewItems&&(i.editModeForNewItems=!0),h.Id15=h.Id,e.hasChanged=!0,c.doAppend?e.data.push(h):e.data.unshift(h),e.dataMap[h.Id]=h,"ignoreDefaults"in c==!1||c.ignoreDefaults!==!0){var j,k,l=function(c){if(!c.inactive&&c.field&&"id"!==c.field.toLowerCase()&&"null"!=c.value){var d,f=e.getField(c.field),g=f?f.displaytype:null,i=c.operator||"=";if(f&&f.createable&&("="===i||"starts with"===i))if(t(c),d=c.value,"="===i&&"REFERENCE"===g){var j=f.rel,k=a.utils.getNameField(f.ref),l=c.nameFieldValue||!1;if(l||"RecordType"!==f.ref||G.each(e.recordTypeInfos,function(){return this.recordTypeId===d?(l=this.name,!1):void 0}),!l){if(c.model){var n=a.$M(c.model);n&&n.data.length&&G.each(n.data,function(a,b){return d===b.Id||d===b.Id15?(l=b,!1):void 0})}if(!l){var o=a.utils.getFieldReference(c.field,f);G.each(m,function(a,b){b===c||b.field!==o||b.inactive||!b.value||c.operator&&"="!==c.operator||(l=b.value)})}if(!l&&(G.each(e.data,function(){return this[c.field]&&(this[c.field]===d||this[c.field].substr(0,15)===d)&&this[j]?(l=e.getFieldValue(this,j+"."+k,!0),!1):void 0}),!l)){var p=f.referenceTo,q=[];p&&p.length&&G.each(p,function(){q.push(this.keyPrefix)}),q.length>1&&d&&d.length>=15&&(q=[d.substring(0,3)]),G.each(q,function(b,c){var e=a.model.getModelsByKeyPrefix(c);e&&e.length&&G.each(e,function(){var b=this,c=a.utils.getNameField(b.objectName),e=!1;return G.each(b.data,function(){return(this.Id&&this.Id===d||this.Id15&&this.Id15===d)&&this[c]?(l=this,e=!0,!1):void 0}),e?!1:void 0})})}}var r={};if(l){var s;"object"==typeof l?s=l:(s={},s[k]=l),r[j]=s}r[c.field]=d,e.updateRow(h,r)}else{if(d=b(d,g),a.utils.startsWith(g,"DATE")&&!d)return!0;e.updateRow(h,c.field,d)}}},m=[],n=c.additionalConditions,o=e.recordTypeInfos&&e.recordTypeInfos.length>1,p=[];if(e.conditions&&e.conditions.length&&G.each(e.conditions,function(a,b){m.push(b)}),n&&n.length&&G.each(n,function(a,b){m.push(b)}),o&&G.each(e.recordTypeInfos,function(){return this.isDefaultRecordTypeMapping?(j=this.recordTypeId,!1):void 0}),e.createable&&m&&G.each(m,function(a,b){!b.inactive&&b.field&&"RecordTypeId"===b.field&&b.value&&"null"!=b.value&&b.value.length>=15&&(j=b.value,p.unshift(a))}),j){var q=j.substring(0,15),r={};G.each(e.recordTypeInfos,function(){return this.recordTypeId.substring(0,15)===q?(k=this,j=this.recordTypeId,!1):void 0}),r.RecordTypeId=j,k&&(r.RecordType={Name:k.name}),e.updateRow(h,r,{preventSetActive:!0})}p.length&&G.each(p,function(){m.splice(this,1)}),e.fields&&G.each(e.fields,function(a,b){var c,f,g=!1,i=b.displaytype;b.createable&&(o&&d.endsWith(i,"PICKLIST")&&(f=d.getPicklistEntriesValidForRecordTypes(e.objectName,b.id,[j]),f&&f.length&&G.each(f,function(a,b){return"true"===b.defaultValue?(c=b.value,g=!0,!1):void 0})),g||(c=b.defaultValue),c&&0!==c&&"null"!=c&&("BOOLEAN"===i&&(c=c===!0||"true"===c),e.updateRow(h,b.id,c,{preventSetActive:!0})))}),m&&G.each(m,function(a,b){l(b)})}h.Id in e.changes||(e.changes[h.Id]={}),e.registeredLists&&G.each(e.registeredLists,function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleNewRow(h,i)}),e.notifyEditorsOfChange({hadPriorChanges:g,changes:e.changes[h.Id]});var s={modelId:e.id,rowId:h.Id,row:h,initiatorId:c?c.initiatorId:null};return G.extend(s,i),a.events.publish("row.created",[s]),h},K.prototype.updateRow=function(){var a=new c(arguments),b=this.updateRows(a.updates,a.options);return b&&b.length?b[0]:b};var M="__hadPriorChanges";K.prototype.updateRows=function(c,d){var e,f,g=this,h=g.hasChanged,i=[];return c?(d||(d={}),d.preventTrackChanges||(d.preventTrackChanges=!1),f=d.notifyFields,"undefined"==typeof f&&(f=!0),G.each(c,function(c,f){var h,j,k=g.getRowById(c),l=D(c);return k?void G.each(f,function(c,f){var m,n,o=g.fieldsMap[c],p=!(o&&o.id&&(d._ignoreMetadata?0:l?!o.createable:!o.editable)||d.preventTrackChanges),q=o&&"REFERENCE"===o.displaytype&&!f;return q&&(m=a.utils.getReferenceFieldRelationshipName(c)),n=o&&o.displaytype?b(f,o.displaytype):f,k[c]!==n||d._alwaysAddChanges?(p&&(c&&-1===c.indexOf(".")&&(h||(e||(e={}),e[k.Id]={},h=g.changes[k.Id],e[k.Id][M]=!!h,h||(h=g.changes[k.Id]={})),h[c]=n,e[k.Id][c]=n,q&&delete h[m]),g.hasChanged||d.preventSetActive||(g.hasChanged=!0),a.model.isNewId(k.Id)||(j||(j=g.originals[k.Id],j||(j=g.originals[k.Id]={})),c in j||(j[c]=k[c],q&&(j[m]=k[m])))),k[c]=n,q&&delete k[m],void i.push(k)):!0}):!0}),e&&(g.notifyEditorsOfChange({hadPriorChanges:h,changes:e}),f&&g.notifyFieldsOfChange(e,{initiatorId:d.initiatorId,hadPriorChanges:h})),i):!1},K.prototype.notifyFieldsOfChange=function(b,c){var d=this,e=d.registeredFieldsByRowThenField;c=c||{},G.each(b,function(b,f){var g=f[M];delete f[M],G.each(f,function(a,d){b in e&&a in e[b]&&G.each(e[b][a],function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleChange&&this.handleChange(d,a)})}),a.events.publish("row.updated",[{modelId:d.id,rowId:b,row:d.getRowById(b),updates:f,rowHadPriorChanges:g,modelHadPriorChanges:c.hadPriorChanges,initiatorId:c?c.initiatorId:null}])})},K.prototype.deleteRows=function(b,c){c||(c={});var d=this,e={},f=d.hasChanged,g=c.notify!==!1;b&&b.length&&(d.hasChanged=!0,G.each(b,function(b,f){var h,i=f.Id,j=d.changes[i];j||(d.changes[i]={},j=d.changes[i]),j.__deleted=!0,f.__deleted=!0,a.model.isNewId(i)||(h=d.originals[i],h||(d.originals[i]={},h=d.originals[i]),h.__notdeleted=!0),i in d.registeredItemsByRow&&G.each(d.registeredItemsByRow[i],function(){c&&c.initiatorId&&this._GUID===c.initiatorId||this.handleMarkRowForDeletion&&this.handleMarkRowForDeletion(f)}),g&&(e[i]={__deleted:!0,__notdeleted:!1})}),g&&(d.notifyEditorsOfChange({hadPriorChanges:f,changes:e}),G.each(e,function(b){a.events.publish("row.deleted",[{modelId:d.id,rowId:b,row:d.getRowById(b),initiatorId:c?c.initiatorId:null,modelHadPriorChanges:f}])})))},K.prototype.deleteRow=function(a,b){this.deleteRows([a],b)},K.prototype.undeleteRows=function(b,c){c||(c={});var d=this,e={},f=d.hasChanged,g=c.notify!==!1;b&&b.length&&(d.hasChanged=!0,G.each(b,function(a,b){var f=b.Id,h=d.changes[f];h&&"__deleted"in h&&delete h.__deleted,"__deleted"in b&&delete b.__deleted,f in d.registeredItemsByRow&&G.each(d.registeredItemsByRow[f],function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleUnmarkRowForDeletion&&this.handleUnmarkRowForDeletion(b)}),g&&(e[f]={__deleted:!1,__notdeleted:!0})}),g&&(d.notifyEditorsOfChange({hadPriorChanges:f,changes:e}),G.each(e,function(b){a.events.publish("row.undeleted",[{modelId:d.id,rowId:b,row:d.getRowById(b),initiatorId:c?c.initiatorId:null,modelHadPriorChanges:f}])})))},K.prototype.undeleteRow=function(a,b){return this.undeleteRows([a],b)},K.prototype.removeRowById=function(a){return a||"0"===a?this.abandonRow(this.getRowById(a)):void 0},K.prototype.save=function(a){return i([this],a)},K.prototype.cancel=function(a){return j([this],a),this},K.prototype.notifyEditorsOfChange=function(a){this.registeredEditors&&G.each(this.registeredEditors,function(){this.handleChange&&this.handleChange(a)})};var N=function(b,c,d){var e=a.utils.isString(b)?b:b.id,f=!a.utils.isString(c),g=f?c.name:c;return d||(d=a.page.id),"apex__"+(f&&c.customCookie?c.customCookie:"nx-page-"+d+"-model-condition-"+e+"-"+g)},O=function(b){return a.utils.isMultiValueOperator(b)};K.prototype.getConditionCookieName=function(a){return N(this,a)},K.prototype.setCondition=function(b,c,d){var e=!1;b.inactive=!1,O(b.operator)&&"undefined"!=typeof c&&(c instanceof Array?(e=!0,b.values=c):b.values=a.utils.isString(c)&&-1!=c.indexOf(";")?c.split(";"):[c]),e||(b.value=c),d&&b.name&&G.cookie(this.getConditionCookieName(b),""+(e?JSON.stringify(c):c))},K.prototype.deactivateCondition=function(a,b){a.inactive=!0,a.value=a.originalValue,O(a.operator)&&(a.originalValue?a.values=-1!=a.originalValue.indexOf(";")?a.originalValue.split(";"):[a.originalValue]:a.values&&a.values.length||(a.values=[])),b&&a.name&&G.cookie(this.getConditionCookieName(a),"-off-")},K.prototype.activateCondition=function(a,b){a.inactive=!1,b&&a.name&&G.cookie(this.getConditionCookieName(a),"-on-")},K.prototype.resetCondition=function(a,b){a.inactive=a.originalInactive,a.value=a.originalValue,O(a.operator)&&(a.originalValue?a.values=-1!=a.originalValue.indexOf(";")?a.originalValue.split(";"):[a.originalValue]:a.values&&a.values.length||(a.values=[])),b&&a.name&&G.removeCookie(this.getConditionCookieName(a))},K.prototype.registerEditor=function(a){d(a,this.registeredEditors)},K.prototype.unregisterEditor=function(a){e(a,this.registeredEditors)},K.prototype.registerList=function(a){d(a,this.registeredLists)},K.prototype.unregisterList=function(a){e(a,this.registeredLists)},K.prototype.registerItem=function(a){d(a,this.registeredItems);var b=this.registeredItemsByRow;b&&a.row&&a.row.Id&&(a.row.Id in b||(b[a.row.Id]={}),b[a.row.Id][a._GUID]=a)},K.prototype.unregisterItem=function(b){e(b,this.registeredItems);var c=this.registeredItemsByRow,d=b?b.row:0,f=d?d.Id:0,g=c[b.row.Id];c&&g&&b._GUID in g&&(delete g[b._GUID],a.utils.size(g)||delete c[f])},K.prototype.registerField=function(a,b){d(a,this.registeredFields);var c=this.registeredFieldsByRowThenField,e=b?b:a.id;if(c&&a.row&&e&&a.row.Id){a.row.Id in c||(c[a.row.Id]={});var f=c[a.row.Id];e in f||(f[e]={}),f[e][a._GUID]=a}},K.prototype.unregisterField=function(b,c){if("string"==typeof b&&(b=this.registeredFields[b]),b){e(b,this.registeredFields);var d,f,g=this.registeredFieldsByRowThenField,h=[],i=b._GUID,j=a.utils.size;g&&b.row&&b.row.Id&&(d=g[b.row.Id],d&&(c&&c.length&&G.each(c,function(){h.push(this)}),b.id&&h.push(b.id),G.each(h,function(a,b){f=d[b],f&&i in f&&(delete f[i],j(f)||delete d[b])}),j(d)||delete g[b.row.Id]))}},K.prototype.mergeRow=function(b,c,d){return a.utils.merge("row",c,d,this,b)},K.prototype.getRowMergeResult=function(b,c,d){return a.utils.getMergeResult("row",c,d,this,b)},K.prototype.mergeModel=function(b,c){return a.utils.merge("model",b,c,this)},K.prototype.getMergeResult=function(b,c){return a.utils.getMergeResult("model",b,c,this)};var P=function(a,b){this.list=a,this.map=b};P.prototype.indexOf=function(a){var b=-1;return G.each(this.list,function(c,d){return d.fieldName&&d.fieldName===a||d.fieldId===a?(b=c,!1):void 0}),b},P.prototype.size=function(){return this.list.length},K.prototype.getOrderObject=function(){var a=this,b=(a.orderByClause||"").split(","),c=[],d={};return G.each(b,function(){var b=G.trim(this);if(b){var e,f,g,h,i=b.split(" ",2),j=i[0],k={suffix:i.length>1?i[1]:"ASC NULLS LAST"};-1!==j.indexOf("(")?(h=j.split("("),g=h[0],e=h[1].split(")")[0],k.fieldId=e,g&&(k.fieldFunction=g),G.each(a.fields,function(){return this.name&&this.id===e&&this["function"]===g?(f=this.name,!1):void 0}),f&&(k.fieldName=f)):a.isAggregate?(e=j,G.each(a.fields,function(){return this.name&&this.id===e?(f=this.name,!1):void 0}),k.fieldId=e,f&&(k.fieldName=f)):(k.fieldId=j,f=j),c.push(k),d[f]=k}}),new P(c,d)};var Q=function(a,b){return b?b+"("+a+")":a};K.prototype.toggleOrdering=function(b,c){var d,e,f=this,g=f.getOrderObject(),h="",i=a.utils.isString(b),j=i?b:b.id,k=i?b:b.name?b.name:j,l=i?null:b["function"],m=f.getField(k);return"REFERENCE"===m.displaytype&&(j=a.utils.getFieldReference(j,m)),d=g.map[k],d?(e=G.inArray(d,g.list),-1!=e&&g.list.splice(e,1),k in g.map&&delete g.map[k],G.each(g.list,function(a,b){h+=Q(b.fieldId,b.fieldFunction)+" "+b.suffix+","}),-1!=d.suffix.indexOf("ASC")?(h=Q(j,l)+" DESC NULLS LAST,"+h,d.suffix="DESC NULLS LAST"):d=!1):(h=Q(j,l)+" ASC NULLS LAST,"+f.orderByClause,d={fieldId:j,fieldName:k,suffix:"ASC NULLS LAST"},l&&(d.fieldFunction=l)),h=h.replace(/,+$/,""),f.orderByClause=h,f.updateData(c),d},K.prototype.createSearchSubConditions=function(b,c,d,e){return a.utils.createSearchSubConditions(this,b,c,d,e)},K.prototype.buildSearchCondition=function(a,b,c,d){b=b?G.trim(b):!1,d||(d={});var e=this,f=d.affectCookies||!1,g=b&&b.length>(d.useSOSLSearch?2:0),h=e.getConditionByName(a,!1);return g?(h||(h=new L,h.name=a,d.useSOSLSearch?h.type="search":(h.type="group",h.value=b),e.addCondition(h)),e.activateCondition(h,f),d.useSOSLSearch?(h.fieldfunction=d.SOSLFields,h.value=d.tokenize?G.map(b.split(d.delemiter||" "),function(a){return'"'+a+'*"'}).join(" AND "):'"'+b+'*"'):e.createSearchSubConditions(h,b,c,d)):h&&(e.deactivateCondition(h,f),h.subConditions=[],h.subConditionLogic=""),h},K.prototype.prepareSearchConditions=function(a,b,c,d){this.buildSearchCondition(a._GUID+"_searchbox",b,a.searchFields,d)},K.prototype.cancelRowChanges=function(b,c,d){if(d||(d={}),!b)throw"Row is required.";var e=this,f=b.Id,g=e.originals[f],h=e.changes[f],i={},j="updateRow";return h&&(!c&&h?c=Object.keys(h):c&&a.utils.isString(c)&&(c=[c]),G.each(c,function(b,c){return"Id"===c||"Id15"===c?!0:void(g&&c in g?i[c]=g[c]:a.model.isNewId(f)&&(i[c]=""))}),a.utils.size(i)&&e[j](b,i,{initiatorId:d.initiatorId})),e},K.prototype.notifyEditorsOfDataRefresh=function(a){p([this],a)};var R=1;K.prototype.exportData=function(b){b||(b={});var c=this,d=c.isAggregate,e=new Date,f=b.fileName||c.id+"-export-"+e.getTime(),g=b.additionalConditions||!1,h=b.rows||c.data,i=(b.fields||c.fields).slice(0),j=h.length,k=i.length,l=b.useAPINamesForHeaders||!1,m=b.doNotAppendRowIdColumn||!1,n=!d&&!m,o="skuidExportForm"+ ++R,p="skuidExportData"+R,q="skuidExportFileName"+R,r='<form name="'+o+'Name" id="'+o+'" action="'+(a.page.runningOnForceSite?a.page.currentSiteUrl:"/")+'apex/ExportData" method="POST" ><input type="text" name="dummyText" value="dummy"><input type="hidden" name="inputdata" id="'+p+'" value=""><input type="hidden" name="pgName" id="'+q+'" value="'+f+'"><input type="submit" id="submit'+o+'" name="submitBtn'+o+'"></form>',s=G(r),t="";if(G("body").append(s),k>0&&j>0){var u={},v=[];G.each(i,function(a,b){b.name?u[b.name]=b:b.id&&(u[b.id]=b)}),n&&"Id"in u&&(n=!1),G.each(i,function(b,d){if(d.displaytype&&"REFERENCE"===d.displaytype){var e=d.name?d.name:d.id,f=a.utils.getFieldReference(e,d);if(!(f in u)&&f in c.fieldsMap){var g=c.getField(f);l||(g.label=d.label+": "+g.label),v.push({atIndex:b+1,id:f,field:g})}}}),v.length&&G.each(v,function(a,b){i.splice(b.atIndex,0,b.field),k++}),n&&(i.push("Id"in c.fieldsMap?c.fieldsMap.Id:{id:"Id",name:"Id",label:"Id"}),k++),G.each(i,function(b,c){var d=l?c.name?c.name:c.id:c.label;t+=a.utils.escapeCSVCell(d)+(k-1>b?",":"\r\n")}),G.each(h,function(b,d){var e=!0;g&&g.length&&(e=a.utils.doesRowMeetConditions(d,g)),e&&G.each(i,function(b,e){var f,g=e.name?e.name:e.id,h=e.template,i="childRelationship"===e.type;i&&h&&(h="{{#"+g+".records}}"+e.template+",{{/"+g+".records}}"),f=c.getFieldValue(d,g,!0),i||!f&&0!==f&&f!==!1?c.getField(g)&&!i||!h?f="":(f=c.mergeRow(d,h).text(),i&&f&&(f=f.substring(0,f.length-1))):f=""+f,t+=""===f?f:a.utils.escapeCSVCell(f),t+=k-1>b?",":"\r\n"})})}s.children("#"+p).val(t),s.submit(),s.remove()},K.prototype.getSOQL=function(){return this.soql},K.prototype.hasCondition=function(a){return this.getConditionByName(a)!==!1},K.prototype.getConditionByName=function(a,b){var c,d,e,f,g=this;if(g.conditions.length)for(e=0;e<g.conditions.length;e++){if(c=g.conditions[e],c.name===a)return c;if(b&&c.subConditions&&c.subConditions.length)for(f=0;f<c.subConditions.length;f++)if(d=c.subConditions[f],d.name===a)return d}return!1},K.prototype.addCondition=function(a,b){var c,d,e=this;return b&&"or"==b.toLowerCase()||(b="AND"),e.conditions.push(a),c="("+e.conditions.length+")",e.conditionLogic&&""!==e.conditionLogic?(d="and"===b.toLowerCase()&&-1===e.conditionLogic.toLowerCase().indexOf("or"),e.conditionLogic=(d?"":"(")+e.conditionLogic+(d?"":")")+b+c):e.conditionLogic=c,a},K.prototype.initialize=function(){return C(this),this},K.prototype.register=function(a){var b=this,c=I[b.keyPrefix];return H[a?a:b.id]=b,c||(c=I[b.keyPrefix]=[]),-1===G.inArray(c,b)&&c.push(b),b},K.prototype.unregister=function(){var a,b=this,c=I[b.keyPrefix];return delete H[b.id],c&&(a=G.inArray(c,b),-1!==a&&(c.splice(a,1),c.length||delete I[b.keyPrefix])),b},K.prototype.on=function(a,b){var c=this.events;return a&&b?(a in c||(c[a]=[]),c[a].push(b),!0):!1},K.prototype.off=function(a){var b=this.events;a&&b&&a in b&&delete b[a]},K.prototype.trigger=function(a){var b=this.events;b&&a&&a in b&&b[a].length&&G.each(b[a],function(a,b){b&&"function"==typeof b&&b()})};var S=function(b){var c;return c=a.utils.isString(b)?b:b.Id};K.prototype.isRowMarkedForDeletion=function(a){var b,c;return a?(b=S(a),c=this.getRowById(b),c&&a.__deleted===!0):!1},K.prototype.isRowChanged=K.prototype.doesRowHaveUnsavedChanges=function(a){var b,c;return a?(b=S(a),c=this.getRowById(b),c&&b in this.changes):!1},K.prototype.isRowNew=K.prototype.isNewRow=function(a){var b,c;return a?(b=S(a),c=this.getRowById(b),c&&D(b)):!1},K.prototype.isRowUnsavedClone=function(a){return E(a)},F.onAllModelsLoaded=z,F.registerModel=g,F.unregisterModel=h,F.initializeModel=C,F.getModel=x,F.getModelsByKeyPrefix=y,F.getNewId=f,F.getConditionCookieName=N,F.Model=K,F.Condition=L,F.cancel=j,F.save=i,F.load=k,F.sync=m,F.updateData=l,F.getMoreData=n,F.isNewId=D,F.isClonedRow=E,F.map=F.getModelsByName=w,F.list=F.getModelsList=v,a.$M=x}(skuid),function(a){function b(b){var c={},i={data:c},j={},k=!1;if(d.each(b,function(b,f){var g,h=f.objectType,i=f.fields,k=f.records,l=c[b]={};d.each(k,function(b,c){var f,k={},m={},n=0,o={};d.each(i,function(a,b){m[b]=1,n++}),n&&(f=e[c],f&&d.each(m,function(b){var c=a.utils.getObjectProperty(f,b);"undefined"!=typeof c&&(o[b]=c,delete m[b],n--)}),n&&(d.each(a.model.list(),function(b,e){if(e.data&&e.data.length&&(e.objectName===h&&(f=e.getRowById(c),f&&d.each(m,function(a){a in f&&(o[a]=e.getFieldValue(f,a,!0),delete m[a],n--)})),n)){var g={},i=e.fields;i&&i.length&&d.each(i,function(a,b){var c=b.referenceTo;"REFERENCE"===b.displaytype&&c&&c.length&&d.each(c,function(a,c){return c.objectName===h?(g[b.id]=b.rel,!1):void 0})}),a.utils.size(g)&&d.each(g,function(b,f){return d.each(e.data,function(e,g){return a.utils.getObjectProperty(g,b)!==c||(d.each(m,function(b){var c=a.utils.getObjectProperty(g,f+"."+b);"undefined"!=typeof c&&(o[b]=c,delete m[b],n--)}),n)?void 0:!1}),n?void 0:!1})}}),n&&(g=j[h],g||(g=j[h]={objectType:h,fields:{},records:[]}),g.records.push(c),d.each(m,function(a){g.fields[a]=1})))),d.extend(k,o),l[c]={record:k,isDone:0===n}})}),a.utils.size(j)){k=!0;var l=[],m=d.Deferred(),n=g++;d.each(j,function(b,c){var e=new a.model.Model({objectName:b,id:a.utils.generateGUID(),fields:d.map(c.fields,function(a,b){return{id:b}}),conditions:[{field:"Id",operator:"IN",type:"multiple",values:c.records}],doQuery:!0,recordsLimit:c.records.length});e.calloutIterator=n,e.lastSuccessfulCallout=function(){return h},l.push(e)}),j={},d.when(a.model.load(l)).done(function(){d.each(l,function(a,b){var e=c[b.keyPrefix];d.each(b.data,function(a,c){"attributes"in c&&delete c.attributes;var g=c.Id,h=e[g];h||(h=e[g]={}),d.extend(h,b.getRowById(g)),h.isDone=!0,f(c)})}),i.isSuccess=!0}).fail(function(){i.isSuccess=!1}).always(function(){h=l[0].lastSuccessfulCallout,i.isComplete=!0,m.resolve(i)}),i.promise=m.promise()}return i.isComplete=i.isSuccess=!k,i}var c=a.data={},d=a.$,e={},f=function(a){var b=a.Id,c=e[b];c||(c=e[b]={}),d.extend(c,a)},g=0,h=0;c.get=b,c.add=f}(skuid),function(a){function b(a){r=a}function c(a){if(!a)return!1;var b=a.split&&a.split("T").length&&a.split("T")[0].split("-");return b&&3===b.length?new Date(b[0],b[1]-1,b[2]):!1}function d(a){var b=1,c=a.getMonth()-0+b+"",d=a.getDate()+"";return c.length===b&&(c="0"+c),d.length===b&&(d="0"+d),a.getFullYear()+"-"+c+"-"+d}function e(b){return b?1===b.split(" ").length?a.time.makeFormattedDateFromLocal(a.time.parseSFDate(b)):a.time.makeFormattedDateFromJS(a.time.parseSFDate(b)):""}function f(b){var c=a.time.getLocalDateTime(b);return a.time.makeFormattedDateFromLocal(c)}function g(b){return b?p.datepicker.formatDate(a.utils.userLocale.dateFormat,b):""}function h(a){if(!a)return!1;var b,c,d=a.split("T");return 2!==d.length?!1:(b=d[0].split("-"),c=d[1].split(".")[0].split(":"),3===b.length&&c.length>2?new Date(Date.UTC(b[0],b[1]-1,b[2],c[0],c[1],c[2])):!1)}function i(a){var b=1,c=parseInt(a.getUTCMonth()-0+b,10)+"",d=a.getUTCDate()+"",e=a.getUTCHours()+"",f=a.getUTCMinutes()+"",g=a.getUTCSeconds()+"";return c.length===b&&(c="0"+c),d.length===b&&(d="0"+d),e.length===b&&(e="0"+e),f.length===b&&(f="0"+f),g.length===b&&(g="0"+g),a.getUTCFullYear()+"-"+c+"-"+d+"T"+e+":"+f+":"+g+".000+0000"}function j(a){var b=new Date(a.getTime());return b.setMinutes(b.getMinutes()-(r-q)),b}function k(a){var b=new Date(a.getTime());return b.setMinutes(a.getMinutes()+(r-q)),b}function l(b){if(b){var c=a.time.parseSFDateTime(b),d=a.time.getLocalDateTime(c),e=a.utils.userLocale;if(d)return e.showTimeBeforeDate?n(e.timeFormat,d)+" "+g(d):g(d)+" "+n(e.timeFormat,d)}return""}function m(b,c){if(c&&b){var d,e,f=a.utils.isString;return f(c)&&!f(b)?(d=b,e=c):(d=c,e=b),p.datepicker.formatDate(e,d)}return""}function n(b,c){if(!c)return"";var d,e=a.time.amPm,f=function(a){var c=d+1<b.length&&b.charAt(d+1)===a;return c&&d++,c},g=function(a){return a.getHours()%12},h=function(a,b,c){var d=""+b;if(f(a))for(;d.length<c;)d="0"+d;return d},i="",j=!1;if(c)for(d=0;d<b.length;d++)if(j)"'"!==b.charAt(d)||f("'")?i+=b.charAt(d):j=!1;else switch(b.charAt(d)){case"a":i+=c.getHours()>11?e[1]:e[0];break;case"h":var k=g(c);0===k&&(k=12),i+=h("h",k,2);break;case"K":i+=h("h",g(c),2);break;case"k":i+=h("k",c.getHours()+1,2);break;case"H":i+=h("H",c.getHours(),2);break;case"m":i+=h("m",c.getMinutes(),2);break;case"s":i+=h("s",c.getSeconds(),2);break;case"'":f("'")?i+="'":j=!0;break;default:i+=b.charAt(d)}return i}var o=a.time={},p=a.$,q=(new Date).getTimezoneOffset(),r=(new Date).getTimezoneOffset();o.setUserTimeZoneOffset=b,o.formatTime=n,o.formatDate=m,o.parseSFDate=c,o.getSFDate=d,o.makeFormattedDate=e,o.makeFormattedDateFromJS=f,o.makeFormattedDateFromLocal=g,o.parseSFDateTime=h,o.getSFDateTime=i,o.getLocalDateTime=j,o.getRealJSDateTimeFromLocal=k,o.makeFormattedLongDateTime=l}(skuid),function(a){function b(a){i.extend(j,a)}function c(a,b){return j[a]||b||""}function d(b,c,d){var e=a.label.parse(b,c,d),f=e[0],g=e[1],h="";return i(g).each(function(b){h+=this;var c=f[b];c&&(h+=a.label.read(c.substring(c.indexOf(".")+1,c.length-1)))}),h}function e(b){var c=Array.prototype.slice.call(arguments,1),d=a.label.parse(b),e=d[0],f=d[1],g="";return i(f).each(function(a){g+=this;var b=e[a];b&&(g+=c[b.substring(1,b.length-1)])}),g}function f(a,b,c){b||(b="{"),c||(c="}");var d=b+"__"+c,e=d in k?k[d]:k[d]=new RegExp("\\"+b+"[^"+b+"\\"+c+"]+\\"+c,"g");return[a.match(e)||[],a.split(e)]}function g(){return j}var h=a.label={},i=a.$,j={},k={};window.SkuidLabels&&(b(window.SkuidLabels),delete window.SkuidLabels),h.add=b,h.read=c,h.labelize=d,h.merge=e,h.parse=f,h.getAll=g,h.map=j,a.$L=c}(skuid),function(a){var b=a.currency={},c={ALL:"Lek",ARS:"$",AWG:"f",AUD:"$",BSD:"$",BBD:"$",BYR:"p.",BZD:"BZ$",BMD:"$",BOB:"$b",BAM:"KM",BWP:"P",BRL:"R$",BND:"$",CAD:"$",KYD:"$",CLP:"$",CNY:"&yen;",COP:"$",CRC:"c",HRK:"kn",CZK:"Kc",DKK:"kr",DOP:"RD$",XCD:"$",EGP:"&pound;",SVC:"$",EEK:"kr",EUR:"&euro;",FKP:"&pound;",FJD:"$",GBP:"&pound;",GHC:"c",GIP:"&pound;",GTQ:"Q",GGP:"&pound;",GYD:"$",HNL:"L",HKD:"$",HUF:"Ft",ISK:"kr",IDR:"Rp",IMP:"&pound;",JMD:"J$",JPY:"&yen;",JEP:"&pound;",LVL:"Ls",LBP:"&pound;",LRD:"$",LTL:"Lt",MYR:"RM",MXN:"$",MZN:"MT",NAD:"$",ANG:"f",NZD:"$",NIO:"C$",NOK:"kr",PAB:"B/.",PYG:"Gs",PEN:"S/.",PLN:"zl",RON:"lei",SHP:"&pound;",SGD:"$",SBD:"$",SOS:"S",ZAR:"R",SEK:"kr",CHF:"CHF",SRD:"$",SYP:"&pound;",TWD:"NT$",TTD:"TT$",TRY:"TL",TRL:"&pound;",TVD:"$",USD:"$",UYU:"$U",VEF:"Bs",ZWD:"Z$"};b.getSymbol=function(a){var b=c[a];return b?b:"$"}}(skuid),function(a){function b(a,b){f[a]=b}function c(a){delete f[a]}function d(a){return f[a]}var e=a.snippet={},f={};e.registerSnippet=b,e.register=b,e.getSnippet=d,e.get=d,e.unregister=c}(skuid),function(a){var b,c,d=a.page={},e=a.$;d.params=function(a){if(""===a)return{};for(var b={},c=0;c<a.length;++c){var d=a[c].split("=");2==d.length&&(b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")))}return b}(window.location.search.substr(1).split("&")),d.getAllProblems=c=function(){var b=[],c=a.component.getByType("skuidpage");return c&&c.length&&e.each(c,function(){this.problems&&this.problems.length&&e.each(this.problems,function(){b.push(this)})}),b},d.rebuildPageProblems=function(b){var f=c(),g=d.problemsWrapper,h=b?b.justUpdateWrapper===!0:!1;g&&(h||d.problemsContainer.empty(),f.length?(h||e.each(f,function(){this.isDisplayed=!1,d.displayProblem(this)}),g.show(),d.problemsIndicator.text(a.label.merge(a.label.read("skuid_page_problems"),f.length))):g.hide())},d.updateProblemsWrapper=b=function(){d.rebuildPageProblems({justUpdateWrapper:!0})},d.displayProblem=function(a){if(d.problemsContainer&&!a.isDisplayed){var b=e("<div>").addClass("nx-problem").appendTo(d.problemsContainer);b.text(b.index()-0+1+". "+a.message),a.isDisplayed=!0}}}(skuid),function(a){function b(a,b){h[a]=b}function c(a){return h[a]}function d(){var a=[];return g.each(h,function(b,c){a.push(c)}),a}function e(){return h}var f=a.componentType={},g=a.$,h={};f.get=c,f.register=b,f.list=d,f.map=e}(skuid),function(a){function b(b,d){this.element=b,this._componentType=d,this._GUID=b.attr("id")||a.utils.generateGUID(),b.data("component",this),c(this)}function c(a){var b=a.type();!b||b in k||(k[b]=[]),k[b].push(a),j[a.id()]=a}function d(a){return k[a]}function e(a){return j[a]}function f(c,d,e){var f,g;if(1==arguments.length){var h=arguments[0];c=h.element,d=h.definition,e=h.type,f=h.context,d||(d=h.xmlDefinition)}if(c?c.jquery||(c=i(c)):c=i("<div>"),d&&a.utils.isString(d)&&(d=a.utils.makeXMLDoc(d)),d.jquery||(d=i(d)),e||(e=d.first().prop("tagName")),d.length&&(d=d.first()),d&&(d.attr("uniqueid")&&(g=d.attr("uniqueid")),d.attr("cssclass")&&c.addClass(d.attr("cssclass"))),g||(g=a.utils.generateGUID()),c.prop("id",g),a.componentType.get(e)){var j=new b(c,e);return d&&(j.xmlDefinition=d),j.conditionallyRender({context:f,xmlDefinition:d}),j}return l(e)}function g(a,b,c){var d=[],e=[];return i.each(a,function(){var a=h.factory({definition:this,context:c});a.element&&e.push(a.element),d.push(a)}),b&&(b.append(e),i.each(e,function(){i(this).trigger("attach")})),d}var h=a.component={},i=a.$,j={},k={},l=function(a){return"There is no Skuid Component Type called '"+a+"'"};b.prototype.getId=b.prototype.id=function(){return this._GUID},b.prototype.getType=b.prototype.type=function(){return this._componentType},b.prototype.setType=function(a){return this._componentType=a,this},b.prototype.getElement=function(){return this.element},b.prototype.render=function(b){var c,d,e=this,f=e.getType(),g=a.componentType.get(f);if(b||(b={}),!g)return l(f);if(b.context&&(e.context=c=b.context),b.xmlDefinition?e.xmlDefinition=d=b.xmlDefinition:d=e.xmlDefinition,e.element.empty&&g&&!g.onlyRenderOnce&&g.emptyBeforeRender!==!1&&e.element.empty(),!e.isBeingRendered){switch(e.isBeingRendered=!0,typeof g){case"function":g(e.element,d,e);break;case"object":if("render"in g){g.render(e.element,d,e);break}default:throw"Invalid Component Type definition. Component Type must be a JavaScript Object with a render() method."}e.isBeingRendered=!1}return e.isRendered=!0,e.element.attr("data-rendered","true"),e},b.prototype.unrender=function(){var b=this,c=b.getType(),d=a.componentType.get(c);return b.element.data&&i.each(b.element.data(),function(a,b){"component"!==a&&"object"!==a&&b&&"object"==typeof b&&b.widget&&b.widget._destroy&&b.widget._destroy()}),b.unregisterChildComponents(),b.element.empty&&d&&!d.onlyRenderOnce&&b.element.removeAttr("style").empty(),b.isRendered=!1,b.element.attr("data-rendered","false"),b},b.prototype.unregisterChildComponents=function(){var b=this,c=this.childComponents;return c&&c.length&&(i.each(c,function(b,c){a.utils.removeEventSubscriptions(c.element),c.unregister&&c.unregister()
}),c.length=0),b},b.prototype.conditionallyRender=function(b){var c=this;return a.utils.conditionallyRender(function(a,d,e,f){c.render(b),f&&f.eventSubscriptions&&(c._eventSubscriptions=f.eventSubscriptions)},function(){c.unrender()},c.xmlDefinition,c.element,c._GUID,b),c},b.prototype.createConditionsFromXml=function(b){var c,d,e,f,g=this,h=g.element,j=b.children("conditions").first().children(),k=b.attr("controllingcomponent"),l=b.attr("rowid"),m=[];return h&&(k&&(h.controllingComponent=a.component.getById(k)),h.conditions=m),j&&(d=g&&g.context?g.context.row:null,j.each(function(){c=new a.model.Condition(i(this)),"contextrow"==c.type&&(e=c.mergeField||"Id",f=l,!f&&d&&(f=a.utils.getObjectProperty(d,e)||""),f&&(c.value=f)),m.push(c)})),m};var m=function(){var a=k.skuidpage;return a&&a.length?a[0]:void 0};b.prototype.addProblem=function(a){i(function(){var b=m(this.element),c=this._GUID;!b||b.id()===c&&c||b.addProblem(a)})},b.prototype.addProblems=function(a){i(function(){var b=m(this.element),c=this._GUID;!b||b.id()===c&&c||b.addProblems(a)})},b.prototype.unregister=function(){var a=this,b=k[a.getType()],c=a._eventSubscriptions;a.id()in j&&delete j[a.id()];var d=i.inArray(a,b);-1!==d&&b.splice(d,1),a.unregisterChildComponents(),c&&(i.each(c,function(){this.unsubscribe&&this.unsubscribe()}),delete a._eventSubscriptions)},h.register=c,h.getByType=d,h.getById=e,h.factory=f,h.createChildComponents=g,h.Component=b,a.$C=e;var n=a.page.updateProblemsWrapper;a.componentType.register("skuidpage",{onlyRenderOnce:!0,render:function(c,d,e){var f=d.children("components").first().children(),g=a.component.createChildComponents(f,c),h=e.problems=[];e.addProblem=function(b,c){("string"==typeof b||b instanceof String)&&(b={message:b}),h.push(b),a.page.displayProblem(b),c!==!0&&n()},e.addProblems=function(a){a instanceof Array?i.each(a,function(a,b){e.addProblem(b,!0)}):e.addProblem(a,!0),n()},e&&(e.unregister=function(){h.length=0,b.prototype.unregister.call(e),g.length&&i.each(g,function(){this.unregister()}),a.page.rebuildPageProblems()}),i("#bodyTable").show(),c.trigger("pageload")}})}(skuid),function(a){var b=a.sfdc={},c=b.api={},d="32.0",e=c.version=d,f="/services/data/v",g=b.weblink={},h=a.$,i=[],j={},k={},l=function(a){return{fields:[{id:"Name"},{id:"MasterLabel"},{id:"PageOrSobjectType"},{id:"NamespacePrefix"},{id:"OpenType"},{id:"LinkType"},{id:"Url"}],conditions:[{field:"DisplayType",operator:"IN",type:"multiple",values:["L","B"]},{field:"PageOrSobjectType",value:a},{field:"LinkType",operator:"IN",type:"multiple",values:["page","url"]}],objectName:"Weblink",order:"Name"}},m=function(a){a&&(a instanceof Array?a.length&&h.each(a,function(){i.push(this)}):i.push(this))},n=function(a){return a in j},o=function(b){var c,d,e=b.weblinkName,f=b.objectName,g=b.namespacePrefix,p=b.callback,q=h.Deferred();if(e&&f&&h.each(i,function(a,b){if(b.Name===e&&b.PageOrSobjectType===f){if(g===b.NamespacePrefix)return d=b,!1;b.NamespacePrefix&&(c=b)}}),!d&&c&&(d=c),d||b.didQuery===!0||n(f))q.resolve(),p&&p(d);else{var r=k[f],s=!1;r||(r=k[f]=[],s=!0),r.push(b),s&&a.RemotingStubs.load(JSON.stringify(l(f)),function(a,b){j[f]=1;var c=JSON.parse(a),d=c[0];b.status?(d.data&&d.data.length&&m(d.data),h.each(r,function(a,b){b.didQuery=!0,o(b)})):(q.resolve(),r.length&&h.each(r,function(a,b){b.callback&&b.callback(null)})),delete k[f]},{escape:!1})}return q},p=function(a){var b=[];return i.length&&h.each(i,function(){this.PageOrSobjectType===a&&b.push(this)}),b},q=function(b){b||(b={});var c,d=b.type,g=b.url;if(!d)throw'Parameter "type" expected, e.g. "POST", "GET"';if(!g)throw'Parameter "url" expected, e.g. "/sobjects/Account", "/query/?q=select+Name+from+Account"';return c={type:d,url:f+e+g,dataType:"json",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.utils.userInfo.sessionId},success:function(a){b.success&&b.success(a)},error:function(a,c,e){if(b.error)b.error(a,c,e);else{var f=a.responseJSON[0];window.alert("There was an error performing this "+d+" request:\n\nError code: "+f.errorCode+"\nMessage: "+f.message+"\n")}}},b.data&&(c.data=JSON.stringify(b.data)),h.ajax(c)},r="Missing object property: ",s={StaticResource:{fields:{Name:{required:!0},Description:{required:!1},Body:{required:!0},CacheControl:{required:!0,defaultValue:"Public"},ContentType:{required:!0,defaultValue:"text/plain"}}},ApexPage:{fields:{Name:{required:!0},Markup:{required:!0},MasterLabel:{required:!0},ApiVersion:{required:!0,defaultValue:c.version}}},ApexClass:{fields:{Name:{required:!0},Body:{required:!0},ApiVersion:{required:!0,defaultValue:c.version}}}},t=function(a,b){this._type=a,"object"==typeof b&&h.extend(this,b)};t.prototype.insert=function(){return u.apply(this,arguments)},t.prototype.update=function(){return v.apply(this,arguments)},t.prototype["delete"]=function(){return w.apply(this,arguments)},t.prototype.get=function(a){return this[a]},t.prototype.set=function(b,c){a.utils.isString(b)?this[b]=c:h.extend(this,b)},t.prototype.getType=function(){return this._type},t.prototype.getFields=function(){var a=s[this.getType()];return a?a.fields:null},t.prototype.getField=function(a){var b=this.getFields();return b?b[a]:null};var u=function(a){a||(a={});var b=this,c=b.getFields(),d=b.getType(),e={},f=a.useToolingApi||"ApexClass"===d;return c&&h.each(c,function(a,c){var d=b[a];if(c.required&&("undefined"==typeof d||""===d)){if(!c.defaultValue)throw r+a;d=b[a]=c.defaultValue}e[a]=d}),q({type:"POST",url:"/"+(f?"tooling/":"")+"sobjects/"+d,data:e,success:function(c){if(c.success)b.Id=c.id,a.success&&a.success(c);else{var e=d+" could not be created due to errors:\n\n";h.each(c.errors,function(){e+=this+"\n"})}},error:function(b,c,e){if(a.error)a.error(b,c,e);else{var f=b.responseJSON;f&&f.length&&window.alert("Unable to create new "+d+" due to error:\n\nError code: "+f[0].errorCode+"\nMessage: "+f[0].message)}}})},v=function(a){a||(a={});var b=this,c=b.getFields(),d=b.getType(),e={};return c&&h.each(c,function(a){var c=b[a];"undefined"!=typeof c&&(e[a]=c)}),q({type:"PATCH",url:"/"+(a.useToolingApi?"tooling/":"")+"sobjects/"+d+"/"+b.Id,data:e,success:a.success,error:function(c,e,f){if(a.error)a.error(c,e,f);else{var g=c.responseJSON;g&&g.length&&window.alert("Unable to update "+d+" with Id "+b.Id+" due to error:\n\nError code: "+g[0].errorCode+"\nMessage: "+g[0].message)}}})},w=function(a){a||(a={});var b=this,c=b.getType(),d=a.useToolingApi||"ApexClass"===c;if(!b.Id)throw r+"Id";return q({type:"DELETE",url:"/"+(d?"tooling/":"")+"sobjects/"+c+"/"+b.Id,success:a.success,error:a.error})},x=function(a,b){return b||(b={}),q({type:"GET",url:"/"+(b.useToolingApi?"tooling/":"")+"query/?q="+encodeURIComponent(a),success:b.success,error:function(a,c,d){if(b.error)b.error(a,c,d);else{var e=a.responseJSON;e&&e.length&&window.alert("There was an error performing this query: "+e[0].message)}}})},y=function(a){return window.btoa(window.unescape(encodeURIComponent(a)))};g.get=o,g.getAllForObject=p,g.add=m,g.haveQueriedForObject=n,c.makeRequest=q,c.query=x,c.escapeMetadataBody=y,c.SObject=t,g._buildQueryForObject=l}(skuid),function(a){function b(b,c,d){var e=a.$.Deferred();return c?a.utils.isString(c)||(c=JSON.stringify(c)):c={},a.RemotingStubs.runProcessPlugin(b,c,function(a,b){b.status?(a=JSON.parse(a),d&&d(a),e.resolve(a)):e.reject(b)},{escape:!1}),e.promise()}function c(b,c){var d=a.$.Deferred();return a.RemotingStubs.describeProcessPlugin(b,function(a,b){b.status?(a=JSON.parse(a),c&&c(a),d.resolve(a)):d.reject(b)},{escape:!1}),d.promise()}var d=a.plugins={};d.run=b,d.describe=c}(skuid),function(a){var b=a.responsive={},c=a.$;b.config={},b.config.resizeWaitTime=100;var d=function(a,b,c,e,f){return b||(b={usedSpace:0,divisions:[]},a.push(b)),e<=f-b.usedSpace?(b.divisions.push(c),b.usedSpace+=e):f>=e||0!==b.usedSpace?b=d(a,null,c,e,f):(b.divisions.push(c),b.usedSpace+=e),b},e=function(){c.each(g,function(){f(this)})},f=function(a){var b=parseInt(a.outerWidth(),10);if(!b)return!1;var e=parseInt(a.data("precision"),10),f=parseInt(a.data("minwidth"),10),g=a.data("layoutmode")||"fillrow",h=parseInt(a.data("voffset"),10),i=parseInt(a.data("vpercent"),10);if((h||0===h)&&i||0===i){var j=(a.offsetParent().outerHeight()-h)*(i/100);a.addClass("sm-grid-fixed-vertical").css("height",j+"px")}else a.removeClass("sm-grid-fixed-vertical").css("height","");var k=Math.floor(b/f),l=e>=k?k:e;0===l&&(l=1);var m,n=[];a.children().each(function(){var a=c(this),b=a.data("rendered")===!1?0:parseInt(a.data("size"),10);m=d(n,m,a,b,l)}),c.each(n,function(){var a=this,b=a.divisions.length-1;c.each(a.divisions,function(c){var d,e=this,f=e.data("rendered")===!1?0:parseInt(e.data("size"),10);"rigid"===g?(d=l,f>l&&(f=l)):d=a.usedSpace,e.css("width",f/d*100+"%"),c!==b||"rigid"===g&&a.usedSpace!==l?e.removeClass("last"):e.addClass("last")})})},g={},h=function(a,b){g[a]=b},i=function(a){delete g[a]},j=function(){e()},k=!1;c(window).on("resize orientationchange",function(){k!==!1&&clearTimeout(k),k=setTimeout(a.responsive.handleResize,a.responsive.config.resizeWaitTime)}),b.dumbFitAlgorithm=d,b.processResponsiveGrids=e,b.processGrid=f,b.registerGrid=h,b.unregisterGrid=i,b.handleResize=j}(skuid),function(skuid){function TemplateComponent(a,b){var c=this;return c.element=a,c.options=b||{},c.editor=new window.skuid.ui.Editor(a,{showHeader:!1,showMessages:!1}),b.model&&(c.model=b.model,c.editor.registerModel(c.model)),!c.conditions&&b.conditions&&(c.conditions=b.conditions),b.controllingComponent||(c.editor.handleSave=function(a){a&&c.render()},c.editor.handleCancel=function(){c.render()},c.editor.handleDataRefresh=function(){c.render()},c.editor.handleChange=function(){c.render()}),c.render(),c}function FileUploader(){this.iframe=$('<iframe style="display:none;" src="" frameborder="0">')}function FileComponent(a,b){var c=this;if(c.elem=a,c.options=b,c.model=b.model,c.row=b.row,!c.row)return a.text("No record found for file component."),!1;if(a.off("imageuploadcomplete imageuploadstarted mouseenter mouseleave click"),"record"===b.storeAs){if(!(c.model.accessible&&c.row&&c.row.Id))return a.text("You do not have permission to upload files to this record."),!1;c.uploader=new FileUploader,c.uploader.iframe.appendTo(a),c.uploader.setSource(c.row.Id,c.elem.attr("id"));var d=[];$.each(skuid.model.getModelsList(),function(){"Attachment"===this.objectName&&(d.push(this),this.cancel())}),a.on("imageuploadcomplete",function(){skuid.model.updateData(d)})}else if("field"===b.storeAs){if(c.objField=b.idField,!c.objField)return a.text("No image field was specified."),!1;c.imageId=c.model.getFieldValue(c.row,c.objField),c.lookupFieldName=c.objField.substr(0,c.objField.length-1)+"r",c.attachmentIdFieldName=c.lookupFieldName+".skuid__AttachmentId__c",c.attachmentNameFieldName=c.lookupFieldName+".Name";var e=c.model.getField(c.objField);if(c.attId=c.model.getFieldValue(c.row,c.attachmentIdFieldName),c.attName=c.model.getFieldValue(c.row,c.attachmentNameFieldName),c.recomputeFlag=c.model.getFieldValue(c.row,c.lookupFieldName+".skuid__NeedsRecompute__c"),"Yes"===c.recomputeFlag)return c.recomputeId(),c;c.canCreateOrUpdateImage=c.model.accessible&&(c.options.editable||c.options.deleteable)&&(c.model.updateable&&e.editable||c.imageId),c.canCreateOrUpdateImage&&(c.uploader=new FileUploader,c.uploader.iframe.appendTo(a),c.uploader.setSource(c.row.Id,c.elem.attr("id"),c.objField))}if("filename"===b.displayAs||"record"===b.storeAs){var f,g;if(c.uploader&&(g=$("<div>").css("word-break","normal"),skuid.mobile?(g.addClass("sm-button").css("display","inline-block"),f=new skuid.mobile.ui.Button({icon:"fa-plus",label:b.label||"Upload",element:g,iconColor:"green"}),g.on("tap",function(){c.uploader.pickFile()})):g.text(b.label||"Upload").css("vertical-align","top").skooButton({icon:"sk-icon-upload"}).click(function(){c.uploader.pickFile()}),g.appendTo(a)),c.status=$("<div>").css({"float":"none",display:"inline-block"}).appendTo(a).hide(),c.statustext=$("<div>").appendTo(c.status),skuid.mobile||(c.status.addClass("nx-actionselect nx-status").css({"vertical-align":"bottom","margin-left":"4px"}),c.statustext.addClass("nx-actionselect-text")),c.model.updateable&&b.deleteable){if(skuid.mobile){c.deletebutton=$('<div class="sm-button">').css("display","inline-block");var h=new skuid.mobile.ui.Button({icon:"fa-minus",element:c.deletebutton,iconColor:"red"});c.deletebutton.on("tap",function(){h.startProcessing(),c.deleteImage()}),a.on("imagedeletecomplete",function(){h.stopProcessing()})}else c.deletebutton=$('<div class="sk-icon inline sk-icon-delete">').css({border:"3px solid #EEE","vertical-align":"top","background-color":"#EEE","margin-top":"3px",cursor:"pointer"}),c.deletebutton.click(function(){c.deleteImage()});c.deletebutton.appendTo(a)}a.on("imageuploadstarted",function(a,b){c.attName=b.fileName,skuid.ui.setStatus(c.status,c.statustext,"Uploading "+b.fileName),c.status.off("click"),f&&f.startProcessing()}),f&&a.on("imageuploadcomplete",function(){f.stopProcessing()})}else"image"===b.displayAs&&(c.elem.children(".nx-edithover").remove(),c.elem.addClass("nx-attachmentimage"),c.defaultImageSrc=skuid.utils.getDefaultImageUrl(c.options.defaultImage||"person"),c.image=$("<img>").addClass("nx-attachmentimage-image").css("max-width","100%").appendTo(a),c.canCreateOrUpdateImage&&c.elem.on("mouseenter",function(){c.options.editable&&c.uploader&&c.elem.append($("<div>").addClass("nx-edithover sk-icon inline sk-icon-edit").css({"background-color":"white",opacity:"0.8",border:"4px solid white"}).click(function(a){c.elem.find(".nx-error").remove(),c.uploader&&c.uploader.pickFile(),a.stopPropagation()})),c.attId&&c.options.deleteable&&c.elem.append($("<div>").addClass("nx-edithover sk-icon inline sk-icon-delete").css({cursor:"pointer","background-color":"white",opacity:"0.8",border:"4px solid white",left:"4px"}).click(function(a){c.elem.find(".nx-error").remove(),c.deleteImage(),a.stopPropagation()}))}).on("mouseleave",function(){c.elem.find("div.nx-edithover").remove()}),c.elem.on("click",function(){if(c.attId){var a=$("<img>").attr("src",skuid.utils.getUrlFromAttachmentId(c.attId)).css({"max-height":"600px","max-width":"800px"});a.load(function(){var b=$("<div>").attr("title",skuid.utils.encodeHTML(c.attName)).append(a).dialog({close:function(){$(this).remove()},modal:!0,width:"auto",resizable:!1,open:function(){$(".ui-widget-overlay").on("click",function(){b.dialog("close")})},dialogClass:"nx-imageview"})})}}),a.on("imageuploadstarted",function(a,b){b.fileName&&b.fileName!==c.attName&&(c.attName=b.fileName)}));a.on("imageuploadcomplete",function(a,b){c.attId=b.newAttachmentId,c.imageId=b.newImageId,c.syncModel(),c.draw()}),$(function(){c.draw()})}var $=skuid.$,utils=skuid.utils={},MERGE_GLOBAL="global",MERGE_MODEL="model",MERGE_ROW="row",SelectItem=function(a){if(this._GUID="SelectItem-"+skuid.utils.generateGUID(),!a)throw"You must provide a configuration object when creating a new SelectItem.";if(!("value"in a))throw"Value is required.";$.extend(this,a),"label"in a||(this.label=this.value),this.isSelected||(this.isSelected=!1)};SelectItem.prototype.id=function(){return this._GUID};var SelectList=function(){this.items=[],this.itemsMap={},this.selectedIndex=this.selectedKey=!1};SelectList.prototype.addItem=function(a,b){if(!a._GUID)throw"Invalid SelectItem.";if(-1!==$.inArray(a,this.items))throw"Item is already in the List.";a.isSelected&&this.selectedIndex!==!1&&(this.items[this.selectedIndex].isSelected=!1),b?this.items.unshift(a):this.items.push(a);var c=b?0:this.items.length-1;a.isSelected?(this.selectedIndex=c,this.selectedKey=a.value):b&&this.selectedIndex!==!1&&this.selectedIndex++,this.itemsMap[a.value]=a,this.selectedIndex===!1&&(this.selectedIndex=c,this.selectedKey=a.value,a.isSelected=!0)},SelectList.prototype.getSelected=function(){return this.selectedIndex===!1?[]:this.items[this.selectedIndex]},SelectList.prototype.addItems=function(a,b){var c=this;a&&$.each(a,function(){c.addItem(this,b)})},SelectList.prototype.size=function(){return this.items?this.items.length:0},SelectList.prototype.removeItemAtIndex=function(a){this._validateIndex(a);var b=this.items[a],c=b.isSelected;b&&(b.value&&b.value in this.itemsMap&&delete this.itemsMap[b.value],this.items.splice(a,1),b.isSelected=!1),c!==!1&&(this.selectedIndex=!1,this.selectedKey=!1,this.size()>0&&this.selectItemAtIndex(0))},SelectList.prototype.selectItemAtIndex=function(a){if(this._validateIndex(a),this.selectedIndex!==!1){if(a===this.selectedIndex)return!0;this.items[this.selectedIndex].isSelected=!1}this.items[a].isSelected=!0,this.selectedIndex=a,this.selectedKey=this.items[a].value},SelectList.prototype.selectItem=function(a){var b;if(b=utils.isNumber(a)?a:this.indexOf(a),-1===b)throw"Invalid Item";this.selectItemAtIndex(b)},SelectList.prototype.removeItem=function(a){var b;if(b=utils.isNumber(a)?a:this.indexOf(a),-1===b)throw"Invalid Item";this.removeItemAtIndex(b)},SelectList.prototype.indexOf=function(a){return!(a instanceof SelectItem)&&a.value&&a.value in this.itemsMap&&(a=this.itemsMap[a.value]),a?$.inArray(a,this.items):-1},SelectList.prototype.contains=function(a){return-1!==this.indexOf(a)},SelectList.prototype._validateIndex=function(a){if(a>=this.size()||0>a)throw"Invalid Index";return!0},TemplateComponent.prototype.unregister=function(){this.editor&&this.model&&this.editor.unregister()},TemplateComponent.prototype.render=function(){var a,b=this,c=b.model,d=b.options||{},e=d.templateBody||"",f=d.context,g=b.conditions,h={allowHTML:d.allowHTML,registerFields:!1};b.editor.contents.empty(),c?(a=g&&g.length?utils.filterRowsByConditions(c.data,g,f):f&&c&&f.model&&f.row&&f.model===c?[f.row]:utils.filterRowsByConditions(c.data,null,f),!d.isMultiRow&&a&&a.length?(a&&a.length>1&&d.onlyShowFirstRow===!0&&(a=[a[0]]),$.each(a,function(a,d){d&&b.editor.contents.append(c.mergeRow(d,e,h))})):b.editor.contents.append(c.mergeModel(e,h))):b.editor.contents.append(utils.merge(MERGE_GLOBAL,e,h))},FileUploader.prototype.setSource=function(a,b,c){this.iframe.attr("src",(skuid.page.runningOnForceSite?skuid.page.currentSiteUrl:"/")+"apex/UploadImage?id="+a+(c?"&objfield="+c:"")+"&elid="+b)},FileUploader.prototype.pickFile=function(){this.iframe.contents().find("input[type=file]").click()},FileComponent.prototype.draw=function(){var a=this;"filename"===a.options.displayAs||"record"===a.options.storeAs?a.attId&&a.attName&&a.objField?(skuid.ui.setStatus(a.status,a.statustext,a.attName),a.status.on("click",function(){window.open(skuid.utils.getUrlFromAttachmentId(a.attId),"ViewFile")}),a.options.deleteable&&a.deletebutton&&a.deletebutton.show()):(a.deletebutton&&a.deletebutton.hide(),a.status.hide()):"image"===this.options.displayAs&&(this.attId?this.image.attr("src",skuid.utils.getUrlFromAttachmentId(this.attId)):this.image.attr("src",this.defaultImageSrc))},FileComponent.prototype.deleteImage=function(){var a=this,b={};b.id="objdelete",b.changes={},b.changes[this.row.Id]={},b.changes[this.row.Id][this.objField]="",b.type=this.model.objectName;var c={};c.id="imagedelete",c.changes={},c.changes[this.imageId]={__deleted:"true"},c.type="skuid__Image__c",a.status&&a.statustext&&skuid.ui.setStatus(a.status,a.statustext,"Deleting"),skuid.RemotingStubs.save(JSON.stringify({operations:[b,c]}),function(b,c){c.status&&(a.attId=null,a.attName=null,a.imageId=null,a.syncModel(),a.draw(),a.elem.trigger("imagedeletecomplete"))})},FileComponent.prototype.recomputeId=function(){var a=this,b={};b.id="imagerecompute",b.changes={},b.changes[this.imageId]={skuid__NeedsRecompute__c:"Initiate"},b.type="skuid__Image__c",skuid.RemotingStubs.save(JSON.stringify({operations:[b]}),function(){a.model.updateData(function(){a=new FileComponent(a.elem,a.options)})})},FileComponent.prototype.unregister=function(){this.elem&&this.elem.remove&&this.elem.remove()},FileComponent.prototype.syncModel=function(){var a=this,b={},c=a.row,d={};if(b[c.Id]=d,a.objField){if((a.imageId!==c[a.objField]||a.attId!==a.model.getFieldValue(c,a.lookupFieldName+".skuid__AttachmentId__c",!0))&&(d[a.objField]=a.imageId),a.imageId){var e=c[a.lookupFieldName]||{};$.extend(e,{skuid__AttachmentId__c:a.attId,Name:a.attName}),d[a.lookupFieldName]=e,$.extend(c,d)}else delete c[a.objField],delete c[a.lookupFieldName];utils.size(d)&&a.model.notifyFieldsOfChange(b,{initiatorId:a})}},utils.getDefaultImageUrl=function(a){return"/resource/skuid__DefaultPhotos/"+("org"===a?"Org":"Profile")+".jpg"};var nameFieldsByObject={Case:"CaseNumber",ContentDocument:"Title",ContentVersion:"Title",FeedItem:"Title",Idea:"Title",Solution:"SolutionName",Task:"Subject",Event:"Subject",PartnerNetworkConnection:"ConnectionName"},objectsWithoutNameFields={CampaignMember:1,AccountContactRole:1,OpportunityContactRole:1,ContractContactRole:1,CaseContactRole:1,CaseComment:1,CaseSolution:1,OpportunityLineItem:1};utils.isApiEnabled=function(){return window.sforce&&sforce.connection&&sforce.connection.sessionId};var canUseLocalStorage="nodata";utils.canUseLocalStorage=function(){if("nodata"===canUseLocalStorage)try{canUseLocalStorage="localStorage"in window&&null!==window.localStorage}catch(a){canUseLocalStorage=!1}return canUseLocalStorage};var canUseSessionStorage="nodata";utils.canUseSessionStorage=function(){if("nodata"===canUseSessionStorage)try{canUseSessionStorage="sessionStorage"in window&&null!==window.sessionStorage}catch(a){canUseSessionStorage=!1}return canUseSessionStorage};var hsh=function(a){var b,c,d,e=0;if(0===a.length)return e;for(b=0,c=a.length;c>b;b++)d=a.charCodeAt(b),e=(e<<5)-e+d,e|=0;return e},_sessionIdHash,getSessionHash=function(){return _sessionIdHash||(_sessionIdHash=hsh(utils.userInfo?utils.userInfo.sessionId:(new Date).getTime())),_sessionIdHash},getSessionLanguage=function(){return utils.userInfo.language},cacheNeedsRefresh=function(a){return a.__uid!==getSessionHash()||a.__userLanguage!==getSessionLanguage()},checkInCache=function(a){return a?(a.modstamp=(new Date).getTime(),a.__uid=getSessionHash(),void(a.__userLanguage=getSessionLanguage())):!1};utils.sessionStorage=function(a,b){if("undefined"==typeof a)return null;var c=utils.canUseSessionStorage();return"undefined"==typeof b?c?window.sessionStorage[a]:$.cookie(a):c?window.sessionStorage[a]=b:$.cookie(a,b)},utils.localStorage=function(a,b){if("undefined"==typeof a)return null;var c=utils.canUseLocalStorage();return"undefined"==typeof b?c?window.localStorage[a]:$.cookie(a):c?window.localStorage[a]=b:$.cookie(a,b)};var _mergeSettings={createFields:!1,registerFields:!1};utils.mergeNodeProperty=function(a,b,c,d){d||(d=_mergeSettings);var e=c&&c.model?c.row?MERGE_ROW:MERGE_MODEL:MERGE_GLOBAL,f=$("<div>"),g=a.attr(b);return"undefined"!=typeof g?(f.append(e==MERGE_ROW?utils.merge(MERGE_ROW,g,d,c.model,c.row):e==MERGE_MODEL?utils.merge(MERGE_MODEL,g,d,c.model):utils.merge(MERGE_GLOBAL,g,d)),f.text()):void 0},utils.redirect=function(a){if(a){var b=a.model,c=a.row,d=a.url,e=a.title||"",f=a.window,g=b?c?MERGE_ROW:MERGE_MODEL:MERGE_GLOBAL,h=$.extend(_mergeSettings,a.mergeSettings||{}),i=window.sforce&&sforce.one?sforce.one:!1,j=window.sforce&&sforce.console&&sforce.console.isInConsole()?sforce.console:!1,k=d&&utils.startsWith(d,"/"),l=skuid.page.sitePrefix;d&&(d=utils.mergeAsText(g,d,h,b,c),i?i.navigateToURL(d,"blank"===f):j?k?(c&&b&&(utils.startsWith(d,"/"+c.Id)||utils.startsWith(d,"/"+c.Id.substring(0,15)))&&b.getRowById(c.Id)&&(e=b.getNameFieldValueForRow(c)),skuid.ui.openConsoleTabForUrl(d,e)):window.open(d):(l&&"null"!==l&&k&&!utils.startsWith(d,l)&&(d=l+d),"blank"===f?window.open(d):"parent"===f?parent.location=d:window.location=d))}},utils.createPopupFromAction=function(a,b,c){var d=a.children("popup").first();return utils.createPopupFromPopupXML(d,b,c)},utils.createPopupFromPopupXML=function(a,b,c){if(!a)return null;b||(b={}),c||(c={});var d=$("<div>").attr("title",utils.mergeNodeProperty(a,"title",b,{createFields:!0,registerFields:!1})),e=[],f=[],g=!0,h=!0;return b.popup=d,("false"===a.attr("modal")||c.modal===!1)&&(g=!1),("false"===a.attr("resizable")||c.resizable===!1)&&(h=!1),a.children("components").first().children().each(function(){var a=skuid.component.factory({definition:this,context:b});e.push(a.element),f.push(a)}),d.append(e).dialog({close:function(){f&&$.each(f,function(){this.unregister&&this.unregister()}),d.dialog("destroy").remove(),c.close&&c.close.apply(this)},open:function(){c.open&&c.open.apply(this)},modal:g,resizable:h,width:a.attr("width")||"600px",buttons:c.buttons||[]}),d},utils.calculateReferenceMerges=function(a){a||(a={});var b,c,d,e,f,g={registerFields:!1},h=a.fieldMetadata;if(h&&(e=h.rel,f=h.id),!("template"in a||"fieldMetadata"in a))throw"skuid.utils.calculateReferenceText: Either fieldMetadata or a template must be provided.";if(a.template){var i=f.indexOf(".");d=f&&-1!=i?f.substring(0,i+1):"",c=a.template,g.fieldPrefix=d+e+"."}else{var j,k;if(-1!=h.ref.indexOf(",")||h.referenceTo&&h.referenceTo.length>=2){if(a.targetObject){var l=a.targetObject.split(".");j=l[l.length-1]}else j=h.referenceTo[0].objectName;k="Name"}else j=h.ref,k=skuid.utils.getNameField(j);e?(-1!=f.indexOf(".")&&(e=f.substring(0,f.lastIndexOf(".")+1)+e),c="{{"+e+"."+k+"}}"):c="{{"+k+"}}"}return b=a.model.getRowMergeResult(a.row,c,g)},utils.calculateReferenceText=function(a){return utils.calculateReferenceMerges(a).merges.text()},utils.getFieldRelationshipName=function(a,b){var c=a.split(".");c.pop();var d=c.join(".");return"REFERENCE"===b.displaytype?(d?d+".":"")+b.rel:d},utils.getTargetObject=function(a){return a.referenceTo[0]},utils.getFieldReference=function(a,b){return utils.getFieldRelationshipName(a,b)+"."+utils.getNameField(utils.getTargetObject(b).objectName)},utils.getReferenceFieldNameFromRelationshipField=function(a){var b=a.split(".")[0],c=utils.endsWith;return c(b,"__r")||c(b,"__pr")?b.substring(0,b.length-1)+"c":b+"Id"},utils.getReferenceFieldRelationshipName=function(a){var b=utils.endsWith;return b(a,"__c")||b(a,"__pc")?a.substring(0,a.length-1)+"r":a.substring(0,a.length-2)};var userInfoCamelCasings={defaultcurrency:"defaultCurrency",firstname:"firstName",lastname:"lastName",organizationid:"organizationId",organizationname:"organizationName",profileid:"profileId",sessionid:"sessionId",userid:"userId",username:"userName",userroleid:"userRoleId",usertype:"userType"},getUserInfoPropValue=function(a){var b=userInfoCamelCasings[a]||a,c=utils.userInfo;return"ismulticurrencyorganization"===a?utils.isMultiCurrencyOrganization:b in c?c[b]:void 0},logicRegex=/^([and|or|\d|\(|\)]+)$/,evaluateConditionLogic=function(logic,returnValues){var result,haveValidLogic=!0,mergedString,i=returnValues.length;if(logic?(mergedString=logic.toLowerCase().replace(/\s+/g,""),logicRegex.test(mergedString)||(haveValidLogic=!1)):haveValidLogic=!1,!haveValidLogic)throw"Invalid Condition Logic: "+logic;for(;i>0;i--)mergedString=mergedString.replace(i,returnValues[i-1]);return mergedString=mergedString.replace(/and/g,"&&").replace(/or/g,"||"),result=eval(mergedString)},FIELD_VALUE="fieldvalue";utils.areConditionsMet=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=!0,v=!1,w=!1;for(b||(b={}),r=b.context,t=b.logicType||"and","custom"===t?(s=b.logic,d=[]):"or"===t?w=!0:v=!0,a instanceof Array||(a=[a]),e=0;e<a.length;e++){if(c=!0,f=a[e],n=f.sourceType||FIELD_VALUE,o=n===FIELD_VALUE,p=f.sourceProperty,q=f.operator,m=f.type||FIELD_VALUE,g=null,h=null,j=null,l=f.value,o||utils.endsWith(n,"property"))if(f.fieldModel){if(g=skuid.model.getModel(f.fieldModel),g&&g.data)if(b.row&&b.model&&b.model.objectName===g.objectName)h=b.row;else if(g.data.length)h=g.data[0],f.fieldRow=h.Id;else if(o){var x=f.noSourceRowBehavior||"deactivate";if("deactivate"===x)continue;return"skipandrender"===x?!0:!1}}else b.row&&(h=b.row,b.model&&(g=b.model));if(o?i=utils.getObjectProperty(h,f.field):"userinfo"===n?i=getUserInfoPropValue(f.sourceUserInfoType):"param"===n?i=skuid.page.params[f.sourceParam]:utils.endsWith(n,"property")&&p&&g&&($.inArray(p,["hasRows","hasNoRows"])>-1?(i=!(!g.data||!g.data.length),l="hasRows"===p,q="=",m=FIELD_VALUE):"rowproperty"===n?h?(m=FIELD_VALUE,l||l===!1||0===l||(l=!0),q||(q="="),"isCloned"===p?i=skuid.model.isClonedRow(h):"isNew"===p?i=skuid.model.isNewId(h.Id):"isSaved"===p?i=!skuid.model.isNewId(h.Id):"hasChanged"===p&&(i=g.isRowChanged(h))):c=!1:i=skuid.utils.getObjectProperty(g,p)),k=null===i||""===i||"undefined"==typeof i,k&&(i=""),"userinfo"===m?l=getUserInfoPropValue(f.userInfoType):"param"===m&&(l=skuid.page.params[l]),"contextrow"===m&&r&&r.row){var y=f.mergeField||"Id",z=utils.getObjectProperty(r.row,y)||"";z&&(l=z)}if("blank"===m)"!="===q?k&&(c=!1):k||(c=!1);else if("multiple"===m){var A=f.values;if(A&&A instanceof Array){var B,C="includes"===q,D=A.length;if("in"===q&&-1===$.inArray(i,A))c=!1;else if("not in"===q&&-1!==$.inArray(i,A))c=!1;else if("includes"===q||"excludes"===q)if(B=i.split(";"),B.length){var E,F;for(E=0;E<A.length;E++)if(F=A[E],-1!==$.inArray(F,B)){if(!C){c=!1;break}}else if(C){c=!1;break}}else C&&D&&(c=!1)}}else switch(q){case"!=":i===l&&(c=!1);break;case"gt":(l>i||i==l)&&(c=!1);break;case"lt":(i>l||i==l)&&(c=!1);break;case"gte":l>i&&(c=!1);break;case"lte":i>l&&(c=!1);break;case"starts with":utils.startsWith(i,l,!0)||(c=!1);break;case"does not start with":utils.startsWith(i,l,!0)&&(c=!1);break;case"ends with":utils.endsWith(i,l,!0)||(c=!1);break;case"does not end with":utils.endsWith(i,l,!0)&&(c=!1);break;case"contains":utils.contains(i,l,!0)||(c=!1);break;case"does not contain":utils.contains(i,l,!0)&&(c=!1);break;case"includes":-1===$.inArray(l,i.split(";"))&&(c=!1);break;case"excludes":-1!==$.inArray(l,i.split(";"))&&(c=!1);break;default:i!==l&&(c=!1)}if(v&&!c){u=!1;break}if(w){if(u=c,c)break}else s&&d.push(c)}return s&&d&&d.length&&(u=evaluateConditionLogic(s,d)),u},utils.doesRowMeetConditions=function(a,b,c){return utils.areConditionsMet(b,{row:a,context:c})},utils.filterRowsByConditions=function(a,b,c){if(a&&a.length){var d=b&&b.length;return a.filter(function(a){return d?utils.doesRowMeetConditions(a,b,c):!0})}return[]};var multiValueOperators={includes:1,excludes:1,"in":1,"not in":1};utils.isMultiValueOperator=function(a){return a&&a.toLowerCase()in multiValueOperators},utils.isNumber=function(a){return!isNaN(a-0)},utils.adjustValueBasedOnQuotedness=function(a,b){var c=a;return!b&&a&&("false"===a?c=!1:"true"===a?c=!0:utils.isNumber(a)&&(c=-1!==a.indexOf(".")?parseFloat(a):parseInt(a,10))),c},utils.getObjectProperty=function(a,b){if(a&&b){for(var c=b.split("."),d=0;d<c.length;){if(!(a&&c[d]in a))return null;a=a[c[d++]]}return a}return null},utils.hasObjectProperty=function(a,b){if(a&&b){for(var c=b.split("."),d=0,e=!1;d<c.length;){if(!(a&&c[d]in a))return!1;a=a[c[d++]],e=!0}return e}return!1};var rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;utils.removeScriptTags=function(a){return a&&utils.isString(a)?a.replace(rscript,""):a},utils.decodeXML=function(a){return a.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},utils.decodeHTML=function(a){return utils.isString(a)?a&&$("<div/>").html(a).text():a},utils.encodeHTML=function(a){return utils.isString(a)?a&&String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a},utils.isString=function(a){return"string"==typeof a||a instanceof String},utils.nl2br=function(a){return a&&a.replace(/(\r\n|\n|\r)/gm,"<br>")};var lowercase=function(a){return a&&"string"==typeof a?a.toLocaleLowerCase?a.toLocaleLowerCase():a.toLowerCase():a},stringComparison=function(a,b,c,d){return a&&b&&c?(d&&(b=lowercase(b),c=lowercase(c)),a(b,c)):!1};utils.endsWith=function(a,b,c){return stringComparison(function(a,b){return-1!==a.indexOf(b,a.length-b.length)},a,b,c)},utils.startsWith=function(a,b,c){return stringComparison(function(a,b){return 0===a.lastIndexOf(b,0)},a,b,c)},utils.contains=function(a,b,c){return stringComparison(function(a,b){return-1!==a.indexOf(b)},a,b,c)};var QUOTE='"',ESCAPED_QUOTE='""',CHARS_THAT_MUST_BE_QUOTED=[",",'"',"\n"];
utils.escapeCSVCell=function(a){return"undefined"!=typeof a?(a.indexOf(QUOTE)>-1&&(a=a.replace(/"/g,ESCAPED_QUOTE)),$.each(CHARS_THAT_MUST_BE_QUOTED,function(b,c){return a.indexOf(c)>-1?(a=QUOTE+a+QUOTE,!1):void 0})):a="",a},utils.escapeSelector=function(a){return a&&a.replace(/\./g,"\\.")},utils.escapeSingleQuotes=function(a){return a&&a.replace(/'/g,"\\'")},utils.getNameField=function(a){return a&&a in nameFieldsByObject?nameFieldsByObject[a]:a in objectsWithoutNameFields?"Id":"Name"};var describeCache={},getCache=function(a){var b=describeCache[a];return b?b:(b=utils.localStorage(a),b?(b=JSON.parse(b),describeCache[a]=b,b):null)},setCache=function(a,b){describeCache[a]=b,utils.localStorage(a,JSON.stringify(b))};utils.getAPIDescribeLayout=function(a){if(utils.isApiEnabled()){var b="skuid_describeLayout_"+a,c=getCache(b),d=!1;if(c?(cacheNeedsRefresh(c)&&(d=!0),(!c.modstamp||c.modstamp<skuid.page.modstamp)&&(d=!0)):d=!0,d)try{c=sforce.connection.describeLayout(a),checkInCache(c),setCache(b,c)}catch(e){}return c}return!1},utils.getAPIDescribeSObject=function(a){if(utils.isApiEnabled()){var b="skuid_describeSObject_"+a,c=getCache(b),d=!1;if(c?(cacheNeedsRefresh(c)&&(d=!0),(!c.modstamp||c.modstamp<skuid.page.modstamp)&&(d=!0)):d=!0,d)try{c=sforce.connection.describeSObject(a),checkInCache(c),setCache(b,c)}catch(e){}return c}return!1},utils.getPicklistEntriesValidForRecordTypes=function(a,b,c){var d,e,f=utils.toArray,g=function(a){a.value in d||(d[a.value]=1,e.push(a))},h=!1,i=utils.getAPIDescribeLayout(a);if(i){var j=i.recordTypeMappings;if(j){var k=[];$.each(f(j),function(){$.inArray(this.recordTypeId,c)>-1&&k.push(this)}),k.length&&(e=[],d={},$.each(k,function(a,c){var d=c.picklistsForRecordType;d&&$.each(f(d),function(){return this.picklistName===b?(h||(h=!0),this.picklistValues instanceof Array?$.each(this.picklistValues,function(){g(this)}):g(this.picklistValues),!1):void 0})}))}}return h?e:null},utils.highlightSFTab=function(a){var b,c,d,e,f,g,h,i,j,k,l=$("ul#tabBar"),m=l.children("li.zen-active, li.active"),n=m.find("span.zen-assistiveText, span.assistiveText").detach();if(m.removeClass("zen-active primaryPalette primaryPalette active").find("a").attr("title",function(a,b){return b.replace(" - Selected","")}),c=l.children("li").has("a:contains("+a+")"),!c.length&&(j=function(a){if(utils.isApiEnabled())try{b=sforce.connection.describeTabs(),k=$("#tsidLabel").text(),$.each(b,function(a,b){return"true"!==b.selected||k&&b.label!==k?void 0:(d=[],$.each(b.tabs,function(a,b){d.push({sobjectName:b.sobjectName,label:b.label,url:b.url})}),!1)}),i={tabs:d},checkInCache(i),a&&utils.localStorage(a,JSON.stringify(i))}catch(c){}return i},f=function(b){var c;return $.each(b,function(b,d){return d.sobjectName===a||d.label===a?(c=d.url,!1):void 0}),c},e=function(a){return(!a.__uid||cacheNeedsRefresh(a))&&(a=i=j(g)),a.tabs},g="skuid_describeTabs",h=utils.localStorage(g),i=h?JSON.parse(h):j(g),i&&(d=e(i)))){var o=f(d);o||(i=j(g),i&&(d=e(i)),d&&(o=f(d))),o&&(c=l.children("li").has('a[href="'+o+'"]'))}c.length&&c.first().addClass("zen-active active primaryPalette").find("a").attr("title",function(a,b){return b+" - Selected"}).after(n)},utils.insertAtIndex=function(a,b,c){0===c?a.prepend(b):a.children().eq(c-1).after(b)};var head=$("head");utils.loadJS=function(a){a&&0===$("script[src='"+a+"']").size()&&head.append($('<script type="text/javascript" src="'+a+'">'))},utils.loadCSS=function(a,b){0===$("link[href='"+a+"']").size()&&(document.createStyleSheet?document.createStyleSheet(a):b.prepend?head.prepend($('<link type="text/css" rel="stylesheet" href="'+a+'">')):head.append($('<link type="text/css" rel="stylesheet" href="'+a+'">')))},utils.getSearchOperatorForDisplayType=function(a,b,c){var d;return d="MULTIPICKLIST"===b?"="===a||"exact"===a?"=":"includes":"ID"===b||"Id"===c||utils.endsWith(c,".Id")?"=":"exact"===a?"=":a},utils.createSearchSubConditions=function(a,b,c,d,e){e||(e={});var f,g=e.delimiter||" ",h=e.searchOperator||"contains",i=1;return b.subConditions=[],b.subConditionLogic="",f=e.tokenize?c.split(g):[c],$.each(f,function(c){var e=this+"",g=[];return e?($.each(d,function(c,d){var f=d.searchOperator||h,j=a.getField?a.getField(d.id):d;j||(j=d);var k=j&&j.displaytype?j.displaytype:!1,l="REFERENCE"===k?utils.getFieldReference(d.id,d):d.id,m={type:"fieldvalue",field:l,inactive:!1};if(m.operator=utils.getSearchOperatorForDisplayType(f,k,l),"MULTIPICKLIST"===k)"="===m.operator||"exact"===m.operator?m.value=e:m.values=[e];else if("ID"===k||"Id"===l||utils.endsWith(l,".Id")){if(!e||18!==e.length&&15!==e.length)return!0;m.value=e}else m.value=e;if("REFERENCE"===k){var n=a.getField(l);n&&n.targetObjects&&(m.fieldTargetObjects=n.targetObjects)}else d.targetObjects&&(m.fieldTargetObjects=d.targetObjects);b.subConditions.push(m),g.push(i),i++}),b.subConditionLogic+="("+g.join("OR")+")",void(c<f.length-1&&(b.subConditionLogic+="AND"))):!0}),b},utils.extractFieldsFromTemplate=function(a,b){var c={};b||(b={});var d=function(a){if(a instanceof Array)for(var e=0;e<a.length;e++){var f=a[e];if("name"===f[0]||"&"===f[0]||"#"===f[0]||"^"===f[0]){var g=f[1];""!==g&&(!b.ignoreGlobals||-1===g.indexOf("$")&&-1===g.indexOf("Model."))&&(c[g]=1)}f.length>=5&&f[4]instanceof Array&&d(f[4])}};return d(skuid.Mustache.parse(a,["{{","}}"])),d(skuid.Mustache.parse(a,["{{{","}}}"])),Object.keys(c)};var preparseRegex=/\{{2,3}[^\{\}]+\}{2,3}/g,preparse=function(a){return[a.match(preparseRegex)||[],a.split(preparseRegex)]},skuidField=function(){var a=this;return function(b,c){return("Id"in a?a.Id:"")+'">'+c(b)}},urlEncode=function(){return function(a,b){return encodeURIComponent($("<div>").html(b(a)).text())}},urlDecode=function(){return function(a,b){return decodeURIComponent($("<div>").html(b(a)).text())}},_defaultMergeSettings={createFields:!0,registerFields:!1},mergeInContext=function(a,b,c,d){c||(c={});var e=c.model,f=c.row,g=d||_defaultMergeSettings;return f&&e?a(MERGE_ROW,b,g,e,f):e?a(MERGE_MODEL,b,g,e):a(MERGE_GLOBAL,b,g)};utils.mergeInContext=function(a,b,c){return mergeInContext(utils.merge,a,b,c)};var mergeAsData=function(a,b,c,d,e){return c||(c={}),c.asData=!0,b?utils.getMergeResult(a,b,c,d,e):null};utils.mergeAsDataInContext=function(a,b){return mergeInContext(mergeAsData,a,b)},utils.mergeAsTextInContext=function(a,b,c){return mergeInContext(utils.mergeAsText,a,b,c)},utils.mergeAsText=function(a,b,c,d,e){return c||(c={}),"undefined"==typeof c.nl2br&&(c.nl2br=!1),c.asText=!0,b?utils.getMergeResult(a,b,c,d,e):""},utils.merge=function(a,b,c,d,e){return utils.getMergeResult(a,b,c,d,e).merges};var validModes={};validModes[MERGE_GLOBAL]=1,validModes[MERGE_MODEL]=1,validModes[MERGE_ROW]=1,utils.getMergeResult=function(a,b,c,d,e){var f=arguments[0];if(null!==f&&"object"==typeof f&&(a=f.mode,b=f.template,c=f.options,d=f.model,e=f.row),!b&&""!==b)throw"Required argument 'template' was not provided.";if(!(a&&a.toLowerCase()in validModes))throw"Invalid merge mode. Valid modes are: global,model,row.";a=a.toLowerCase(),c||(c={});var g=d;if(("model"===a||"row"===a)&&!g)throw"Required argument 'model' was not provided for model merge.";if("row"===a&&(!e&&g.data.length&&(e=g.data[0]),!e))throw"Required argument 'row' was not provided for row merge.";var h,i,j=c.asText===!0,k=c.asData===!0,l={fields:[]},m=preparse(b),n=m[0],o=m[1],p="",q=!1,r=-1,s=o.length,t=c.apiExtensions;if(n.length){var u=skuid.utils.userInfo,v=skuid.page,w=window.sforce?sforce.connection:{};if(i={$Label:skuid.label.map,$Model:skuid.model.map(),$Param:v.params,$Api:{Session_Id:w.sessionId,Organization_Id:u.organizationId,User_Id:u.userId,Partner_Server_Url:w.partnerServerUrl,Enterprise_Server_Url:w.enterpriseServerUrl,Partner_Server_Urls:w.partnerServerUrls,Enterprise_Server_Urls:w.enterpriseServerUrls},$User:u,$Site:{CurrentSiteUrl:v.currentSiteUrl,Prefix:v.sitePrefix},urlEncode:urlEncode,encodeUrl:urlEncode,urlDecode:urlDecode,decodeUrl:urlDecode},(a===MERGE_MODEL||a===MERGE_ROW)&&$.extend(i,{Model:{conditions:g.conditions,Data:g.data,data:g.data,Label:g.label,label:g.label,LabelPlural:g.labelPlural,labelPlural:g.labelPlural,fields:g.fields,Fields:g.fieldsMap,fieldsMap:g.fieldsMap,KeyPrefix:g.keyPrefix,keyPrefix:g.keyPrefix,ObjectName:g.objectName,objectName:g.objectName,id:g.id,updateable:g.updateable,createable:g.createable,deleteable:g.deleteable}}),a===MERGE_MODEL)$.extend(i,{SkuidField:skuidField});else if(a===MERGE_ROW){var x=g.data.indexOf(e)+1;$.extend(i,e,{first:1===x,last:x===g.data.length,index:x,SkuidField:skuidField})}t&&$.extend(i,t)}else if(j||k)return b;if(k){if(1===n.length&&""===o.join("")){var y=utils.extractFieldsFromTemplate(n[0]);if(1===y.length)return utils.getObjectProperty(i,y[0])}j=!0}for(;s>0;){h=o[++r],s--,p+=h;var z=n[r];if(z){var A="{{{"===z.substring(0,3),B=z.substring(A?3:2,z.lastIndexOf(A?"}}}":"}}")),C=B.charAt(0),D=-1!==["#","/","^"].indexOf(C),E=D||-1!==["&","!"].indexOf(C),F="/"===C,G=D&&!F;if(c.fieldPrefix&&(B=E?C+c.fieldPrefix+B.substr(1):c.fieldPrefix+B,z="{{"+B+"}}"),-1!==B.indexOf(".records")&&(G?q=B.substring(1,B.indexOf(".records")):F&&(q=!1)),A||"&"===C){p+="{{"+B+"}}";continue}if(!A&&a!==MERGE_GLOBAL){var H,I=D&&q&&q in g.fieldsMap&&"childRelationship"===g.fieldsMap[q].type;if(I)H=!1;else if(q&&!D){var J=g.fieldsMap[q],K=J.subFieldsMap;H=B in K||"Id"===B}else H=B in g.fieldsMap||"Id"===B;if(H){a===MERGE_ROW?(p+='<span class="nx-merge" data-field="'+B,p+=q?'" data-parentfield="'+q+'" data-parentrowid="'+e.Id+'" data-rowid="{{#SkuidField}}'+z+"{{/SkuidField}}</span>":'">'+z+"</span>"):p+='<span class="nx-merge" data-field="'+B+(q?'" data-parentfield="'+q:"")+'" data-rowid="{{#SkuidField}}'+z+"{{/SkuidField}}</span>";continue}}p+=z}}var L=c.asText===!0||c.allowHTML===!0||c.nl2br===!1,M=skuid.Mustache.render(p,i),N=L?M:skuid.utils.nl2br(M),O=!0,P=!0;c&&c.createFields===!1&&(P=!1,O=!1),c&&c.registerFields===!1&&(O=!1);var Q=$('<div class="nx-template">'+N+"</div>");return P&&$.each(Q.find(".nx-merge"),function(){var a,b=$(this),c=b.data("field"),d=b.data("parentfield"),f=b.data("parentrowid"),h=b.data("rowid");if(!h&&e&&(h=e.Id),d&&f&&h){var i=g.dataMap[f][d].records;$.each(i,function(b,c){return c.Id==h?(a=c,!1):void 0})}else a=g.dataMap[h];if(c&&a){var j={fieldId:c,editable:!1,register:O};d&&(j.fieldContext=d);var k=new skuid.ui.Field(a,g,null,j);k.render(),l.fields.push(k),b.after(k.element),b.remove()}}),j?Q.text():(l.merges=Q,l)},utils.outerHTML=function(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)};var _requiredFunctions=["then","done","fail"];utils.isPromise=function(a){var b=!0;return $.each(_requiredFunctions,function(c,d){return"function"!=typeof a[d]?(b=!1,!1):void 0}),b},utils.layoutFields=["skuid__Layout__c","skuid__Layout2__c","skuid__Layout3__c","skuid__Layout4__c","skuid__Layout5__c"],utils.writeXmlToPageLayoutFields=function(a,b,c){var d,e=utils.layoutFields;if(d=a?utils.isString(a)?a:""+utils.getXML(a):"",e.length){for(var f,g,h,i,j,k="",l=0,m=0,n=d.length,o=0,p=0,q={};p<e.length&&n>o;){if(f=e[p],g=b.getField(f).length,h=n>=l+g,k=d.substring(l,h?l+g:n),i=!1,h&&k.length&&""!==$.trim(k))for(j=k.length-1;j>-1;j--)if(""===$.trim(k[j]))i=!1;else{if(i){m=j+1;break}i=!0}else m=k.length;b.updateRow(c,f,k.substring(0,m)),l+=m,o+=g,p++}for(;p<e.length;)f=e[p],q[f]=null,p++;if(b.updateRow(c,q),n>o)throw"The total number of characters in this Page's Layout ("+n+") exceeds the maximum number of characters available for each Page ("+o+"). Please split out some of your content into other Pages, and then include these Pages within this Page."}},utils.convertCurrency=function(a,b,c){var d=utils.conversionRates;if(!d||!d.length)return a;var e=utils.conversionRatesMap,f=d[0].IsoCode;if(e||(e=utils.conversionRatesMap={},$.each(d,function(a,b){e[b.IsoCode]=b})),e&&e[b]&&e[c]){var g,h=e[c];if(b!==f){var i=e[b];g=Math.pow(10,6),a=Math.round(a/i.ConversionRate*g)/g}return g=Math.pow(10,6),Math.round(a*h.ConversionRate*g)/g}},utils.getUrlFromAttachmentId=function(a){var b=skuid.page,c=b?b.sitePrefix:!1;return(b&&b.runningOnForceSite&&c?c:"")+"/servlet/servlet.FileDownload?file="+a},utils.makeXMLDoc=function(a){return $($.parseXML(a)).children().first()},utils.getXML=function(a){return a.xml?a.xml:(new XMLSerializer).serializeToString(a)},utils.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},utils.toClass={}.toString,utils.delayInputCallback=function(a,b){var c,d=a.val(),e="change";e+=utils._ie?9===utils._ie?" selectionchange keyup":utils._ie<9?" keyup":" keyup input":" keyup input",a.on(e,function(){if(!a.prop("disabled")){var e=a.val();clearTimeout(c),c=setTimeout(function(){if(e===a.val()&&e!==d){var c=d;d=e,b&&b(e,c)}},400)}})},utils._ie=function(){for(var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a}(),utils.delayEventCallback=function(a){if(a&&a.eventType){var b,c=a.eventType,d=a.delay||400,e=a.callback,f=a.context||$(window);f.on(c,function(){clearTimeout(b),b=setTimeout(function(){e&&e()},d)})}},utils.registerPlugin=function(a,b){$.fn[a]=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void $.error("Method "+c+" does not exist on jQuery."+a):b.init.apply(this,arguments)}},utils.registerBlurHandler=function(a,b){var c=function(d){$(d.target).closest(a).length||($("html").off("click.skuidBlur",c),b())};$("html").on("click.skuidBlur",c)};var _GUID=2;utils.generateGUID=function(){return _GUID++},utils.createMapForArray=function(a,b,c,d){return a&&$.each(a,function(){var a=this;a[c]={},a[b]&&$.each(a[b],function(){var b,e=this;$.each(d instanceof Array?d:[d],function(){if(b=e[this],b&&"undefined"!=b&&(a[c][b]=e,-1!=b.indexOf("."))){for(var d=b.split("."),f=0,g=a[c];f<d.length-1;)d[f]in g||(g[d[f]]={}),g=g[d[f++]];g[d[f]]=e}})})}),a},utils.toArray=function(a){return a instanceof Array?a:[a]},skuid.snippet.registerSnippet("skuid.pages.exportAllPages",function(){var a=50,b=skuid.model.initializeModel(new skuid.model.Model({fields:[{id:"Id"},{id:"Name"},{id:"skuid__Module__c"},{id:"skuid__Type__c"},{id:"skuid__UniqueId__c"},{id:"OwnerId"},{id:"Owner.Name"},{id:"CreatedById"},{id:"CreatedBy.Name"},{id:"CreatedDate"},{id:"LastModifiedById"},{id:"LastModifiedBy.Name"},{id:"LastModifiedDate"},{id:"skuid__Layout__c"},{id:"skuid__Layout2__c"},{id:"skuid__Layout3__c"},{id:"skuid__Layout4__c"},{id:"skuid__Layout5__c"}],data:[],id:"AllPagesForExport",objectName:"skuid__Page__c",orderByClause:"Name",doQuery:!0,recordsLimit:a,canRetrieveMoreRows:!0})),c=skuid.label.read,d=$("<div>").text(c("retrieving_data_for_export"));$.blockUI({message:d}),b.load(function(){b.loadAllRemainingRecords({stepCallback:function(a,b){d.text(skuid.label.merge(c("retrieving_records_a_to_b"),a,b))},finishCallback:function(a){b.exportData({useAPINamesForHeaders:!0}),d.text(skuid.label.merge(c("all_records_exported_to_csv"),a)),setTimeout(function(){$.unblockUI()},1500)}})})}),utils.removeEventSubscriptions=function(a){a&&a.data("eventSubscriptions")&&($.each(a.data("eventSubscriptions"),function(){skuid.events.unsubscribe(this)}),a.removeData("eventSubscriptions"))},utils.conditionallyRender=function(a,b,c,d,e,f){f||(f={});var g=f.context||{},h=c.children("renderconditions"),i=h.attr("logictype"),j=h.attr("logic"),k=h.children(),l=[],m=f.row?f.row:g.row,n=f.model?f.model:g.model,o=!1,p=f.eventSubscriptions=[],q=skuid.events.subscribe,r=function(){return utils.areConditionsMet(l,{row:m,model:n,logicType:i,logic:j})},s=function(g){if(g?f.event=g:"event"in f&&delete f.event,!o){o=!0;var h=d.data("rendered");r()?h||(a(c,d,e,f),d.data("rendered",!0)):h&&(b(c,d,e,f),d.data("rendered",!1)),o=!1}},t={};k.each(function(){var a=new skuid.model.Condition($(this));l.push(a)}),l.length&&(p.push(q("row.updated",function(a){var b,c=t[a.modelId],d=!1;c&&(c.__any?d=!a.modelHadPriorChanges:(b=c[a.rowId],b&&(b.__any?d=!a.rowHadPriorChanges:$.each(b,function(b){return utils.hasObjectProperty(a.updates,b)?(d=!0,!1):void 0})))),d&&s({name:"row.updated",data:a})})),p.push(q("row.created",function(a){a.modelId in t&&s({name:"row.created",data:a})})),p.push(q("row.deleted",function(a){a.modelId in t&&s({name:"row.deleted",data:a})})),p.push(q("row.undeleted",function(a){a.modelId in t&&s({name:"row.undeleted",data:a})})),p.push(q("models.saved",function(a){$.each(t,function(b){return b in a.models?(s({name:"models.saved",data:a}),!1):void 0})})),p.push(q("models.cancelled",function(a){$.each(t,function(b){return b in a.models?(s({name:"models.cancelled",data:a}),!1):void 0})})),p.push(q("models.loaded",function(a){$.each(t,function(b){return b in a.models?(s({name:"models.loaded",data:a}),!1):void 0})})));var u=l.length?r():!0;if(l.length&&$.each(l,function(a,b){var c,d,e=n&&m&&n.id&&(!b.fieldModel||b.fieldModel===n.id),f=e?n.id:b.fieldModel?b.fieldModel:n?n.id:null,g=e?m.Id:b.fieldRow?b.fieldRow:m?m.Id:null,h=b.field;f&&(c=t[f],c||(c=t[f]={}),g&&(d=c[g],d||(d=c[g]={})),"hasChanged"===b.sourceProperty?"modelproperty"===b.sourceType?c.__any=!0:d&&(d.__any=!0):d&&(utils.contains(h,".")&&(h=utils.getReferenceFieldNameFromRelationshipField(h)),d[h]||(d[h]=1)))}),p.length&&d.data("eventSubscriptions",p),u){var v=a(c,d,e,f);return d.data("rendered",!0),v}return d.data("rendered",!1),!1},utils.getHourOptions=function(a,b,c){var d,e=skuid.utils.userLocale.timeFormat,f=e.toLowerCase(),g=f.indexOf("a"),h=f.indexOf("h"),i=[],j=new Date;for(-1!=g&&(e=h>g?"a"+e.charAt(h):e.charAt(h)+"a"),a=a||0,b=b||24,d=a;b>=d;d++)j.setHours(d,0,0,0),i.push({value:d,label:skuid.time.formatTime(e,j),isSelected:c===d});return i},utils.niceExpand=function(a,b,c,d){c=c||0;var e=a.scrollParent(),f=e[0],g=f.scrollTop,h=f.clientHeight,i=g+h,j=a[0].offsetHeight,k=a[0].offsetTop+j-c;if(!d&&$(b).is(":visible"))b.hide();else if(b.show(),k>=i-1){var l=k-h+18;utils._ie||e.animate({scrollTop:l},500)}},utils.scrollTo=function(a,b){b=b||0;var c=a.scrollParent(),d=c[0],e=d.clientHeight,f=a[0].offsetHeight,g=a[0].offsetTop+f-b,h=g-e+18;utils._ie||c.animate({scrollTop:h},500)},utils.addResizeHandler=function(a,b){utils.delayEventCallback({eventType:"resize orientationchange",delay:b,callback:a})},utils.SelectList=SelectList,utils.SelectItem=SelectItem,utils.FileUploader=FileUploader,utils.FileComponent=FileComponent,utils.TemplateComponent=TemplateComponent}(skuid),function(a){function b(){return"ontouchstart"in window||"onmsgesturechange"in window}function c(b,c){var d=this,e=[];d.options=l.extend({showHeader:!0,showMessages:!0},c),d._GUID=n.generateGUID(),d.models=[],d.lists=[],b&&(d.element=b.addClass("nx-editor"+(a.mobile?"":" ui-widget")),d.options.showHeader&&(d.header=l("<div>").addClass("nx-editor-header"),d.submitwrapper=l("<div>").addClass("nx-header-"+(d.options.buttonPosition||"right")).appendTo(d.header),d.status=l('<div class="nx-actionselect nx-status">').appendTo(d.header).hide(),d.statustext=l('<div class="nx-actionselect-text"></div>').appendTo(d.status),e.push(d.header)),d.options.showMessages&&(d.messages=l('<div class="nx-messages">'),e.push(d.messages)),d.contents=l("<div>").addClass("nx-editor-contents"),e.push(d.contents),d.element.append(e))}function d(b,c,d){var e=this;e._GUID=n.generateGUID(),e.editor=b,e.model=c,e.options=d||{},e.views=d.views,e.mode=d.mode,e.conditions=d.conditions,e.visibleItems=[],e.currentView=!1;var f;if(e.views&&(f=Object.keys(e.views)),f&&(e.currentView=f[0]),f&&f.length>1){var g=l.cookie("nx-list-view-"+a.page.name+"-"+this.model.id);l.each(e.views,function(a){return a===g?(e.currentView=a,!1):void 0}),e.editor.header.append(e.makeViewSwitcher())}if(e.element=!1,e.contents=!1,e.conditionsBar=l("<div>").addClass("left"===e.editor.options.buttonPosition?"nx-conditioncontainer-left":"nx-conditioncontainer"),e.searchBox=!1,e.searchFields=d.searchFields||[],e.searchSubFields=d.searchSubFields||{},e.searchFieldsMap={},e.searchSubFieldsMap={},e.filters=[],e.searchFields&&e.searchFields.length){var h=e.searchFields;e.searchFields=[],l.each(h,function(a,b){e.addSearchField(b)})}if(e.searchSubFields&&a.utils.size(e.searchSubFields)>=1){var i=e.searchSubFields;e.searchSubFields={},l.each(i,function(a,b){l.each(b,function(b,c){e.addSearchSubField(a,c)})})}e.customFilter=d.customFilter||!1,e.customFilterValue=d.customFilterValue||"",e.searchMethod=d.searchMethod||"server",e.searchConditionName=d.searchConditionName||e._GUID+"_searchbox",e.searchPlaceholderText=d.searchPlaceholderText||null;var j=d.requiredFields;e.requiredFields=j&&n.size(j)?j:{},e.footer=l("<div>").addClass("nx-list-footer"),e.footerleft=l("<div>").addClass("nx-list-footer-left").appendTo(e.footer),e.footercenter=l("<div>").addClass("nx-list-footer-center").appendTo(e.footer),e.footerright=l("<div>").addClass("nx-list-footer-right").appendTo(e.footer),e.currentPage=0;var k=d.pageSize;k&&("all"!=k?(d.pageSize=parseInt(d.pageSize,10),e.currentPageSize=parseInt(l.cookie("nx-page-"+a.page.id+"-"+this.model.id+"-ps"),10)||d.pageSize):e.currentPageSize="all"),e.editor.registerList(e),e.makeConditionsBar(),e.editor&&e.editor.header&&(e.editor.header["left"===e.editor.options.buttonPosition?"prepend":"append"](e.conditionsBar),e.options.showSearchBox&&e.searchBox===!1&&(e.searchBox=e.makeSearchBox(),e.searchBox&&e.editor.submitwrapper.append(e.searchBox)),e.options.delayFilterExecution&&(e.applyFiltersBtn=l("<div>").addClass("sk-button-applyfilter").text(t("apply")).skooButton({icon:"sk-icon-search-go",disabled:!1,hoverText:t("apply")}).hide().on("click",function(){e.applyFiltersAndSearch()}),e.cancelFiltersBtn=l("<div>").addClass("sk-button-cancelfilter").text(t("cancel")).skooButton({icon:"sk-icon-cancel",disabled:!1,hoverText:t("cancel")}).hide().on("click",function(){e.cancelFiltersAndSearch()}),e.editor.submitwrapper.append(e.applyFiltersBtn,e.cancelFiltersBtn))),e.renderedItems={}}function e(a,b,c){var d=this;d._GUID=n.generateGUID(),d.list=a,d.row=b,d.defaultMode=c.mode||"read",d.mode=d.defaultMode,d.deleted=!1,d.selected=c.selected||!1,d.element=!1,d.fields=[],a.options.responsive&&d.element.addClass("sm-grid-division"),a&&a.model&&a.model.registerItem(d)}function f(b,c,d,e){var f=this;f._GUID=n.generateGUID(),f.row=b,f.model=c,f.editor=d,f.options=e||{},f.id=e.fieldId,f.name=e.fieldName,f.context=e.fieldContext,f.id&&(f.metadata=f.model.getField(f.name?f.name:f.id,f.context));var g=f.metadata;f.options.label?f.label=f.options.label:g&&(f.label=g.label),f.required=f.options.required||g&&g.required?!0:!1,f.mode=e.mode||"read",f.element=l("<div>").addClass("nx-field").attr("data-uid",f._GUID),e.additionalClass&&f.element.addClass(e.additionalClass),f.element.data("object",f),f.editable=(!g||a.model.isNewId(b.Id)&&g.createable||g.editable)&&f.options.editable!==!1&&"readonly"!==f.mode,f.options.register&&f.model.registerField(f);var h=e.controllingFields;if(g&&("PICKLIST"===g.displaytype||"MULTIPICKLIST"===g.displaytype)){var i=g.controllingField,j=f.model.getField("RecordTypeId");h||(e.controllingFields=h=[]),j&&h.push(j.id),i&&h.push(i)}h&&h.length&&l.each(h,function(){var a=this;-1!==a.indexOf(".")&&(a=a.split(".")[0]),f.model.registerField(f,a)})}function g(b){b||(b={});var c,d,e,f,h,i,j,k=b.xml,m=b.list,u=b.element||l("<div>"),v=this,w=k.attr("condition"),x=v.type=k.attr("type"),y=!1,z=[],B=m?m.options.delayFilterExecution:!1,C=k.attr("labelmode");C||"daterange"!==x||(C="auto"),v.affectCookies="false"!==k.attr("affectcookies"),v.isReferenceFilter=!1,v.element=u.addClass("nx-conditiontoken"),v.list=m,v.model=m.model,v.filterCondition,v.affectedConditions={},w&&(v.filterCondition=v.model.getConditionByName(w,!0),!c&&v.filterCondition&&(c=v.model.getField(v.filterCondition.field))),v.filterCondition&&(v.affectedConditions[w]=v.filterCondition),k.find("effect").each(function(){var a=l(this),b=a.attr("condition"),c=m.model.getConditionByName(b,!0);c&&(v.affectedConditions[b]=c)});var D=function(a){var b=v.filterCondition;return b&&!b.inactive?v.isMultiselect?l.inArray(a,b.values)>-1:a===b.value:!1};if("select"===x||"multiselect"===x){v.isMultiselect="multiselect"===x;var E,F,G="auto"===k.attr("conditionsource");if(G){if(E=k.attr("conditionfield"),!E)return;if(c=v.model.getField(E),"REFERENCE"===c.displaytype&&(v.isReferenceFilter=!0),w="__autofilter__"+E,v.filterCondition=F=v.model.getConditionByName(w,!0),F){if(F&&v.isReferenceFilter&&F.inactive!==!0){var H,I=[],J=v.isMultiselect&&F.values,K={};J?l.each(F.values,function(a,b){I.push(b)}):F.value&&I.push(F.value),I.length&&(l.each(I,function(a,b){var c,d,e=b.substring(0,3),f=K[e],g=v.model.getField(F.field),h=g.referenceTo;f||(l.each(h,function(a,b){return b.keyPrefix===e?(c=b,d=b.objectName,!1):void 0}),f=K[e]={objectType:d,fields:[n.getNameField(d)],records:[]}),f.records.push(b)}),H=a.data.get(K),H.isComplete?(l.each(I,function(a,b){var c=b.substring(0,3),d=H.data[c],e=d?d[b]:!1,f=K[c].fields[0];z.push({label:e?e.record[f]:"Invalid record",value:b,isSelected:!0})}),J||(y=!0)):(l.each(I,function(a,b){z.push({label:"Loading...",value:b,isSelected:!0})}),J||(y=!0),l.when(H.promise).done(function(){u.empty(),new g({element:u,xml:k,list:m})})))}}else{v.filterCondition=F=new a.model.Condition;var L=k.attr("conditionoperator");L||(L=v.isMultiselect?"MULTIPICKLIST"===c.displaytype?"includes":"in":"="),F.operator=L,F.field=E,F.inactive=!0,F.name=w,F.encloseValueInQuotes=!0,F.originalValue="",F.value="",F.originalInactive=!0,v.model.addCondition(F)}v.affectedConditions[w]=F}var M;("true"===k.attr("createfilteroffoption")||G)&&(M=n.mergeAsText("global",k.attr("filteroffoptionlabel")||"",{createFields:!0,registerFields:!1}),v.isMultiselect||v.isReferenceFilter||(this.filterCondition&&this.filterCondition.value===this.filterCondition.originalValue&&(y=!0),this.filterCondition||(y=!0),z.push({label:M,value:"__reset",affectDefaultCondition:!0,isSelected:y})));var N=k.children("sources").first();if(!G||N.length&&N.children().length||(N.length||(N=n.makeXMLDoc("<sources/>")),N.append(n.makeXMLDoc('<source type="metadata"/>'))),N.children().each(function(){var b,d=l(this),e=d.attr("effectsbehavior"),f={};if(("defaultandothers"===e||"justothers"===e)&&(b=d.children("effects").children(),b.length&&(f.effects=b)),"manual"===d.attr("type"))d.children("options").children().each(function(){var a,b,c=l(this);if("simple"===c.attr("type")&&v.filterCondition){var d=c.attr("value");"undefined"==typeof d&&(d=""),b=D(d),a={label:n.mergeAsText("global",c.attr("label")||d||"",{createFields:!0,registerFields:!1}),value:n.mergeAsText("global",d||"",{createFields:!1,registerFields:!1}),isSelected:b,affectDefaultCondition:!0,source:f},b&&(y=!0)}else if("complex"===c.attr("type")){var e=c.children("effects").children();b=v.isSelectedFromEffects(e),a={label:n.mergeAsText("global",c.attr("label")||"",{createFields:!0,registerFields:!1}),effects:e,value:"",isSelected:b,source:f},b&&(y=!0)}a&&z.push(a)});else{var g="justothers"!==d.attr("effectsbehavior");if("model"===d.attr("type")){var h=a.model.getModel(d.attr("model")),i=d.children("labeltemplate").text(),j=d.children("valuetemplate").text();h&&(f.model=h,l.each(h.data,function(a,b){var c=n.mergeAsText("row",i||"{{{"+n.getNameField(h.objectName)+"}}}",{createFields:!0,registerFields:!1},h,b),d=n.mergeAsText("row",j||"{{{Id}}}",{createFields:!1,registerFields:!1},h,b),e=D(d);z.push({label:c,value:d,isSelected:e,affectDefaultCondition:g,source:f,row:b}),e&&(y=!0)}))}else if("metadata"===d.attr("type")){if(v.filterCondition){var k=c,m=n.mergeAsText("model",d.attr("prefix")||"",{createFields:!0,registerFields:!1},v.model),o=n.mergeAsText("model",d.attr("suffix")||"",{createFields:!0,registerFields:!1},v.model);k&&(k.picklistEntries&&k.picklistEntries.length?l.each(k.picklistEntries,function(a,b){var c=D(b.value),d=b.label?b.label:b.value;z.push({label:m+d+o,value:b.value,isSelected:c,affectDefaultCondition:g,source:f}),c&&(y=!0)}):v.model.recordTypeInfos&&v.model.recordTypeInfos.length&&a.utils.endsWith(k.id,"RecordTypeId")&&l.each(v.model.recordTypeInfos,function(b,c){if(c.isAvailable&&(1===v.model.recordTypeInfos.length||!a.utils.endsWith(c.recordTypeId,"AAA"))){var d=c.recordTypeId,e=D(d);z.push({label:m+c.name+o,value:d,isSelected:e,affectDefaultCondition:g,source:f}),e&&(y=!0)}}))}}else if("custom"===d.attr("type")){var p=d.attr("snippet");if(p){var q=a.snippet.getSnippet(p);q&&l.each(q({list:v,model:v.model}),function(a,b){var c=l("<div>").append(b.label?v.model.mergeModel(b.label):""),d=D(b.value);z.push({label:c.text(),value:b.value,isSelected:d,affectDefaultCondition:g,source:f}),d&&(y=!0)})}}}}),y||v.isMultiselect||v.isReferenceFilter||z.push({label:" - - - - ",value:"",isSelected:!0}),v.activateFilter=function(){v.isMultiselect||v.isReferenceFilter?(v.resetAffectedConditions(),v.isReferenceFilter?(l.each(v.affectedConditions,function(){this.values=[]}),z=l.map(v.element.actionAutocomplete("getSelectedItems"),function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a})):v.setOriginalValue(v.element.val()),z.length&&l.each(z,function(){this.isSelected?v.applyFilterForItem(this):v.unApplyFilterForItem(this)})):v.selectedItem&&(v.resetAffectedConditions(),v.applyFilterForItem(v.selectedItem),v.setOriginalValue(v.selectedItem))},v.isMultiselect&&!v.isReferenceFilter){var O=!1,P=l.map(z,function(a){return a.isSelected?(O=!0,a.value):void 0}).join(";"),Q=function(){var a=v.element.data("multiselect-newvalues"),b=v.element.data("multiselect-oldvalues");if(v.model.hasChanged===!1){var c={};a&&l.each(a.split(";"),function(){c[this]=1}),l.each(z,function(a,b){b.isSelected=b.value in c}),B?(b||(b="__reset"),v.setOriginalValue(b),v.list.showFilterActions()):(v.activateFilter(),v.executeFilter())}},R=function(){v.restoreOriginalValue()};v.setOriginalValue(O?P:"__reset"),a.ui.renderers.MULTIPICKLIST.edit({position:{my:"right top",at:"right bottom"},element:v.element.addClass("nx-actionselect"),entries:z,value:P,selectedText:c?c.label+": "+t("number_selected"):null,selectedList:3,noneSelectedText:M,onChange:function(a,b){v.element.data({"multiselect-newvalues":a,"multiselect-oldvalues":b}),B&&Q()},onClose:function(){0!==v.model.isProcessing||B||R()},onCreate:function(){var a=l(this),b=a.multiselect("widget");B||b.append(l("<div>").addClass("ui-widget-footer ui-multiselect-footer ui-helper-clearfix").append(l("<div>").text(t("apply")).addClass("sk-timefilter-button").css("cursor","pointer").on("click",function(){Q(),a.multiselect("close")}),l("<div>").text(t("cancel")).addClass("sk-timefilter-button-grey").css("cursor","pointer").on("click",function(){R(),a.multiselect("close")})))}}),v.element.find(".ui-multiselect").append('<div class="nx-actionselect-arrow"><div/></div>')}else{var S=function(a){if(v.model.hasChanged===!1){var b=v.selectedItem;v.selectedItem=a,B?(v.isReferenceFilter?(l.each(v.affectedConditions,function(){this.values=[]}),v.setOriginalValue(l.map(z,function(a){return a.value}).join(";")),z=l.map(v.element.list.items,function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a})):v.setOriginalValue(b),v.list.showFilterActions()):(v.activateFilter(),v.executeFilter())}},T=parseInt(k.attr("autocompthreshold"),10);c&&v.isReferenceFilter?v.element.actionAutocomplete({refField:c,items:z,onItemSelect:S,isMultiselect:v.isMultiselect,defaultOptionLabel:M}):z.length<(T?T:25)?v.element.actionSelect({items:z,onItemSelect:S}):v.element.actionAutocomplete({items:z,onItemSelect:S})}}else if("toggle"===x){var U=k.children("effects").children(),V=v.isSelectedFromEffects(U);V||v.element.addClass("disabled"),v.activateFilter=function(){if(v.model.hasChanged===!1&&v.selectedItem){var a=v.element.is(".disabled");v.resetAffectedConditions(),a?v.unApplyFilterForItem(v.selectedItem):v.applyFilterForItem(v.selectedItem),v.setOriginalValue(a)}},v.element.actionSelect({items:[{label:n.mergeAsText("model",k.attr("label")||"",{createFields:!0,registerFields:!1},v.model),effects:U,value:"",isSelected:V}],onItemSelect:function(a){var b=v.element.is(".disabled");
v.element.toggleClass("disabled"),v.selectedItem=a,B?(v.setOriginalValue(b),v.list.showFilterActions()):(v.activateFilter(),v.executeFilter())}})}else if("daterange"===x){var W,X,Y,Z=k.attr("startcondition"),$=k.attr("endcondition");if(Z&&$&&"auto"!==k.attr("conditionsource"))W=v.model.getConditionByName(Z,!0),X=v.model.getConditionByName($,!0);else if(Y=k.attr("conditionfield"),Z="__autofilter__start__"+Y,$="__autofilter__end__"+Y,W=v.model.getConditionByName(Z,!0),X=v.model.getConditionByName($,!0),!W||!X){if(!Y)return!1;W=new a.model.Condition,W.operator="gte",W.field=Y,W.inactive=!0,W.name=Z,W.encloseValueInQuotes=!1,X=new a.model.Condition,X.operator="lte",X.field=Y,X.inactive=!0,X.name=$,X.encloseValueInQuotes=!1,v.model.addCondition(W),v.model.addCondition(X)}if(d=v.model.getField(W.field),e=v.model.getField(X.field),!d||!e)return!1;var _,ab,bb=d.displaytype,cb=e.displaytype;W.inactive?_="":"DATETIME"===bb?(i=q(W.value),_=r(i)):(i=p(W.value),_=W.value),X.inactive?ab="":"DATETIME"===cb?(j=q(X.value),j.setDate(j.getDate()-1),ab=r(j)):(j=p(X.value),ab=X.value);var db=function(){eb.datepicker("getDate")||fb.datepicker("getDate")?pb.show():pb.hide()},eb=A.DATE.edit({value:_,onChange:db}).addClass("sk-timefilter-input"),fb=A.DATE.edit({value:ab,onChange:db}).addClass("sk-timefilter-input");v.element.addClass("nx-actionselect nx-conditiontoken");var gb,hb,ib=l("<div>"),jb=l("<div>").addClass("nx-actionselect-text").append(ib),kb=l("<div>").addClass("nx-actionselect-arrow").append(l("<div>")),lb=l("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),mb=l("<div>").text(t("start_date")).addClass("sk-timefilter-label"),nb=l("<div>").text(t("end_date")).addClass("sk-timefilter-label"),ob=l("<div>"),pb=l("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter");pb.click(function(){eb.datepicker("setDate",null),fb.datepicker("setDate",null),db()}),B?(hb=l("<div>").text(t("done")).addClass("sk-timefilter-button"),ob.append(hb)):(gb=l("<div>").text(t("cancel")).addClass("sk-timefilter-button-grey"),hb=l("<div>").text(t("apply")).addClass("sk-timefilter-button"),ob.append(hb,gb)),v.updateDisplayValue=function(b,c){var d,e=o.makeFormattedDateFromJS,f=a.label.merge;return d=b&&c?e(b)+" - "+e(c):b&&!c?f(t("after_this"),e(b)):!b&&c?f(t("before_this"),e(c)):t("all_time"),ib.text(d),eb.datepicker("setDate",b),fb.datepicker("setDate",c),db(),v},v.updateDisplayValue(i,j),gb&&gb.click(function(){lb.hide("fast")}),v.activateFilter=function(){var a,b,c=eb.datepicker("getDate"),d=fb.datepicker("getDate");if(c&&(a=r(c)),d&&(b=r(d)),a?("DATETIME"===bb&&(a=s(p(a))),v.model.setCondition(W,a,v.affectCookies)):v.model.deactivateCondition(W,v.affectCookies),b){if("DATETIME"===cb){var e=p(b);e.setDate(e.getDate()-0+1),b=s(e)}v.model.setCondition(X,b,v.affectCookies)}else v.model.deactivateCondition(X,v.affectCookies);v.setOriginalValue({start:c,end:d})},hb.click(function(){var a=eb.datepicker("getDate"),b=fb.datepicker("getDate");B?v.list.showFilterActions():(v.activateFilter(),v.executeFilter()),v.updateDisplayValue(a,b),lb.hide("fast")}),lb.append(mb,eb,nb,fb,pb,ob),v.element.addClass("nx-actionselect-haslabel").append(jb,kb,lb),jb.add(kb).click(function(){lb.is(":visible")?lb.toggle("fast"):(lb.css("min-width",Math.max(v.element.width(),180)+"px"),lb.show("fast"))})}"toggle"===x||"auto"!==C&&"manual"!==C||(h=l("<div>").addClass("nx-actionselect-label"),"auto"===C?"daterange"===x?f=d.label:c&&(f=c.label):"manual"===C&&(f=k.attr("label"),f&&(f=n.mergeAsTextInContext(f,{model:v.model}))),f&&(h.text(f),v.element.addClass("nx-actionselect-haslabel").prepend(h))),v.selectedItem||v.isMultiselect||(c&&v.isReferenceFilter?v.selectedItem=v.element.actionAutocomplete("getSelectedItem"):"daterange"===x?v.setOriginalValue({start:i,end:j}):v.selectedItem=v.element.actionSelect("getSelectedItem"))}function h(a){a=a||{};var b=this,e=a.grandparent,f=a.parent,g=a.model,h=a.element;b.model=g,e.css({overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"}),f.css({position:"relative","padding-left":"0px","padding-right":"0px",height:"100%"}),b.element=h.addClass("nx-queue").data("object",b).appendTo(f);var i=a.title?n.mergeAsText("model",a.title,{createFields:!0,registerFields:!1},g):"";b.header=l("<div>").addClass("nx-queue-header").attr({"aria-controls":h.prop("id")}),b.headerInner=l("<div>").addClass("nx-queue-header-inner").appendTo(b.header),b.titleBar=l("<div>").addClass("nx-queue-titlebar").appendTo(b.headerInner),(a.showSearchBox===!0||a.filtersXML&&a.filtersXML.children&&a.filtersXML.children().length>0)&&(b.titleIcon=l("<div>").addClass("ui-icon ui-icon-gear nx-queue-titleicon").on("click",function(){b.settingsBar.toggle(),b.element.css("border-top",b.header.height()+2+"px solid white")}).appendTo(b.titleBar)),b.titleText=l("<div>").text(i).addClass("nx-queue-titletext").appendTo(b.titleBar),b.settingsBar=l("<div>").addClass("nx-queue-settings").hide().appendTo(b.headerInner),f.append(b.element,b.header),b.editor=new c(b.element,{showSaveCancel:!1,buttonPosition:"block"});var j={};j.render=function(c){c.element.addClass("nx-queue-item");var d=l("<div>").addClass("nx-queue-item-inner").appendTo(c.element);a.tagRenderer&&a.tagRenderer(b.model,b.list,c,d)},b.views={standard:j},b.list=new d(b.editor,b.model,{views:b.views,listFilters:a.filtersXML,conditions:a.editorConditions,showSearchBox:a.showSearchBox,useSOSLSearch:a.useSOSLSearch,SOSLFields:a.SOSLFields,searchMethod:a.searchMethod||"server",searchConditionName:a.searchConditionName,tokenizeSearch:"undefined"!=typeof a.tokenizeSearch?a.tokenizeSearch:!0,searchPlaceholderText:a.searchPlaceholderText,delayFilterExecution:a.delayFilterExecution}),b.model.registerList(b.list),b.list.render(),b.list.attach();var k=this.list.editor.header;k.detach().appendTo(b.settingsBar),b.element.on("click.skuid",".nx-queue-item",function(b){var c=l(this).data("object");a.tagClickAction&&a.tagClickAction(c),b.stopPropagation()})}function i(a,b){b||(b={});var c=b.mode||"edit",d=l("<div>").addClass("nx-editor-contents nx-basicfieldeditor-section-body");return l.each(a,function(a,e){var f=l("<div>").addClass("nx-basicfieldeditor-item"),g=l("<div>").addClass("nx-basicfieldeditor-item-label").text(e.metadata.label).appendTo(f);e.mode=c,e.editable=e.metadata.editable,e.editor=b.editor,e.wrapperElement=f,e.labelElement=g,e.render(),f.append(e.element),d.append(f)}),d}function j(a,b,c){a&&(a.css("opacity",1).show(),b.text(c))}function k(a,b,c,d){a&&(b.text(c),0===d?a.hide():a.animate({opacity:"0"},d||500,function(){a.hide()}))}var l=a.$,m=a.ui={},n=a.utils,o=a.time,p=o.parseSFDate,q=o.parseSFDateTime,r=o.getSFDate,s=o.getSFDateTime,t=a.label.read,u=n.encodeHTML,v=n.decodeHTML,w=window.sforce&&sforce.one?sforce.one:!1,x=window.sforce&&sforce.console&&sforce.console.isInConsole()?sforce.console:!1;c.prototype.id=function(){return this._GUID},c.prototype.registerModel=function(a){var b=this,c=!a.hasChanged;b.models.push(a),a.registerEditor(b),b.options.showSaveCancel&&!b.submitbuttons&&(b.savebutton=l("<div>").addClass("sk-button-save").text(t("save")).skooButton({icon:"sk-icon-save",disabled:c}),b.cancelbutton=l("<div>").addClass("nx-button-secondary sk-button-cancel").text(t("cancel")).skooButton({icon:"sk-icon-cancel",disabled:c}),b.savebutton.on("click.skuid",function(){l(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable"),b.save()}),b.cancelbutton.on("click.skuid",function(){l(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable"),b.cancel()}),b.submitbuttons=b.savebutton.add(b.cancelbutton),b.submitwrapper.append(b.savebutton,b.cancelbutton))},c.prototype.registerList=function(a){this.lists.push(a),this.registerModel(a.model)},c.prototype.unregister=function(){var a=this;return a.lists&&a.lists.length&&l.each(a.lists,function(){this.unregister&&this.unregister()}),a.models&&a.models.length&&l.each(a.models,function(){this.unregisterEditor(a)}),a},c.prototype.hasModelWithChanges=function(){var a=this,b=!1;return l.each(a.models,function(){return this.hasChanged?(b=!0,!0):void 0}),b},c.prototype.handleChange=function(){var a=this;a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("enable"),a.lists.length&&l.each(a.lists,function(a,b){b.disableFiltersAndSearch()})},c.prototype.clearMessages=function(){this.messages&&this.messages.empty()},c.prototype.handleMessages=function(a,b){var c=this;return c.messages?b&&b.initiatorId&&c._GUID!==b.initiatorId?!1:void l.each(a,function(a,b){var d="nx-message";"ERROR"===b.severity||"FATAL"===b.severity?d="nx-error":"WARNING"===b.severity&&(d="nx-warning");var e;try{e=c.messages.children("."+d).filter(":contains('"+n.escapeSelector(b.message)+"')")}catch(f){}if(e&&e.length)if(e.data("dupcount")){var g=parseInt(e.data("dupcount"),10)+1;e.children(".nx-dupcounter").text(g),e.data("dupcount",g)}else e.data("dupcount",2),e.prepend('<div class="nx-dupcounter" style="">2</div>');else{var h=l("<div>").addClass(d);h.append("DUPLICATE_VALUE"===b.status?b.message:l("<div>").text(v(b.message))),h.on("click.skuid",function(){l(this).remove()}),c.messages.append(h)}}):!1},c.prototype.handleCancel=function(){var a=this,b=!1,c={};l.each(a.models,function(a,d){d.hasChanged&&(b=!0,c[d.id]=!0)}),b===!1&&(a.clearMessages(),a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("disable")),a.lists.length&&l.each(a.lists,function(a,b){!b.model||b.model.id in c||b.enableFiltersAndSearch()})},c.prototype.handleSave=function(a){var b=!1,c={},d=this;l.each(d.models,function(a,d){d.hasChanged&&(b=!0,c[d.id]=!0)}),a?d.hideStatus(t("saved")):d.hideStatus("",0),d.clearMessages(),a&&!b&&d.submitbuttons&&d.submitbuttons.filter(".ui-button").button("disable"),!a&&b&&d.submitbuttons&&d.submitbuttons.filter(".ui-button").button("enable"),d.lists.length&&l.each(d.lists,function(a,b){!b.model||b.model.id in c||b.enableFiltersAndSearch()})},c.prototype.cancel=function(){a.model.cancel(this.models,{initiatorId:this._GUID})},c.prototype.save=function(b){b=b||{};var c="rollbackOnAnyError";!(c in b)&&c in this.options&&(b[c]=this.options[c]),this.setStatus(t("saving")),b.initiatorId=this._GUID,a.model.save(this.models,b)},c.prototype.setStatus=function(b){a.ui.setStatus(this.status,this.statustext,b)},c.prototype.hideStatus=function(b,c){a.ui.hideStatus(this.status,this.statustext,b,c)},c.prototype._createConditionsFromXml=function(a,b){return b&&a?b.createConditionsFromXml(a):void 0},d.prototype.id=function(){return this._GUID},d.prototype.unregister=function(){var b=this;return b.model&&b.model.unregisterList(b),b.renderedItems&&l.each(b.renderedItems,function(){this.unregister&&this.unregister()}),b.options.responsive&&a.responsive.unregisterGrid(b.id()),b},d.prototype.getSelectedItems=function(){var a=[];return l.each(this.renderedItems,function(b,c){c.selected&&a.push(c)}),a},d.prototype.unSelectAll=function(){l.each(this.renderedItems,function(a,b){b.selected&&(b.selected=!1)})},d.prototype.addSearchField=function(a,b){var c=this;if(a){var d,e=c.model.getField(a.id),f=e.displaytype;f in m.searchableDisplayTypes&&e.filterable&&(e.id in c.searchFieldsMap||(d=l.extend({},e),b&&(d.searchOperator=b),c.searchFields.push(d),c.searchFieldsMap[e.id]=d))}},d.prototype.addSearchSubField=function(a,b){var c=this;if("object"==typeof b&&(b=b.id),a&&b){var d=c.model.getField(b,a),e=d.displaytype;if(e in m.searchableDisplayTypes&&d.filterable){var f=c.searchSubFieldsMap[a],g=c.searchSubFields[a];f||(f=c.searchSubFieldsMap[a]={},g=c.searchSubFields[a]=[]),d.id in f||(f[d.id]=1,g.push(d))}}},d.prototype.addRequiredField=function(a){this.requiredFields[a.id]=a},d.prototype.removeRequiredField=function(a){delete this.requiredFields[a.id]},d.prototype.validateRequiredFields=function(){var a=this,b=[],c=a.model,d=a.requiredFields;return l.each(c.changes,function(e,f){if(!("__deleted"in f)){var g={severity:"ERROR",status:"REQUIRED_FIELD_MISSING",fields:[]},h=c.getRowById(e),i="",j=!1;h&&h.Id in a.renderedItems&&l.each(d,function(a,b){var d=c.getFieldValue(h,a,!0),e=(""===d||null===d)&&"BOOLEAN"!==b.displaytype;e&&(i&&(i+=", "),i+="["+b.label+"]",g.fields.push(b.label),j=!0)}),j&&(g.message=t("required_fields_have_no_value")+" "+i,b.push(g))}}),b},d.prototype.getView=function(a){return a||(a=this.currentView),this.views[a]},d.prototype.setUp=function(a){this.callViewOperation("setUp",a)},d.prototype.beforeRender=function(a){this.callViewOperation("beforeRender",a)},d.prototype.renderComplete=function(a){this.callViewOperation("renderComplete",a)},d.prototype.tearDown=function(a){this.callViewOperation("tearDown",a)},d.prototype.callViewOperation=function(a,b){b||(b=this.getView()),b&&a&&a in b&&b[a](this)},d.prototype.getAllRows=function(){var a,b,c=this;return c.conditions?a=n.filterRowsByConditions(c.model.data,c.conditions):(a=[],c.model.data&&c.model.data.length&&l.each(c.model.data,function(b,c){a.push(c)})),c.customFilter&&c.customFilterValue&&(b=[],l.each(a,function(){c.customFilter(c.customFilterValue,this)&&b.push(this)}),a=b),a},d.prototype.render=function(b){b=b||{};var c,d,e=this,f=e.options,g=[],h=b.previousView||!1,i=h&&h!==e.currentView,j=e.getView(),k=!e.element||b.doNotCache||j.alwaysFullRender,m=b.changedRows;j.alwaysFullRender&&(b.doNotCache=!0),i&&(h=e.getView(h),h&&e.tearDown(h)),b.resetPagination&&(e.currentPage=0),d=e.getAllRows();var n=d.length,o=e.currentPageSize,p=0,q=n;if(e.footer&&(e.footerleft.empty(),e.footercenter.empty(),e.footerright.empty()),(!e.element||i)&&(e.element&&e.element.remove(),e.element=l("<"+(j.nodeType||"div")+">").addClass("nx-list"),c=e.contents=l("<"+(j.contentsNodeType||"div")+">").addClass("nx-list-contents").appendTo(e.element),f.responsive&&a.responsive.registerGrid(e.id(),c.addClass("sm-grid").data({precision:f.gridPrecision||4,minwidth:f.gridMinWidth||300,layoutmode:"rigid"})),e.setUp(j)),o&&"all"!=o&&n>o){e.currentPage<0&&(e.currentPage=0);var r=Math.ceil(n/o);e.currentPage>r-1&&(e.currentPage=r-1),p=o*e.currentPage,q=o*(e.currentPage-0+1),e.currentPage==r-1&&(q=n),d=d.slice(p,q);var s=l("<div>").addClass("nx-buttonset"),u=l("<div>").addClass("first").text(t("first")).button(),v=l("<div>").addClass("prev").text(t("previous")).button(),w=l("<div>").addClass("next").text(t("next")).button(),x=l("<div>").addClass("last").text(t("last")).button(),y=e.currentPage<r-3?e.currentPage-2:r-5,z=e.currentPage>2?e.currentPage+2:4;s.append(u,v);for(var A=y;z>=A;A++)if(A>=0&&r>A){var B=l("<div>").text(A-0+1).attr("data-pn",A).button();A===e.currentPage&&B.addClass("nx-button-selected"),s.append(B)}s.append(w,x).buttonset(),s.children().filter('[data-pn="'+e.currentPage+'"]').button("disable"),0===e.currentPage?(u.button("disable"),v.button("disable")):e.currentPage==r-1&&(x.button("disable"),w.button("disable")),this.footerright.append(s),s.on("click",".ui-button",function(){var a=l(this);a.is(".first")?e.goToPage(0):a.is(".prev")?e.prevPage():a.is(".next")?e.nextPage():e.goToPage(a.is(".last")?r-1:parseInt(a.data("pn"),10))})}if(o&&"all"!=o&&n){var C=[5,10,25,50];-1==C.indexOf(e.options.pageSize)&&C.push(e.options.pageSize),-1==C.indexOf(e.currentPageSize)&&C.push(e.currentPageSize);var D=function(a,b){return a-b};C.sort(D);for(var E=l("<select>"),F=0;F<C.length;F++)E.append('<option value="'+C[F]+'">'+C[F]+"</option>");E.children().filter('[value="'+o+'"]').attr("selected","selected"),E.change(function(){l.cookie("nx-page-"+a.page.id+"-"+e.model.id+"-ps",l(this).val()),e.currentPageSize=parseInt(l(this).val(),10),e.render()});var G=l("<span>");G.append("<span>"+t("show")+" </span>",E,"<span> "+a.label.merge(t("objects_per_page"),e.model.labelPlural)+"</span>"),this.footerleft.append(G)}var H=t("pagination_limit_reached"),I=e.model.debug===H,J=e.model.canRetrieveMoreRows===!0;if(n){var K=n+"";J&&(K+="+"),this.footercenter.append("<span>"+a.label.merge(t("showing_rows"),p+1,q,K)+(I?" ("+H+")":"")+"</span>")}if(J&&!I){var L=l('<div class="nx-list-loadmore">').text(t("load_more"));L.on("click.skuid",function(){e.blockUI({message:t("loading")}),e.model.loadNextOffsetPage(function(){e.unblockUI()})}),this.footerleft.append(L)}n||this.footercenter.append("<span>"+a.label.merge(t("no_objects_to_display"),e.model.labelPlural)+"</span>").css("line-height","25px"),b.doNotCache&&(l.each(e.renderedItems,function(a,b){b&&b.destroy()}),e.renderedItems={},e.makeConditionsBar()),e.beforeRender(j),e.visibleItems=[],b.destroyDeletedRows===!0&&l.each(e.renderedItems,function(a,b){!b||a in e.model.dataMap&&!(b.row&&"__deleted"in b.row)||(b.destroy(),delete e.renderedItems[a])}),l.each(d,function(){var a=this,c=e.renderedItems[a.Id];c&&!b.doNotCache?(b.resetItemModes===!0&&c.resetMode(),b.refreshFields!==!1&&(m&&m[a.Id]?c.refreshFields(m[a.Id]):c.refreshFields())):c=e.newItem(this,b),"__notdeleted"in this&&c.element.removeClass("deleted"),"__deleted"in this?c.element.addClass("deleted"):c.element.removeClass("deleted"),g.push(c.element),e.visibleItems.push(c)}),j.noAutoAppend||(e.contents.children().detach(),e.contents.append(g)),k&&e.attach(),e.renderComplete(j)},d.prototype.showRow=function(a){var b=this,c=!0;return b.conditions&&b.conditions.length&&(c=n.doesRowMeetConditions(a,b.conditions)),c},d.prototype.handleNewRow=function(a,b){var c=this,d={};if(b&&l.extend(d,b),a.Id&&!(a.Id in c.renderedItems)&&c.showRow(a)){var e=c.newItem(a,d);if(c.contents.prepend(e.element),c.render({resetPagination:!0,refreshFields:!1}),e&&"edit"===e.mode){var f=e.element.find(".nx-field > :input:visible:not(.nx-skootable-rowselect):not(.hasDatepicker):not(select)").first();f&&f.focus()}}},d.prototype.handleRowDeletion=function(a){a&&a in this.renderedItems&&this.renderedItems[a].destroy()},d.prototype.newItem=function(a,b){if(a.Id){var c=new e(this,a,{mode:b&&b.editModeForNewItems?"edit":this.mode,selected:b&&b.selected});return c.render(),this.renderedItems[a.Id]=c,c}},d.prototype.attach=function(){this.editor.contents.append(this.element,this.footer)},d.prototype.makeViewSwitcher=function(){var b=this,c=[];l.each(b.views,function(a,d){c.push({value:a,label:d.label||a,icon:d.icon,isSelected:b.currentView===a})});var d=l("<div>").actionSelect({items:c,onItemSelect:function(c){var d=b.currentView;b.currentView=c.value,b.render({doNotCache:!0,previousView:d}),l.cookie("nx-list-view-"+a.page.name+"-"+b.model.id,c.value)}});return d.addClass("nx-viewswitcher")},d.prototype.makeSearchBox=function(){var a=this;if("client"===a.searchMethod&&(a.customFilter=function(b,c){var d=!1;return l.each(a.searchFields,function(e,f){var g=a.model.getFieldValue(c,f.id,!0);return null!==g&&(d=-1!=g.toLowerCase().indexOf(b.toLowerCase())),!d}),!d&&a.searchSubFields&&l.each(a.searchSubFields,function(e,f){var g=c[e];g&&g.totalSize&&f.length&&l.each(g.records,function(c,e){return l.each(f,function(c,f){var g=a.model.getFieldValue(e,f.id,!0);return null!==g&&(d=-1!==g.toLowerCase().indexOf(b.toLowerCase())),!d}),!d})}),d}),a.searchFields||"custom"===a.searchMethod){var b="placeholder"in document.createElement("input"),c=l('<input type="text" class="searchbox" />'),d=a.searchPlaceholderText?n.mergeAsText("model",a.searchPlaceholderText,{createFields:!0,registerFields:!1},a.model):t("search")+" "+a.model.labelPlural;a.customFilterValue&&c.val(a.customFilterValue),b?c.attr("placeholder",d):(c.addClass("unchanged").val(d),c.focus(function(){c.hasClass("unchanged")&&c.val("").removeClass("unchanged")}).blur(function(){""===c.val()&&c.val(d).addClass("unchanged")}));var e=a.model.getConditionByName(a.searchConditionName);return e&&"group"===e.type&&!e.inactive&&e.value&&c.val(e.value),a.options.delayFilterExecution&&c.on("keyup",function(b){13===b.which&&a.applyFiltersAndSearch()}),n.delayInputCallback(c,function(b,d){a.options.delayFilterExecution&&"undefined"==typeof c.data("originalValue")&&c.data("originalValue",d),"client"===a.searchMethod||"custom"===a.searchMethod?(a.customFilterValue=b,a.render()):a.options.delayFilterExecution?a.showFilterActions():(a.setSearchCondition(b),"remove"!==a.options.emptySearchBehavior||b?a.updateData({message:t("searching"),failmessage:t("error_performing_requested_search"),showerror:!0}):a.model.abandonAllRows())}),c}return!1},d.prototype.setSearchCondition=function(a){var b=this;b.model.buildSearchCondition(b.searchConditionName,a,b.searchFields,{tokenize:b.options.tokenizeSearch,useSOSLSearch:b.options.useSOSLSearch,SOSLFields:b.options.SOSLFields})},d.prototype.showFilterActions=function(){this.applyFiltersBtn.show("fast"),this.cancelFiltersBtn.show("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.hide("fast")},d.prototype.hideFilterActions=function(){this.applyFiltersBtn.hide("fast"),this.cancelFiltersBtn.hide("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.show("fast")},d.prototype.applyFiltersAndSearch=function(){var a,b=this,c=b.searchBox;c&&(a=c.is(".unchanged")?"":c.val(),c.data("originalValue",a),b.setSearchCondition(a)),b.filters&&l.each(b.filters,function(){var a=this.activateFilter;a&&a()}),"remove"!==b.options.emptySearchBehavior||a?b.updateData({message:t("searching"),failmessage:t("error_performing_requested_search"),showerror:!0,successcallback:function(){b.hideFilterActions()}}):(b.model.abandonAllRows(),b.hideFilterActions())},d.prototype.cancelFiltersAndSearch=function(){var a=this,b=a.searchBox;b&&b.val(b.data("originalValue")),a.filters&&l.each(a.filters,function(){this.restoreOriginalValue()}),a.hideFilterActions()},d.prototype.updateData=function(a){var b=this;b.blockUI({message:a.message});var c=b.model.updateData();l.when(c).then(function(){b.unblockUI(),a.successcallback&&a.successcallback()},function(c){b.unblockUI({failmessage:a.failmessage+(a.showerror&&c?" \n\n"+t("error")+": "+c:"")})})},d.prototype.makeConditionsBar=function(){this.makeFiltersBar()},d.prototype.enableFiltersAndSearch=function(){var a,b=this;b.conditionsBar&&(a=b.conditionsBar.find(".nx-conditiontoken"),a.removeClass("unavailable"),a.children("select").multiselect("enable")),"server"===b.searchMethod&&b.searchBox&&b.searchBox.prop("disabled",!1)},d.prototype.disableFiltersAndSearch=function(){var a,b=this;b.conditionsBar&&(a=b.conditionsBar.find(".nx-conditiontoken"),a.addClass("unavailable"),a.children("select").multiselect("disable")),"server"===b.searchMethod&&b.searchBox&&b.searchBox.prop("disabled",!0)},d.prototype.blockUI=function(a){var b=this;a=a||{};var c={message:a.message};b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),b.editor.element.block(c)},d.prototype.unblockUI=function(a){var b=this;a=a||{};var c={};a.failmessage?(b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),c.timeout=a.timeout||4e3,c.message=a.failmessage,b.editor.element.block(c)):b.editor.element.unblock()},d.prototype.makeFiltersBar=function(){var a=this,b=a.options.listFilters;if(a.filters=[],!b)return!1;var c=a.conditionsBar;return c.empty(),l.each(b.children(),function(){var b=new g({xml:l(this),list:a});a.filters.push(b),b&&b.element&&c.append(b.element)}),c},d.prototype.nextPage=function(){this.currentPage++,this.render({refreshFields:!1})},d.prototype.prevPage=function(){this.currentPage--,this.render({refreshFields:!1})},d.prototype.goToPage=function(a){this.currentPage=a,this.render({refreshFields:!1})},e.prototype.id=function(){return this._GUID},e.prototype.render=function(){if(this.list&&this.list.views&&this.list.currentView){var a=this.list.views[this.list.currentView];this.element&&this.element.remove(),this.element=l("<"+(a.itemNodeType||"div")+">").addClass("nx-item"),this.element.data("object",this),a.render(this)}return this},e.prototype.refreshFields=function(a){var b=this;return l.each(b.fields,function(){(b.mode!==this.mode||!a||this.id in a)&&(this.mode=b.mode,this.render())}),b},e.prototype.resetMode=function(){return this.mode!==this.defaultMode&&(this.mode=this.defaultMode),this},e.prototype.toggleEdit=function(){return"readonly"!==this.mode&&(this.mode="read"==this.mode?"edit":"read",this.refreshFields()),this},e.prototype.toggleDelete=function(a){var b=this;return b.deleted?b.unMarkForDelete(a):b.markForDelete(a),b},e.prototype.handleUnmarkRowForDeletion=function(a){return!this.row||this.row!==a&&this.row.Id!=a.Id||this.unMarkForDelete(!1),this},e.prototype.handleMarkRowForDeletion=function(a){return!this.row||this.row!==a&&this.row.Id!=a.Id||this.markForDelete(!1),this},e.prototype.unMarkForDelete=function(a){return this.element.removeClass("deleted"),this.deleted=!1,a&&this.list.model.undeleteRow(this.row),this},e.prototype.markForDelete=function(a){return this.element.addClass("deleted"),this.deleted=!0,a&&this.list.model.deleteRow(this.row),this},e.prototype.registerField=function(a){this.fields.push(a)},e.prototype.unregister=function(){var a=this;return a.list&&a.list.model&&a.list.model.unregisterItem(this),a.fields&&a.fields.length&&l.each(a.fields,function(){this.destroy()}),a},e.prototype.destroy=function(){this.element&&this.element.remove(),this.unregister()},f.prototype.uid=function(){return this._GUID},f.prototype.register=function(a){return this.model&&this.model.registerField(this,a),this},f.prototype.unregister=function(){var a=this,b=a.options;a.model&&a.model.unregisterField(a,b?b.controllingFields:!1)},f.prototype.calculateReferenceText=function(){return n.calculateReferenceText({model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata})},f.prototype.calculateReferenceMerges=function(a){return a||(a={}),n.calculateReferenceMerges(l.extend(a,{model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata}))},f.prototype.getValidPicklistEntries=function(){var a,b,c=n.toArray,d=this,e=d.item,f=this.metadata.controllingField,g=function(a,b){var c=new sforce.Base64Binary(""),d=c.decode(b),e=d.charCodeAt(a>>3);return 0!==(e&128>>a%8)},h=e&&e.ValidRecordTypeIds?e.ValidRecordTypeIds:[],i=d.model.getFieldValue(d.row,"RecordTypeId",!0);if(i&&-1===l.inArray(i,h)&&h.push(i),h.length&&(a=n.getPicklistEntriesValidForRecordTypes(this.model.objectName,d.id,h)),f){var j,k,m=n.getAPIDescribeSObject(this.model.objectName);if(m&&(l.each(c(m.fields),function(){return d.id===this.name?j=this:d.metadata.controllingField===this.name&&(k=this),j&&k?!1:void 0}),j&&k)){var o,p=d.model.getFieldValue(d.row,f,!0);a&&a.length?(b={},l.each(a,function(){b[this.value]=1}),a.length=0):a=[],"boolean"===k.type?o=p?1:0:l.each(c(k.picklistValues),function(a){this.value===p&&(o=a)}),(o||0===o)&&l.each(c(j.picklistValues),function(){g(o,this.validFor)&&(!b||this.value in b)&&a.push(this)})}}return a?a:this.metadata.picklistEntries},f.prototype.addOrReplaceConditionsForLookupFiltersToModel=function(b){var c=this,d=[],e=c.options&&c.options.filters?c.options.filters:!1;return b||(b=c.model),e&&e.length&&l.each(e,function(e,f){var g,h,i=c.id+"_"+f.field+"_"+e,j=b.getConditionByName(i);if(j||(j=new a.model.Condition,j.name=i,b.addCondition(j)),j.field=f.field,j.operator=f.operator||"=",j.encloseValueInQuotes=f.encloseValueInQuotes,g=n.isMultiValueOperator(j.operator),"dependent"===f.type)h=c.model.getFieldValue(c.row,f.depfield,!0),"undefined"!=typeof h&&(g?j.values=h&&-1!=h.indexOf(";")?h.split(";"):[h]:j.value=h),j.type="fieldvalue";else if("param"===f.type)h=a.page.params[f.mergeField],"undefined"!=typeof h&&(g?j.values=h&&-1!=h.indexOf(";")?h.split(";"):[h]:j.value=h),j.type="fieldvalue";else if("modelmerge"===f.type){var k=a.model.getModel(f.mergeModel);k&&(g?(j.values=[],l.each(k.data,function(){j.values.push(k.getFieldValue(this,f.mergeField,!0))})):j.value=k.getFieldValue(k.getFirstRow(),f.mergeField,!0),j.type="fieldvalue")}else j.type=f.type,f.values?j.values=f.values:j.value=f.value,f.mergeField&&(j.mergeField=f.mergeField,j.originalValue=null);d.push(j)}),d};var y=function(a){if(a&&a.length){var b=[];return a.children().each(function(){var a=l(this),c="false"!==a.attr("enclosevalueinquotes"),d={field:a.attr("field"),type:a.attr("type"),operator:a.attr("operator"),value:a.attr("value"),depfield:a.attr("depfield"),encloseValueInQuotes:c};if("multiple"==d.type){d.values=[];var e=a.children("values");e.length&&e.first().children("value").each(function(){var a=n.getXML(this);a.length>8?(a=n.decodeXML(a.substring(7,a.length-8)),d.values.push(n.adjustValueBasedOnQuotedness(a,c))):d.values.push("")})}else"userinfo"==d.type?d.mergeField=a.attr("userinfotype"):"param"===d.type?d.mergeField=a.attr("value"):"modelmerge"===d.type&&(d.mergeField=a.attr("mergefield"),d.mergeModel=a.attr("model"));b.push(d)}),b}};g.prototype.setOriginalValue=function(a){"undefined"==typeof this.element.data("originalValue")&&this.element.data("originalValue",a)},g.prototype.restoreOriginalValue=function(){var a=this,b=a.element,c=b.data("originalValue");if(a.isMultiselect&&!a.isReferenceFilter){if(b=b.find("select"),"__reset"===c)b.val("");else if(c){var d=c.split(";");l.each(b.children("option"),function(a,b){l(b).prop("selected",l.inArray(b.value,d)>-1)})}b.data("echMultiselect")&&b.multiselect("refresh")}else"undefined"!=typeof c&&("toggle"===a.type?b.toggleClass("disabled",c):"daterange"===a.type?a.updateDisplayValue(c.start,c.end):a.isReferenceFilter?b.actionAutocomplete("resetItem",c):c&&"undefined"!=typeof c.value&&(a.element.is(".nx-actionautocomplete")?b.actionAutocomplete("resetItem",c.value):b.actionSelect("selectItem",c,{triggerHandlers:!1})))},g.prototype.isSelectedFromEffects=function(b){var c=this,d=!1;return b.each(function(){var b=l(this),e=c.affectedConditions[b.attr("condition")];if(e)if("deactivate"===b.attr("action")){if(!e.inactive)return d=!1,!1}else if("set"===b.attr("action")){var f=a.utils.mergeAsText("global",b.attr("value")||"",{createFields:!0,registerFields:!1});if(f!==e.value||e.inactive)return d=!1,!1}else if("activate"===b.attr("action")&&e.inactive)return d=!1,!1;d=!0}),d},g.prototype.resetAffectedConditions=function(){var a=this;l.each(a.affectedConditions,function(){a.model.resetCondition(this,a.affectCookies)})},g.prototype.applyFilterForItem=function(b){var c,d=this,e=[],f=b.effects,g=b.source,h=g&&g.effects,i=b.affectDefaultCondition;if(f&&f.length&&l.each(f,function(){e.push(this)}),h&&h.length&&l.each(h,function(){e.push(this)}),c=e&&e.length,c&&l.each(e,function(){var c=l(this),e=d.affectedConditions[c.attr("condition")];if(e)if("deactivate"===c.attr("action"))d.model.deactivateCondition(e,d.affectCookies);else if("set"===c.attr("action")){var f,h={};b.row&&(h.row=b.row),g&&g.model&&(h.model=g.model),c.attr("value")?f=c.attr("value"):b.value&&(f=b.value),f=a.utils.mergeAsTextInContext(f,h,{createFields:!1,registerFields:!1}),d.model.setCondition(e,f,d.affectCookies)}else"activate"===c.attr("action")&&d.model.activateCondition(e,d.affectCookies)}),i&&"undefined"!=typeof b.value&&d.filterCondition)if("__reset"===b.value)d.model.resetCondition(d.filterCondition,d.affectCookies);else{var j,k=a.utils.mergeAsText("global",b.value||"",{createFields:!1,registerFields:!1}),m=d.filterCondition.operator;d.isMultiselect?(j=d.filterCondition.values,j?(a.utils.isString(j)&&(j=j.split(";")),-1===l.inArray(k,j)&&j.push(k)):j||(j=[k]),a.utils.isMultiValueOperator(m)||("="===m?m="in":"!="===m&&(m="not in"),d.filterCondition.operator=m)):j=k,d.model.setCondition(d.filterCondition,j,d.affectCookies)}},g.prototype.unApplyFilterForItem=function(b){var c,d=this,e=[],f=b.effects,g=b.source,h=g&&g.effects,i=b.affectDefaultCondition;if(f&&f.length&&l.each(f,function(){e.push(this)}),h&&h.length&&l.each(h,function(){e.push(this)}),c=e&&e.length,c&&l.each(e,function(){var a=l(this),b=d.affectedConditions[a.attr("condition")];b&&("deactivate"===a.attr("action")?d.model.activateCondition(b,d.affectCookies):d.model.deactivateCondition(b,d.affectCookies))}),i&&"undefined"!=typeof b.value&&d.filterCondition)if("__reset"===b.value){var j=a.utils.mergeAsText("global",b.value||"",{createFields:!1,registerFields:!1});
d.model.setCondition(d.filterCondition,j,d.affectCookies)}else if(d.isMultiselect){var k=d.filterCondition.values,m=l.inArray(b.value,k);m>-1&&k.splice(m,1)}else d.model.resetCondition(d.filterCondition,d.affectCookies)},g.prototype.executeFilter=function(){var a,b=this,c=b.list.searchBox;c&&(a=c.val()),"remove"!==this.list.options.emptySearchBehavior||a?this.list.updateData({message:t("applying_filter"),failmessage:t("filter_could_not_be_applied"),showerror:!0}):this.list.model.abandonAllRows()},h.prototype.unregister=function(){this.editor.unregister()},h.prototype.addSearchField=function(a,b){this.list.addSearchField(a,b)};var z=function(b,c,d){var e=!1,f=[],g=function(b,c,e){var f=l("<div>").addClass("nx-radiowrapper"),g=a.utils.generateGUID(),h=l('<input type="radio" name="'+d.buttonSetName+'">').addClass("nx-radio").prop("id",g).prop("checked",e).prop("disabled","read"===d.mode).val(b),i=l("<label>").prop("for",g).addClass("nx-radiolabel").html(u(c)).appendTo(f);return f.append(h,i),f};return d.makeNoneOption&&f.push(g("",d.noneLabel||t("select_option_none"),!b)),l.each(c,function(a,c){if(c.value){var d=c.value===b&&""!==c.label;d&&!e&&(e=!0),f.push(g(c.value,c.label,d))}}),e||!b&&"0"!==b&&"false"!==b||f.unshift(g(b,b,!0)),f},A={TEXT:{edit:function(a){var b=l("<input "+(a.inputType?' type="'+a.inputType+'"':"")+">").val(a.value);return n.delayInputCallback(b,function(b,c){a.onChange&&a.onChange(b,c)}),b}},BOOLEAN:{edit:function(a){var b=l('<input type="checkbox">').prop("checked",a.value).change(function(){a.onChange&&a.onChange(l(this).is(":checked")),b.focus()});return b}},AUTOCOMPLETE:{edit:function(a){var b=l("<input>");a=a||{},a.minLength||0===a.minLength||(a.minLength=2);var c=function(){f&&(f.removeClass("ui-icon ui-icon-search"),f.addClass("nx-spinner-small"))},d=function(){f&&(f.removeClass("nx-spinner-small"),f.addClass("ui-icon ui-icon-search"))},e=function(){return"function"==typeof a.source?function(b,e){a.source(b,e,c,d)}:a.source};b.autocomplete({minLength:a.minLength,source:e(),select:a.onChange,focus:a.onFocus,close:a.onClose}).val(a.value),a.optionRenderer&&(b.data("ui-autocomplete")._renderItem=a.optionRenderer),b.on("keyup",function(){""===l(this).val()&&a.onClear&&a.onClear()}),b.focus(function(){b.autocomplete("widget").css("z-index",parseInt(b.closest(".ui-front").css("z-index"),10)+1)}),b.blur(function(){a.onBlur&&a.onBlur()});var f=l("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search");return a.parentElem&&a.parentElem.append(f),b}},DATE:{edit:function(a){a=a||{};var b,c=!1;if("SELECTBOXES"===a.renderas);else{b=l("<input>"),b.datepicker({onSelect:function(d,f){var g=1,h=f.selectedMonth-0+g+"",i=f.selectedDay+"";1===h.length&&(h="0"+h),1===i.length&&(i="0"+i);var j=f.selectedYear+"-"+h+"-"+i;e=b.val(),a.onChange&&a.onChange(j),c=!0,b.focus(),setTimeout(function(){c=!1},200)},beforeShow:function(){return c?!1:void 0}}).click(function(){b.datepicker("show")});var d=a.value&&p(a.value);d&&b.datepicker("setDate",d),b.datepicker("widget").click(function(a){a.stopPropagation()});var e=b.val();b.bind("change keyup",function(){var c=l(this).val();if(c!=e){e=c;var d;d=""!==c?r(b.datepicker("getDate")):"",a.onChange&&a.onChange(d)}})}return b}},DATETIME:{edit:function(a){var b,c=l("<div>"),d=l("<input>"),e=!1;a.value&&(b=q(a.value),c.data("usedate",b)),d.datepicker({onSelect:function(b,f){var g=new Date;g.setHours(0,0,0,0);var h=o.getLocalDateTime(c.data("usedate")||g);h.setFullYear(f.selectedYear,f.selectedMonth,f.selectedDay);var i=o.getRealJSDateTimeFromLocal(h),j=s(i);a.onChange&&a.onChange(j),c.data("usedate",i),e=!0,d.focus(),setTimeout(function(){e=!1},200)},beforeShow:function(){return e?!1:void 0}}).click(function(){d.datepicker("show")}),a.value&&b&&d.datepicker("setDate",b),d.datepicker("widget").click(function(a){a.stopPropagation()});var f=d.val();d.bind("change keyup",function(){if(l(this).val()!=f){f=l(this).val();var b;if(""!==l(this).val()){var e=d.datepicker("getDate")||new Date;e.setHours(0,0,0,0);var g=o.getLocalDateTime(c.data("usedate")||e);g.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());var h=o.getRealJSDateTimeFromLocal(g);b=s(h),c.data("usedate",h)}else b="",c.data("usedate",null);a.onChange&&a.onChange(b)}}).addClass("nx-dt-dateinput");var g=new Date;g.setHours(0,0,0,0);var h,i,j,k,m,p=o.getLocalDateTime(b||g),r=l("<div>").addClass("nx-dt-timewrapper"),t=n.userLocale,u=t.timeFormat,v=o.amPm,w=function(a){var b=k+1<u.length&&u.charAt(k+1)===a;return b&&k++,b},x=!1,y=function(){var b=o.getLocalDateTime(c.data("usedate")||new Date);b.setHours((parseInt(h.val(),10)+(j&&"pm"===j.val()?12:0))%24),b.setMinutes(i.val());var d=o.getRealJSDateTimeFromLocal(b);c.data("usedate",d),a.onChange&&a.onChange(s(d))},z=function(a){r.append(l("<span>"+a+"</span>"))};for(k=0;k<u.length;k++)if(m=u.charAt(k),x)"'"!==m||w("'")?z(m):x=!1;else{var A,B;switch(m){case"a":if(!j){j=l("<select>");var C=p&&p.getHours()>=12;j.append(l("<option "+(C?"":"selected ")+'value="am">'+v[0]+"</option>")),j.append(l("<option "+(C?"selected ":"")+'value="pm">'+v[1]+"</option>")),j.appendTo(r).on("change",y)}break;case"h":case"K":case"k":case"H":if(!h){h=l("<select>"),B=w(m);for(var D,E="h"===m||"K"===m?12:24,F=0;E>F;F++)D="h"===m&&0===F?12:"k"===m?F-0+1:F,A=!1,p?A=F===(E>12?p.getHours():p.getHours()%12):8===F&&(A=!0),h.append(l("<option "+(A?"selected ":"")+'value="'+F+'">'+(B&&10>D?"0"+D:D)+"</option>"));h.appendTo(r).on("change",y)}break;case"m":if(!i){i=l("<select>"),B=w("m");for(var G=p&&p.getMinutes()%5!==0?1:5,H=0;60>H;H+=G)A=!1,p?A=H===p.getMinutes():0===H&&(A=!0),i.append(l("<option "+(A?"selected ":"")+'value="'+H+'">'+(B&&10>H?"0"+H:H)+"</option>"));i.appendTo(r).on("change",y)}break;case"'":w("'")?z("'"):x=!0;break;default:z(u.charAt(k))}}return t&&t.showTimeBeforeDate?c.append(r,d):c.append(d,r),c}},MULTIPICKLIST:{edit:function(a){a.valueDelimiter||(a.valueDelimiter=";");var b,c=a.value,d=a.checkboxSetName,e=a.entries,f=a.maxSelected,g=a.valueDelimiter,h=a.selectedList||3,i=a.selectedText||t("number_selected"),j=a.noneSelectedText||t("none_selected"),k=!1;c||(c="");var m,n=c.split(g),o=f&&n.length>=f,p=a.element||l("<div>"),q=c;if("CHECKBOXES"===a.renderas)p.addClass("nx-fieldtext").css("padding","0px"),b=function(){if(!k){k=!0;var b,c=p.find('input[type="checkbox"]'),d=c.filter(function(){return l(this).prop("checked")}).map(function(){return this.value}).get();if(f)if(d.length>=f){b=[];var e=0;c.each(function(){var a=l(this);if(a.prop("checked")){if(e++<f)return b.push(a.val()),!0;a.prop("checked",!1)}a.prop("disabled",!0)})}else c.each(function(){l(this).prop("disabled")&&l(this).prop("disabled",!1)});m=(f&&b?b:d).join(g),a.onChange&&a.onChange(m,q),q=m,k=!1}},l.each(e,function(a,b){if(b.value){var c="";-1!==l.inArray(b.value,n)&&""!==b.value&&(c='checked="yes"');var e=l("<div>").addClass("nx-checkboxwrapper"),f=l("<input "+c+' type="checkbox">').val(b.value).prop("id","mscb_"+d+"_"+b.value).addClass("nx-checkbox").appendTo(e),g=l("<div>").addClass("nx-checkboxlabel").appendTo(e);o&&!c&&f.prop("disabled",!0),g.append(l("<label>").html(u(b.label)).prop("for","mscb_"+d+"_"+b.value)),p.append(e)}}),p.off(),p.on("change","input",function(){b()});else{var r=l('<select multiple="multiple">').appendTo(p);l.each(e,function(a,b){var c,d="";-1!==l.inArray(b.value,n)&&""!==b.label&&(d='selected="selected"'),c=l("<option "+d+">").attr("value",b.value).text(b.label),r.append(c)}),b=function(){if(!k){k=!0;var b,c=r.multiselect("getChecked").map(function(){return this.value}).get();if(f){var d=r.multiselect("widget").find('input[type="checkbox"]');if(c.length>=f){b=[];var e=0;d.each(function(){var a=l(this);if(a.prop("checked")){if(e++<f)return b.push(a.val()),!0;this.click()}a.prop("disabled",!0).closest("label").addClass("ui-state-disabled")})}else r.multiselect("widget").find("input:disabled").each(function(){l(this).prop("disabled",!1).closest("label").removeClass("ui-state-disabled")})}m=(f&&b?b:c).join(g),a.onChange&&a.onChange(m,q),q=m,k=!1}},r.multiselect({selectedText:i,noneSelectedText:j,checkAllText:t("check_all"),uncheckAllText:t("uncheck_all"),selectedList:h,position:a.position,autoOpen:!1,close:function(){l(this).parent().find("button.ui-multiselect").removeAttr("tabindex").focus(),a.onClose&&a.onClose.call(this)},click:function(a,c){b(a,c)},open:function(){o&&r.multiselect("widget").find("input:not(:checked)").each(function(){l(this).prop("disabled",!0).closest("label").addClass("ui-state-disabled")}),l(this).parent().find("button.ui-multiselect").attr("tabindex","-1")},create:function(){a.onCreate&&a.onCreate.call(this)}}).on("multiselectcheckall multiselectuncheckall",function(a,c){b(a,c)});var s=r.data("echMultiselect")||r.data("ech-multiselect");s&&s.menu&&s.menu.on("focusin",function(a){a.stopPropagation()}),e.length>5&&r.multiselectfilter({label:"",placeholder:t("enter_keywords")})}return p}},PICKLIST:{edit:function(a){var b;if("RADIO_BUTTONS"===a.renderas){b=l("<div>").addClass("nx-fieldtext").css("padding","0px");var c=z(a.value,a.entries,{makeNoneOption:!a.required||a.addNoneOption,mode:a.mode,buttonSetName:a.buttonSetName,noneLabel:a.noneLabel});l.each(c,function(){b.append(this)}),b.off("change.skuid"),b.on("change.skuid","input",function(){a.onChange&&a.onChange(b.find("input:checked").first().val())})}else{b=l("<select>"),(!a.required||a.addNoneOption)&&b.append(l("<option>").attr("value","").text(a.noneLabel||t("select_option_none")));var d=!1,e=a.value||""===a.value,f={},g=a.defaultValue,h=!1;a.entries&&l.each(a.entries,function(a,c){var d=c.value,e=l("<option>").attr("value",d).text(c.label);c.disabled===!0&&e.prop("disabled",!0),f[d]=e,b.append(e)}),e&&a.value in f&&(d=!0),e&&d?b.val(a.value):"undefined"!=typeof g&&g in f&&(b.val(g),h=!0);var i=b.val();b.on("change.skuid",function(){a.onChange&&a.onChange(b.val(),i),i=b.val()}),!a.required||e&&d||(h=!0),h&&a.onChange&&b.val()&&a.onChange(b.val())}return b}}},B=["BOOLEAN","CURRENCY","DATE","DATETIME","DOUBLE","ID","INTEGER","PERCENT","TIME"],C=function(a,b){var c=a.metadata;return c&&c.displaytype&&-1!=l.inArray(c.displaytype,B)?b:u(b)},D=function(a,b){a.element.html('<div class="nx-fieldtext">'+b+(a.editable&&"readonly"!==a.mode?'<div class="focusbox" tabindex="0"/>':"")+"</div>"),a.options&&"right"===a.options.valueHorizontalAlignment&&a.element.addClass("halignright")},E=function(a){var b,c=a.model,d=a.row,e=c.getFieldValue(d,a.id),f=c.objectName,g=c.getNameFieldValueForRow(d);window.sforce&&sforce.interaction&&window.sendCTIMessage&&(b=window.sendCTIMessage),b&&b("/CLICK_TO_DIAL?DN="+encodeURIComponent(e)+(d.Id?"&ID="+d.Id:"")+"&ENTITY_NAME="+f+"&OBJECT_NAME="+encodeURIComponent(g))},F=new RegExp("[^0-9]+","g"),G={TEXT:{read:function(b,c){c||0===c||(c=""),n.isString(c)||(c=""+c);var d,e=b.options.maxDisplayCharacters,f=b.metadata,g=f&&"URL"===f.displaytype,h=b.row;g&&(""!==c&&-1===c.indexOf("//")&&(c="http://"+c),e||(e=40));var i=c,j=["FirstName","LastName","Company"],k=!1,m=a.page.sitePrefix;if(e&&(e-=0),!isNaN(e)&&e>0&&e<c.length&&(c=c.substring(0,e)+"..."),!b.model.isSingleRow()&&n.userInfo.isAuthenticated&&(f&&f.nameField||-1!==l.inArray(b.id,j))&&!a.model.isNewId(h.Id)&&-1===b.id.indexOf(".")&&(c='<a href="',c+=w?'#" onclick="sforce.one.navigateToSObject(\''+h.Id+"');":x?'#" onclick="skuid.ui.openConsoleTabForNameField(\''+h.Id+"','"+u(b.model.id)+"');":(m&&"null"!==m?m:"")+"/"+h.Id,c+='">'+u(i)+"</a>",k=!0),g){var o=c&&n.startsWith(c,"/"),p=u(i);c=w?'<a href="#" onclick="sforce.one.navigateToURL(\''+p+"');\">"+u(c)+"</a>":x&&o?'<a href="#" onclick="skuid.ui.openConsoleTabForUrl(\''+p+"','"+p+"');\">"+u(c)+"</a>":'<a href="'+p+'"'+(x?' target="blank"':"")+">"+u(c)+"</a>",k=!0}d=(f?f.htmlFormatted:!1)?n.removeScriptTags(c):n.nl2br(k||f&&f.calculated?c:u(c)),D(b,d)},readonly:function(a,b){G.TEXT.read(a,b)},edit:function(a,b,c){b||0===b||(b=""),a.element.append(A.TEXT.edit({inputType:c,value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},TEXTAREA:{read:function(a,b){G.TEXT.read(a,b)},readonly:function(a,b){G.TEXTAREA.read(a,b)},edit:function(a,b){b||0===b||(b="");var c,d=a.model,e=a.row,f=a.id;if(c=l("<textarea>").val(b),l.support.leadingWhitespace||c.addClass("ie8-textarea"),a.metadata.htmlFormatted){a.disableBlur=!0;var g,h=function(){g=window.CKEDITOR.replace(c[0],{uiColor:"#DDDDDD",toolbar:[{name:"document",groups:["mode"],items:["Source"]},{name:"clipboard",groups:["undo"],items:["Undo","Redo"]},{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Strike","-","RemoveFormat"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"],items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote"]},{name:"links",items:["Link","Unlink"]},{name:"insert",items:["Image"]},{name:"styles",items:["Styles","Format"]}]});var b=2,h=function(b){b!==d.getFieldValue(e,f,!0)&&d.updateRow(e,f,b,{initiatorId:a._GUID})};g.on("change",function(){h(g.getData())}),g.on("mode",function(){b=2===b?!1:!b}),g.on("key",function(){b&&h(g.getData())})};window.CKEDITOR?h():l.getScript("https://cdnjs.cloudflare.com/ajax/libs/ckeditor/4.3.2/ckeditor.js",function(){h()})}else n.delayInputCallback(c,function(){a.model.updateRow(a.row,a.id,c.val(),{initiatorId:a._GUID})});a.element.append(c)}},DOUBLE:{read:function(a,b,c,d){b||0===b||(b="");var e,f,g=n.userLocale,h=a.metadata,i=a.options.decimalPlaces;i||"0"===i?e=parseInt(i,10):h&&h.scale&&(e=h.scale),e&&n.isNumber(e)||(e=0),f=""===b?b:(c?c:"")+l.number(b,e,g.decimalsSeparator,g.thousandsSeparator)+(d?d:""),D(a,f)},readonly:function(a,b){G.DOUBLE.read(a,b)},edit:function(a,b){b||0===b||(b="");var c=n.userLocale,d=l("<input>").val(""!==b?l.number(b,a.metadata&&a.metadata.scale?a.metadata.scale:0,c.decimalsSeparator,c.thousandsSeparator):b);n.delayInputCallback(d,function(b){var d=b.split(c.decimalsSeparator),e="-"===d[0].charAt(0);b=(e?"-":"")+d[0].replace(F,""),d.length>1&&(b+=c.decimalsSeparator+d[1].replace(F,"")),b=b.replace(c.decimalsSeparator,".");var f=a.metadata.displaytype;b&&(b="INTEGER"===f?parseInt(b,10):parseFloat(b)),a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}),a.element.append(d)}},INTEGER:{read:function(a,b){G.DOUBLE.read(a,b)},readonly:function(a,b){G.INTEGER.read(a,b)},edit:function(a,b){G.DOUBLE.edit(a,b)}},PERCENT:{read:function(a,b){G.DOUBLE.read(a,b,!1,"%")},readonly:function(a,b){G.PERCENT.read(a,b)},edit:function(a,b){G.DOUBLE.edit(a,b)}},CURRENCY:{read:function(b,c){c||0===c||(c="");var d,e,f=n.userLocale,g=n.userInfo.defaultCurrency,h=b.metadata,i=b.options?b.options.decimalPlaces:null;if(i||"0"===i||0===i?d=parseInt(i,10):h&&h.scale&&(d=h.scale),d&&n.isNumber(d)||(d=0),e=""!==c?l.number(c,d,f.decimalsSeparator,f.thousandsSeparator):c,""!==c)if(n.isMultiCurrencyOrganization&&b.row){var j,k,m="CurrencyIsoCode",o=b.id.lastIndexOf("."),p=b.id,q=b.model,r=q.isAggregate,s=b.row,t=-1!==o?p.substring(0,o+1):"";r?j=n.conversionRates[0].IsoCode:(j=q.getFieldValue(s,t+m,!0),j||(j=q.getFieldValue(s,m,!0))),e=j+" "+e,j&&j!=g&&(k=n.convertCurrency(c,j,g),k&&k!=c&&(e+=" ("+g+" "+l.number(k,d,f.decimalsSeparator,f.thousandsSeparator)+")"))}else e=a.currency.getSymbol(g)+e;D(b,e)},readonly:function(a,b){G.CURRENCY.read(a,b)},edit:function(a,b){G.DOUBLE.edit(a,b)}},BOOLEAN:{read:function(a,b){var c=l("<div>").addClass("nx-fieldtext").css("padding","0px"),d=l('<input type="checkbox">').prop({checked:b,disabled:"true"});c.append(d),a.editable&&"readonly"!==a.mode&&c.append('<div class="focusbox" tabindex="0"/>'),a.element.append(c)},readonly:function(a,b){G.BOOLEAN.read(a,b)},edit:function(a,b){"true"===b&&(b=!0),a.element.append(A.BOOLEAN.edit({value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},DATE:{read:function(a,b){D(a,o.makeFormattedDate(b))},readonly:function(a,b){G.DATE.read(a,b)},edit:function(a,b){a.element.append(A.DATE.edit({value:b,renderas:a.options.type,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},DATETIME:{read:function(a,b){D(a,o.makeFormattedLongDateTime(b))},readonly:function(a,b){G.DATETIME.read(a,b)},edit:function(a,b){a.element.append(A.DATETIME.edit({value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},EMAIL:{read:function(a,b){b||0===b||(b=""),""!==b&&(b=u(b),b='<a href="mailto:'+b+'">'+b+"</a>"),D(a,b)},edit:function(a,b){G.TEXT.edit(a,b,"email")},readonly:function(a,b){G.EMAIL.read(a,b)}},LOCATION:{read:function(a,b){var c,d,e,f,g=".",h="DECIMAL",i="",j=a.options.type||a.metadata.type||h;b&&(d=b.latitude,e=b.longitude,j===h?(f=function(a){var b=(a+"").split(g);return l.number(a,b.length>1?b[1].length:1,g,"")+""},d=f(d),e=f(e),d&&(i+=d),i+=" ",e&&(i+=e)):(c="&#39;",f=function(a,b){var d=0>a,e=Math.abs(a),f=Math.floor(e),g=60*(e-f),h=Math.floor(g),i=Math.round(60*(g-h));return f+"&deg;"+h+c+i+c+c+(b?d?"S":"N":d?"W":"E")},d=f(d,!0),e=f(e),d&&(i+=d),i+=" ",e&&(i+=e))),D(a,i)},edit:function(b,c){var d,e,f=b.row,g=b.model,h=b.id,i=h.substring(0,h.length-1),j=i+"Latitude__s",k=i+"Longitude__s";c&&(d=c.latitude,e=c.longitude);var l=new a.ui.Field(f,g,null,{fieldId:j}),m=new a.ui.Field(f,g,null,{fieldId:k});l.render(),m.render(),b.element.append(l.element,m.element)},readonly:function(a,b){G.LOCATION.read(a,b)}},PHONE:{read:function(a,b){if(window.sforce&&b&&m.showClick2Dial){G.TEXT.read(a,b);var c=m.click2Dial;c||(c=E),a.element.css("white-space","nowrap").append(l('<div class="sk-click2dial-wrapper">').append(l('<span class="ui-icon sk-icon sk-icon-phone inline">').attr("title","Click to dial")).on("click.skuid",function(){c(a)}).css("cursor","pointer")),a.element.children().css({display:"inline-block"})}else{var d;b||"0"===b?d=b.replace(/\D+/g,""):(b="",d=!1),""!==b&&(b=u(b),(d||"0"===d)&&(b='<a href="tel:'+d+'">'+b+"</a>")),D(a,b)}},edit:function(a,b){G.TEXT.edit(a,b,"tel")},readonly:function(a,b){G.PHONE.read(a,b)}},PICKLIST:{read:function(a,b){var c=a.getValidPicklistEntries();if("RADIO_BUTTONS"===a.options.type){var d=l("<div>").addClass("nx-fieldtext").css("padding","0px"),e=z(b,c,{makeNoneOption:!a.required||a.options.addNoneOption,mode:a.mode,buttonSetName:a.id+"_"+a._GUID});l.each(e,function(){d.append(this)}),a.editable&&"readonly"!==a.mode&&d.append('<div class="focusbox" tabindex="0"/>'),a.element.append(d)}else l.each(c,function(){return this.value===b?(this.label&&(b=this.label),!1):void 0}),D(a,b?u(b):"")},readonly:function(a,b){G.PICKLIST.read(a,b)},edit:function(a,b){a.element.append(A.PICKLIST.edit({value:b,entries:a.getValidPicklistEntries(),renderas:a.options.type,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},required:a.required,addNoneOption:a.options.addNoneOption,mode:a.mode,buttonSetName:a.id+"_"+a._GUID,noneLabel:a.options.noneLabel}))}},MULTIPICKLIST:{read:function(a,b,c){c||(c=";");var d=l("<div>").addClass("nx-fieldtext"),e=a.getValidPicklistEntries(),f=b?b:"",g=f.split(c);if("CHECKBOXES"===a.options.type)d.css("padding","0px"),l.each(e,function(a,b){if(b.value){var c="";-1!==l.inArray(b.value,g)&&""!==b.value&&(c='checked="yes"');var e=l("<div>").addClass("nx-checkboxwrapper");e.append(l("<input "+c+' type="checkbox" value="'+b.value+'">').addClass("nx-checkbox").prop("disabled",!0)),e.append(l("<div>"+u(b.label)+"</div>").addClass("nx-checkboxlabel")),d.append(e)}});else if(f){var h={},i=[];l.each(e,function(a,b){h[b.value]=b.label}),l.each(g,function(){i.push(h[this]||this)}),d.html(u(i.join(", ")))}else d.html("");a.editable&&"readonly"!==a.mode&&d.append('<div class="focusbox" tabindex="0"/>'),a.element.append(d)},readonly:function(a,b,c){G.MULTIPICKLIST.read(a,b,c)},edit:function(a,b,c){"CHECKBOXES"!==a.options.type&&(a.disableBlur=!0),a.element.append(A.MULTIPICKLIST.edit({value:b,entries:a.getValidPicklistEntries(),renderas:a.options.type,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},valueDelimiter:c,checkboxSetName:a.id+"_"+a._GUID,maxSelected:a.options.maxSelected}))}},CHILDREL:{read:function(a){var b,c,d=l("<div>").addClass("nx-fieldtext").appendTo(a.element),e=a.row[a.id],f=a.options.delimiter;f||(f=""),e&&(b=a.row[a.id].records,c=b.length,l.each(b,function(b){var e=a.model.mergeRow(this,a.options.template,{allowHTML:a.options&&a.options.allowHTML,registerFields:!1});e.css("display","inline"),d.append(e),b+1!==c&&d.append("<span>"+f+"</span>")})),a.element.append(d)},readonly:function(a,b){G.CHILDREL.read(a,b)}},COMBO:{read:function(a){var b=l("<div>").addClass("nx-fieldtext").appendTo(a.element),c=a.options;b.append(a.model.mergeRow(a.row,c.template,{allowHTML:c&&c.allowHTML,registerFields:!1})),a.editable&&"readonly"!==a.mode&&b.append('<div class="focusbox" tabindex="0"/>'),a.element.append(b),c&&"right"===c.valueHorizontalAlignment&&a.element.addClass("halignright"),a.element.off("click.skuid").css("cursor","auto")},readonly:function(a,b){G.COMBO.read(a,b)},edit:function(a,b){G.COMBO.read(a,b);var c=a.options,d=a.element,e=d.find(".focusbox"),f=l('<input type="text">').addClass("nx-visuallyhidden");e.before(f);var g=function(){f.off("focus");var b,d,h,j="custompopup"===c.editModeBehavior,k=[{text:t("done"),icons:{primary:"ui-icon-check"},click:function(){l(this).dialog("close")}}],m=function(){l(this).find(":input").first().focus()},o=function(){e.attr("preventaction","true"),f.on("focus",g),e.focus()};j?h=n.createPopupFromPopupXML(c.editModePopupXML,a,{open:m,close:o,buttons:k,modal:!0,resizable:!0}):(b=a.model.getRowMergeResult(a.row,c.template),d=b.fields,h=l('<div title="'+c.label+'" class="nx-editor"/>'),h.append(i(d,{editor:a.editor})),h.dialog({resizable:!0,modal:!0,width:450,open:m,close:function(){o(),h.dialog("destroy").remove()},buttons:k})),a.editor.editModePopup=h};f.on("focus",g),d.on("click.skuid",g).css("cursor","pointer")}},CUSTOM:{read:function(b,c){var d=a.snippet.getSnippet(b.options.snippet);d&&d(b,C(b,c))},readonly:function(a,b){G.CUSTOM.read(a,b)},edit:function(a,b){G.CUSTOM.read(a,b)}},FILE:{read:function(a){var b=l("<div>").addClass("nx-fieldtext").css({padding:"0px","min-height":"26px"}).appendTo(a.element);new n.FileComponent(b,{model:a.model,row:a.row,displayAs:"filename",storeAs:"field",idField:a.id,deleteable:!1,editable:!1})},readonly:function(a,b){G.FILE.read(a,b)},edit:function(b){var c=l("<div>").addClass("nx-fieldtext").appendTo(b.element);a.model.isNewId(b.row.Id)?(c.css({"font-size":"8pt",color:"#aaa"}),c.text("Save record before uploading files.")):(c.attr("id",n.generateGUID()).css("padding","0px"),new n.FileComponent(c,{model:b.model,row:b.row,displayAs:"filename",storeAs:"field",idField:b.id,deleteable:!0,editable:!0}))}},REFERENCE:{read:function(b,c){if("skuid__Image__c"===b.metadata.ref)return G.FILE.read(b,c),!1;var d=c||0===c?u(b.calculateReferenceText()):"",e='<a href="',f=a.page.sitePrefix;e+=w?'#" onclick="sforce.one.navigateToSObject(\''+c+"');":x?'#" onclick="skuid.ui.openConsoleTabForField(\''+u(b._GUID)+"','"+u(b.model.id)+"','"+c+"');":(f&&"null"!==f?f:"")+"/"+c,e+='" tabindex="-1">'+d+"</a>",D(b,e)},readonly:function(a,b){G.REFERENCE.read(a,b)},edit:function(b,c){if("skuid__Image__c"===b.metadata.ref)return G.FILE.edit(b,c),!1;c||0===c||(c="");var d,e,f,g,h=b.element,i=b.options,j=l("<input>").val(c),k=b.metadata.ref,o=b.metadata.referenceTo,p=-1!=k.indexOf(","),q=0,r=0,s=function(c){var d=a.utils.extractFieldsFromTemplate(i.searchTemplate||i.template);e=b.calculateReferenceMerges({targetObject:c}),f=l("<div>").append(e.merges).text(),g=[],l.each(d,function(a,c){g.push({id:b.metadata.rel&&-1!=c.indexOf(b.metadata.rel)?c.slice(b.metadata.rel.length+1):c})})};if(h.data("recordId",c),p){var v;d=l("<select>").on("change",function(){v=d.val(),h.data("selectedSObject",d.find('option[value="'+v+'"]').attr("data-sobject")),h.data("selectedSObjectPrefix",v),h.data("recordId",""),h.data("recordLabel",""),s(v),b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID});var a=d.next();a.val(""),h.data("recordId",""),h.data("recordLabel",""),"REFPICK"===i.type&&z("",B),l.support.leadingWhitespace?a.focus():setTimeout(function(){a.focus()},400)});var w={},x=[];if(l.each(o,function(a,b){w[b.label+"_"+b.objectName]=b}),l.each(Object.keys(w).sort(),function(a,b){x.push(w[b])}),l.each(x,function(a,c){d["User"===c.objectName&&n.endsWith(b.id,"OwnerId")?"prepend":"append"](l("<option>").attr({value:c.keyPrefix,"data-sobject":c.objectName}).text(c.label))}),h.data("recordId")&&"undefined"!=h.data("recordId")){var y=h.data("recordId").substring(0,3);y&&3===y.length&&h.data("selectedSObjectPrefix",y)}h.data("selectedSObjectPrefix")&&d.val(h.data("selectedSObjectPrefix")),h.data("selectedSObject",d.find('option[value="'+d.val()+'"]').attr("data-sobject"))}else h.data("selectedSObject",k);s(h.data("selectedSObject")),h.data("recordLabel",""===h.data("recordId")?"":f);var z=function(c,d){var e,f=h.data("selectedSObject"),j=n.getNameField(f),k=b.options.searchFields,o=b.options.returnFields;if(k&&k.length||(g&&g.length?(k=[],l.each(g,function(a,b){k.push(b)})):k=[{id:j,displaytype:"STRING",filterable:!0}]),o&&o.length||(o=[],l.each(g,function(a,b){o.push(b)})),b.model){var p;p=b.metadata&&b.metadata.rel?b.metadata.rel+".":"",l.each(k,function(a,c){var d=c.id,e=b.model.getField(p+c.id);e&&(l.extend(c,e),c.id=d)})}var s,t;for(s=k.length-1;s>=0;s--)t=k[s],t.displaytype in m.searchableDisplayTypes||k.splice(s,1);if(i.optionsource){if("model"===i.optionsource){if(e=a.model.getModel(i.optionmodel),!e)return;var u=b.addOrReplaceConditionsForLookupFiltersToModel(e);"REFPICK"===i.type?u&&u.length?e.updateData(function(){d(e)}):d(e):(e.buildSearchCondition(b.id+"_searchbox",c,k,{tokenize:"true"===i.tokenizeSearch,useSOSLSearch:i.useSOSLSearch,SOSLFields:i.SOSLFields,delimiter:i.delimiter,searchOperator:"contains"}),e.updateData(function(){d(e)}))}}else{e=new a.model.Model,e.id="_TempModel_"+(new Date).getTime(),e.fields=o.slice(),e.objectName=f,e.doQuery=!0,e.recordsLimit=50,e.orderByClause=j,e.calloutIterator=q++,e.lastSuccessfulCallout=function(){return r};var v=!1;l.each(o,function(a,b){return b.id==j?(v=!0,!1):void 0}),v||e.fields.push({id:j}),"OwnerId"===b.id&&"Group"===f&&e.addCondition({field:"Type",value:"Queue",inactive:!1}),i.order&&(e.orderByClause=i.order),"recordtype"==f.toLowerCase()&&(e.rTypeFor=b.model.objectName,e.addCondition({field:"SObjectType",value:e.rTypeFor,inactive:!1,type:"fieldvalue"})),b.addOrReplaceConditionsForLookupFiltersToModel(e),c&&e.buildSearchCondition(b.id+"_searchbox",c,k,{tokenize:"true"===i.tokenizeSearch,useSOSLSearch:i.useSOSLSearch,SOSLFields:i.SOSLFields,delimiter:i.delimiter,searchOperator:"contains"}),e.load(function(){r=e.lastSuccessfulCallout,d(e)})}},A=function(a,c){if(a||0===a||""===a){h.data("recordId",a);var d=n.getNameField(h.data("selectedSObject")),e=c.getRowById(a);if(e){var f=c.getRowMergeResult(e,i.searchTemplate||i.template||"{{"+d+"}}",{registerFields:!1}),g=f.merges.text();h.data("recordLabel",g)}e&&d&&"Name"!==d&&"Id"!==d&&!("Name"in e)&&d in e&&(e.Name=e[d]);var j={},k=a;b.metadata&&e&&-1===l.inArray(b.metadata.displaytype,["REFERENCE","ID"])&&e.__templabel&&(k=e.__templabel),j[b.id]=k,k&&(j[b.metadata.rel]=e),b.model.updateRow(b.row,j,{initiatorId:b._GUID})}},B=function(a){j.empty().prop("disabled",!1);var d=!1;b.required&&a.data.length&&!i.addNoneOption||(d=!c,j.append(l("<option>").val("").text(t("select_option_none")).prop("selected",!c)));var e=n.getNameField(h.data("selectedSObject")),f=i.searchTemplate||i.template||"{{"+e+"}}";l.each(a.data,function(b,e){d||(d=c===e.Id);var g=a.mergeRow(e,f,{registerFields:!1}).text();j.append(l("<option>").val(e.Id).text(g).prop("selected",c===e.Id))}),d||!c&&0!==c||j.append(l("<option>").val(c).text(h.data("recordLabel")).prop("selected",!0)),b.required&&!c&&0!==c&&A(j.val(),a),j.off("change.skuid").on("change.skuid",function(){A(l(this).val(),a)})};if("REFPICK"===i.type)j=l("<select>").prop("disabled",!0),j.append(c?l('<option value="">').text(f):l('<option value="">').text(t("select_option_none"))),z("",B);else{j=a.ui.renderers.AUTOCOMPLETE.edit({minLength:2,source:function(a,b,c,d){c(),z(a.term,function(a){h.data("tempmodel",a);var c=n.getNameField(h.data("selectedSObject")),e=i.searchTemplate||i.template||"{{"+c+"}}",f=-1!==e.indexOf("Name}}");l.each(a.data,function(){f&&!this.Name&&c in this&&(this.Name=this[c]),this.__templabel=h.data("tempmodel").mergeRow(this,e,{registerFields:!1}).text()}),b(a.data),d()})},onFocus:function(a,b){return j.val(b.item.__templabel),!1},onChange:function(a,b){return A(b.item.Id,h.data("tempmodel")),j.val(b.item.__templabel),!1},onClose:function(){h.find(":input").focus()},onBlur:function(){setTimeout(function(){j.val(h.data("recordLabel"))},200)},onClear:function(){""!==b.model.getFieldValue(b.row,b.id)&&(b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID}),h.data("recordId",""),h.data("recordLabel",""))},optionRenderer:function(a,b){return l("<li></li>").data("ui-autocomplete-item",b).html("<a>"+u(b.__templabel)+"</a>").appendTo(a)},value:h.data("recordLabel")||c,parentElem:h});var C=h.find(".ui-icon-search").css("cursor","pointer");C.on("click.skuid",function(){var c,d,e,f,g,k=function(){c.dialog("close").remove(),f.unregister&&f.unregister(),a.utils.startsWith(g.id,"_TempModel_")&&g.unregister()};a.snippet.registerSnippet("skuid.__referencepopupselect",function(a){var b,c;a.row?b=a.row:a.component&&a.component.row?b=a.component.row:a.item&&(b=a.item.row),a.model?c=a.model:a.component&&a.component.list&&(c=a.component.list.model),A(b.Id,c),j.val(b.Name),k()}),c=l("<div>").attr("title","Select "+h.data("selectedSObject")),e=l("<div>").css("min-height","300px"),c.append(e),z(j.val(),function(c){a.model.getModel(c.id)||c.register(),g=c;var d,h=i.tokenizeSearch?' tokenizesearch="true"':"",j=b.options.returnFields,k=[],m=b.options.searchFields,o="";j&&j.length?l.each(j,function(a,b){b.showInSearchDialog&&k.push(b)}):k.push({id:n.getNameField(c.objectName)}),m&&m.length||i.useSOSLSearch?(o+="<searchfields"+(i.useSOSLSearch?' usesosl="true"':"")+(i.SOSLFields?' soslfields="'+i.SOSLFields+'"':"")+">",m&&m.length&&l.each(m,function(){o+='<searchfield field="'+this.id+'"/>'}),o+="</searchfields>"):o="",a.mobile?(d='<mobiledeck model="'+c.id+'"'+h+' pagesize="5" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false" precision="1" minwidth="300"  searchconditionname="'+b.id+'_searchbox"><components>',l.each(k,function(a,b){d+='<mobilefield id="'+b.id+'"',d+=b.label?">"+b.label+"</mobilefield>":"/>"}),d+='</components><cardinteractions><interaction type="tap"><actions><action type="custom" snippet="skuid.__referencepopupselect"/></actions></interaction></cardinteractions>'+o+"</mobiledeck>"):(d='<skootable model="'+c.id+'"'+h+' pagesize="5" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false" searchconditionname="'+b.id+'_searchbox"><fields>',l.each(k,function(a,b){d+='<field id="'+b.id+'" allowordering="true"',d+=b.label?">"+b.label+"</field>":"/>"}),d+='</fields><rowactions><action type="custom" label="Select" icon="sk-icon-add-reference" snippet="skuid.__referencepopupselect"/></rowactions>'+o+"</skootable>"),f=a.component.factory({xmlDefinition:d}),e.append(f.element),e.find(".searchbox").focus().select()}),d=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-remove-reference sk-icon inline"},text:"Clear Value",click:function(){b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID}),h.data("recordId",""),h.data("recordLabel",""),k(),j.val("")}},{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:t("cancel"),click:function(){k()}}],c.dialog({close:function(){k()},modal:!0,resizable:!0,width:"90%",buttons:d})})}h.addClass("editable"),h.append(d,j)}},ID:{read:function(a,b){G.TEXT.read(a,b)},readonly:function(a,b){G.ID.read(a,b)},edit:function(b,c){a.model.isNewId(c)&&(c=""),b.metadata.ref=b.model.objectName,G.REFERENCE.edit(b,c)}},STRING:{read:function(a,b){G.TEXT.read(a,b)},readonly:function(a,b){G.TEXT.readonly(a,b)
},edit:function(a,b){G.TEXT.edit(a,b)}}};f.prototype.render=function(){var b,c,d,e=this,f=e.name?e.name:e.id,g=f?e.model.getFieldValue(e.row,f,!0):null,h=e.model.originals[e.row.Id];e.element.empty().removeClass("nx-modified"),(h&&f&&f in h&&h[f]!==g||a.model.isNewId(e.row.Id)&&!e.model.isAggregate)&&e.element.addClass("nx-modified"),e.editable||(e.mode="readonly"),"edit"===e.mode&&e.required?e.element.addClass("required"):e.element.removeClass("required"),e.metadata&&(d=e.metadata.displaytype),e.options.type&&e.options.type in G?b=G[e.options.type]:d&&d in G&&(b=G[d]),c=e.mode,b||(b=G.TEXT),!b||c in b||(c="read",c in b||(b=G.TEXT)),b[c](e,g)},f.prototype.destroy=function(){this.unregister(),this.element&&l(this.element).remove()},f.prototype.handleUpdate=function(a,b){this.handleChange(a,b)},f.prototype.handleChange=function(a,b){var c=this,d=c.model,e=c.row,f=c.id,g=c.options,h=g.controllingFields;if(h&&h.length&&b&&-1!==l.inArray(b,h)){var i=!1,j=d.getFieldValue(e,f,!0),k=c.metadata&&-1!==l.inArray(c.metadata.displaytype,["PICKLIST","MULTIPICKLIST"])?c.getValidPicklistEntries():!1;k&&l.each(k,function(a,b){return j===b.value?(i=!0,!1):void 0}),i||d.updateRow(e,f,"",{initiatorId:c.uid()})}c.render()};var H=function(a,b,c){if(a){var d,e=function(){sforce.console.openPrimaryTab(null,a,!0,v(b))},f=l.Deferred(),g=function(a,b,e){var f={tabsProcessed:0};a&&(f.numTabs=a.length,f.numTabs?l.each(a,function(a,h){sforce.console.getPageInfo(h,function(a){if("resolved"!==e.state())if(a.success){var i=JSON.parse(a.pageInfo);i&&c&&c(i)?(d={id:h},b&&(d.parentTabId=b),e.resolve()):b?sforce.console.getSubtabIds(h,function(a){if(a.success&&a.ids&&a.ids.length){var b=l.Deferred();g(a.ids,!1,b),l.when(b).then(function(){++f.tabsProcessed===f.numTabs&&e.resolve()})}else++f.tabsProcessed===f.numTabs&&e.resolve()}):++f.tabsProcessed===f.numTabs&&e.resolve()}else++f.tabsProcessed===f.numTabs&&e.resolve()})}):e.resolve())};sforce.console.getPrimaryTabIds(function(a){g(a.ids,null,f)}),l.when(f).then(function(){if(d){var a=d.parentTabId?d.parentTabId:d.id;sforce.console.focusPrimaryTabById(a,function(a){a.success?d.parentTabId&&sforce.console.focusSubtabById(d.id,function(){}):e()})}else e()})}},I=function(a,b){H(a,b,function(b){return b&&n.endsWith(b.url,a)})},J=function(a,b){H("/"+a,b,function(b){return b&&(b.objectId===a||a&&18===a.length&&b.objectId===a.substring(0,15))})},K=function(b,c){var d=a.model.getModel(v(c));J(b,d.getNameFieldValueForRow(d.getRowById(b)))},L=function(b,c,d){var e=a.model.getModel(v(c)),f=e?e.registeredFields[v(b)]:null;f&&"REFERENCE"===f.metadata.displaytype&&J(d,d||0===d?u(f.calculateReferenceText()):"")},M={ID:1,STRING:1,TEXT:1,EMAIL:1,PICKLIST:1,MULTIPICKLIST:1,COMBOBOX:1,PHONE:1,URL:1,REFERENCE:1,TEXTAREA:1};m.Editor=c,m.List=d,m.Item=e,m.Field=f,m.Queue=h,m.renderers=A,m.fieldRenderers=G,m.createFieldSet=i,m.setStatus=j,m.hideStatus=k,m.searchableDisplayTypes=M,m.click2Dial=E,m.openConsoleTabForField=L,m.openConsoleTabForNameField=K,m.openConsoleTabForUrl=I,m.openConsoleTabForRow=J,m.isTouchDevice=b,m._createLookupFiltersFromXML=y}(skuid),function(a){var b=a.$,c=a.utils,d=a.model.getModel,e=a.hotkeys={},f=a.actions={},g=a.interactions={},h={},i={},j={swipe:"drag",swipeleft:"dragleft",swiperight:"dragright",swipeup:"dragup",swipedown:"dragdown"},k=f.register=function(a){b.extend(h,a)},l=f._getContextToUse=function(a,c){var d={};return a&&a.context&&b.extend(d,a.context),c&&b.extend(d,c),d.model||(a&&a.model?d.model=a.model:a&&a.list&&a.list.model&&(d.model=a.list.model)),d.row||(d.item&&d.item.row?d.row=d.item.row:a&&a.row?d.row=a.row:a&&a.item&&a.item.row&&(d.row=a.item.row)),d.list||a&&a.list&&(d.list=a.list),d},m=function(c,d,e,f){var g=d.attr("model"),h=g?a.model.getModel(g):null,i=l(e,f),j=i.row,k=i.list,m=k?b.map(k.getSelectedItems(),function(a){return a.row}):!1;j&&h&&h.getRowById(j.Id)?h[c]([j]):m&&m.length&&h&&k&&k.model===h?h[c](m):h&&h.data.length&&h[c](h.data)},n=c.isPromise;g.register=function(a){b.each(a,function(){i[this]=1})},g.processInteractionsNode=function(a,c,d){a.children().each(function(){g.processInteractionNode(b(this),c,d)})},g.processInteractionNode=function(a,c,d){if(!a||!a.children)return!1;var e=a.attr("type"),g=a.children("actions").first();return e in i==!1?!1:void(d&&d.selector?c.element.on(e,d.selector,function(a){var d=b(this),e=d&&d.data?d.data("component"):null;e||(e=c),f.runActionsNode(g,e),a&&a.gesture&&a.gesture.preventDefault()}):(c.element.on(e,function(a){f.runActionsNode(g,c),a&&a.gesture&&a.gesture.preventDefault()}),j[e]&&c.element.on(j[e],function(a){a.gesture.stopPropagation(),a.gesture.preventDefault()})))},f.runActionsNode=function(c,d,e){var g,h=b.Deferred(),i="true"===c.attr("continuesequenceonerror"),j=c.children(),k=j.length,l=0,m=function(c){if(l===k)return a.mobile&&a.mobile.processResponsiveElements(),void h.resolve(c);g=j.eq(l++);var e=f.runActionNode(g,d,c),i=function(a){var b=g.children("onerroractions").children();b.length?(j=b,k=b.length,l=0,g=null,m(a)):o(a)};if(e===!1)i(c);else if(e&&(e.deferred&&n(e.deferred)||n(e))){var p=e.deferred?e.deferred:e;b.when(p).then(function(a){m(b.extend(c,a))},function(a){i(b.extend(c,a))})}else m(e?b.extend(c,e):c)},o=function(b){i?m(b):(a.mobile&&a.mobile.processResponsiveElements(),h.reject(b))};return k?m(e):h.resolve(),d&&d.xmlDefinition&&d.xmlDefinition.attr("buttonset")&&(b(".sm-buttonset-"+d.xmlDefinition.attr("buttonset")).removeClass("sm-active"),d.element.addClass("sm-active")),h.promise()},f.runActionNode=function(b,c,d){var e,f,g,i=b.attr("type");return i&&(i in h?e=h[i]:c&&c.type()&&(f=a.componentType.get(c.type()),g=f.actions,g&&i in g&&(e=g[i])),e)?e(b,c,d):void 0},k({blockUI:function(a,d,e){var f={},g=a.attr("message"),h=a.attr("timeout");g&&(f.message=c.mergeAsTextInContext(g,l(d,e))),h&&(f.timeout=parseInt(h,10)),b.blockUI(f)},unblockUI:function(){b.unblockUI()},save:function(c,e,f){var g=[],h=c.children("models").first(),i=c.attr("model"),j="true"===c.attr("rollbackonanyerror"),k=b.Deferred(),l=f?f.initiatorId:null,m={rollbackOnAnyError:j};if(l&&(m.initiatorId=l),h.length)b.each(h.children("model"),function(){var a=d(b(this).text());a&&g.push(a)});else if(i&&d(i)){var n=d(i);g.push(n)}return e&&e.button&&e.button.startProcessing(),b.when(a.model.save(g,m)).then(function(a){a.totalsuccess?k.resolve(a):k.reject(a),e&&e.button&&e.button.stopProcessing()},function(a){k.reject(a),e&&e.button&&e.button.stopProcessing()}),k.promise()},cancel:function(c){var e=[],f=c.children("models").first(),g=c.attr("model");f.length?b.each(f.children("model"),function(){var a=d(b(this).text());a&&e.push(a)}):g&&d(g)&&e.push(d(g)),a.model.cancel(e)},markRowsForDeletion:function(a,b,c){m("deleteRows",a,b,c)},unmarkRowsForDeletion:function(a,b,c){m("undeleteRows",a,b,c)},createRow:function(a,e,f){var g=a.attr("model"),h=d(g),i=l(e,f),j=i.model,k=i.row,m=i.list,n=i.rows,o={},p="append"===a.attr("appendorprepend"),q="edit"===a.attr("defaultmodefornewitems"),r=a.children("defaults").first().children();if(h){var s=function(a,d){var e,f=[],g={createFields:!1,registerFields:!1},i={row:a,model:d};return m&&m.model===h&&(e=m.conditions,e&&e.length&&b.each(e,function(){f.push(this)})),r&&r.length&&r.each(function(){var a=b(this),d=a.attr("field"),e=a.attr("value"),h=c.mergeAsTextInContext(e,i,g);f.push({field:d,value:h})}),h.createRow({additionalConditions:f,doAppend:p,editModeForNewItems:q})},t=[];return k?t.push(s(k,j)):n&&n.length?b.each(n,function(a,b){t.push(s(b,j))}):t.push(s(null,j)),t.length&&(1===t.length?o.row=t[0]:o.rows=t),o}},adoptRows:function(a){var b,c,e=a.attr("sourcemodel"),f=a.attr("targetmodel");e&&(b=d(e)),f&&(c=d(f)),b&&c&&b.data&&b.data.length&&c.adoptRows(b.data)},updateRow:function(e,f,g){var h,i,j,k,m=e.attr("fieldmodel"),n=e.attr("field"),o=e.attr("value"),p=l(f,g),q=p.list,r=p.rows,s=p.model,t=p.row;m&&(h=d(m)),!s&&q&&(s=q.model),h&&(i=h.getField(n),i&&(j=i.displaytype));var u=function(b,d){var e,f,g,h={};if("REFERENCE"===j){f=c.getReferenceFieldRelationshipName(n);var i,k,l=c.extractFieldsFromTemplate(o);if(l&&1===l.length)if(i=l[0],c.startsWith(i,"$Model.")&&c.contains(i,".data.")){k=i.split(".");var m,p=k[1],q=parseInt(k[3],10),r=i.indexOf("."+k[3]+".")+2+k[3].length,s=i.substring(r,i.length),t=a.$M(p);t&&(m=t.data[q],m&&(g="Id"===s?m:t.getFieldValue(m,c.getReferenceFieldRelationshipName(s),!0)))}else g="Id"===i?b:d.getFieldValue(b,c.getReferenceFieldRelationshipName(i),!0)}return o&&(e=a.utils.mergeAsTextInContext(o,{model:d,row:b},{createFields:!1,registerFields:!1})),"BOOLEAN"!==j&&j||(e&&"false"!==e?"true"===e&&(e=!0):e=!1),h[n]=e,f&&g&&(h[f]=g),h};h&&(t&&h.getRowById(t.Id)?h.updateRow(t,u(t,s)):r&&r.length&&q&&q.model===h?(k={},b.each(r,function(a,b){k[b.Id]=u(b,q.model)}),c.size(k)&&h.updateRows(k)):(k={},b.each(h.data,function(a,b){k[b.Id]=t?u(t,s):u(b,h)}),c.size(k)&&h.updateRows(k)))},requeryModel:function(a,c){var e=a.attr("model"),f=b.Deferred();if(e){var g=d(e);if(g){c&&c.button&&c.button.startProcessing(),g.hasChanged&&g.cancel();var h="loadmore"!==a.attr("behavior")?"updateData":"getMoreData";b.when(g[h]()).then(function(a){f.resolve(a),c&&c.button&&c.button.stopProcessing()},function(a){f.reject(a),c&&c.button&&c.button.stopProcessing()})}}return f.promise()},requeryModels:function(c,e){var f=[],g=c.children("models").first(),h=b.Deferred();g.length&&b.each(g.children("model"),function(){var a=d(b(this).text());a&&f.push(a)}),e&&e.button&&e.button.startProcessing(),b.each(f,function(){this.hasChanged&&this.cancel()});var i="loadmore"!==c.attr("behavior")?"updateData":"getMoreData";return b.when(a.model[i](f)).then(function(a){h.resolve(a),e&&e.button&&e.button.stopProcessing()},function(a){h.reject(a),e&&e.button&&e.button.stopProcessing()}),h.promise()},emptyModelData:function(a){var c=a.children("models").first();c.length&&b.each(c.children("model"),function(){var a=d(b(this).text());a&&a.emptyData()})},redirect:function(a,d,e){c.redirect(b.extend(l(d,e),{url:a.attr("url"),window:a.attr("window")}))},custom:function(c,d,e){var f,g,h=a.snippet.get(c.attr("snippet"));if(h){if(f=l(d,e),b.extend(f,{component:d,context:e}),g=h(f),g===!1)return!1;if(g&&"object"==typeof g)return g}},publish:function(b,c){a.events.publish(b.attr("event"),[c])},setCondition:function(a,b,e){var f=d(a.attr("model"));if(!f)return!1;var g=f.getConditionByName(a.attr("condition"),!0);if(!g)return!1;var h,i,j,k=l(b,e),m=a.attr("value");h=k.model,i=k.row,!h&&b&&b.model&&(h=b.model),h||(h=f),i||(b&&b.row&&(i=b.row),!i&&h&&(i=h.getFirstRow())),j=c.mergeAsTextInContext(m,{model:h,row:i},{createFields:!1,registerFields:!1}),f.setCondition(g,j)},deactivateCondition:function(a){var b=d(a.attr("model"));if(!b)return!1;var c=b.getConditionByName(a.attr("condition"));c&&b.deactivateCondition(c)},activateCondition:function(a){var b=d(a.attr("model"));if(!b)return!1;var c=b.getConditionByName(a.attr("condition"));c&&b.activateCondition(c)}});var o,p={},q=function(a){var b=a.bindString,c=p[b]||(p[b]={});c[a.componentId]=a},r=function(a){b.each(p,function(b,c){c&&a in c&&delete c[a]})};e.bind=function(a,d,e,f){var g=a.children();g.length&&b(function(){o||(o=b(document)),b.each(g,function(){var a=b(this),g=a.attr("key"),h=a.attr("modifiers"),i="true"===a.attr("ignoretextinputs"),j=(h?h.replace(",","+")+"+":"")+g,k={componentId:d,bindString:j,visibleElement:f,actionFunction:e};q(k),o.on("keydown."+d,null,{keys:j,filterTextInputs:i},function(a){if(f&&f.is(":visible")&&e){var d,g=p[j],h=k;g&&c.size(g)>1&&(d=function(a){var b,c=a.visibleElement,d=-1;return c&&c.length?(b=c&&c.closest&&c.closest(".ui-dialog-content"),b.length?d=b.zIndex():c.closest("body").length||(d=-2)):d=-2,a.zIndex=d,d},d(k),b.each(g,function(a,b){h.componentId!==a&&b!==h&&b.actionFunction&&d(b)>h.zIndex&&(h=b)})),a.preventDefault(),a.stopImmediatePropagation(),h.actionFunction()}})})})},e.unbind=function(a){o||(o=b(document)),o.off("keydown."+a),r(a)}}(skuid),function(a){var b,c=a.mobile={},d=a.utils,e=a.actions,f=a.interactions,g=a.$;c.mainarea,c.headernavwrapper=g("<div>").addClass("sm-headerwrapper"),c.toppanelarea=g("<div>").addClass("sm-toppanelwrapper"),c.headernavarea=g("<div>").addClass("sm-headerarea"),c.headernavwrapper.append(c.toppanelarea,c.headernavarea),c.popupwrapper=g("<div>").addClass("sm-popupwrapper"),c.popuptitle=g("<div>").addClass("sm-popupcontent-title"),c.popupcontentwrapper=g("<div>").addClass("sm-popupcontent"),c.popupcontent=g("<div>").addClass("sm-popupcontent-body"),c.footernavarea=g("<div>").addClass("sm-footerwrapper"),c.panelarea=g("<div>").addClass("sm-panelwrapper"),c.mainpanel,c.leftpanels=[],c.rightpanels=[],c.toppanel,c.popuppanel,c.panelMap={},c.panels=[],c.windowWidth,c.isAnimating=!1,b=["tap","hold","doubletap","pinch","pinchin","pinchout","swipeleft","swiperight","swipedown","swipeup","swipe","drag"],c.config={},c.config.validInteractions=b,c.config.defaultLeftPanelWidth=300,c.config.minSidePanelPercent=.75,c.config.resizeWaitTime=100,c.config.defaultAnimationSpeed=500,a.interactions.register(b),g(window).load(function(){c.setSizeCaches(),c.panels.length&&c.setMainPanel(c.panels[0]),c.mainarea.removeClass("sm-mainwrapper-hide"),a.events.publish("skuidMobileReady")}),c.handleResize=function(){c.setSizeCaches(),c.processResponsiveElements()},c.setSizeCaches=function(){c.windowWidth=g(window).width()},d.addResizeHandler(c.handleResize,c.config.resizeWaitTime),c.dumbFitAlgorithm=a.responsive.dumbFitAlgorithm,c.processResponsiveElements=function(){c.processResponsivePanels(),c.processResponsiveArea(c.headernavarea),c.processResponsiveArea(c.footernavarea),c.processResponsiveArea(c.popupcontent),c.processResponsiveArea(c.toppanelarea),c.processResponsiveArea(c.panelarea)},c.processResponsivePanels=function(){var a=c.mainpanel,b=a.element,d=a.xmlDefinition.attr("minwidth"),e=0,f=0;g.each(c.leftpanels,function(a){var b=this;if(b.offset=f+e,b.width=b.preferredwidth||c.config.defaultLeftPanelWidth,b.width>.75*c.windowWidth&&(b.width=.75*c.windowWidth),"push"===b.displaymode||"fit"===b.displaymode)if("push"===b.displaymode&&d&&d>c.windowWidth-b.width-b.offset)if(0===a)f+=b.width;else{var g=c.leftpanels[a-1];"fit"!==g.displaytype&&(b.offset=g.offset,f-=g.width,f+=b.width)}else e+=b.width;b.element.css("width",b.width+"px"),b.element.css("left",b.offset+"px")}),b.css({left:f||"","border-left":e?e+"px solid white":""})},c.processResponsiveArea=function(a){c.processResponsiveGrids(a),c.processResponsiveButtons(a),c.positionPanelWrapper()},c.processResponsiveGrids=function(a){a=a||g(document.body),a.filter(".sm-grid").add(a.find(".sm-grid")).each(function(){c.processGrid(g(this))})},c.processGrid=a.responsive.processGrid,c.processResponsiveButtons=function(a){a=a||g(document.body),a.filter(".sm-button").add(a.find(".sm-button")).each(function(){c.processButton(g(this))})},c.processButton=function(a){var b=a.find(".sm-button-text"),c=a.data("fullwidth");c||(c=a.children().first()[0].scrollWidth+14,a.data("fullwidth",c)),c>a[0].clientWidth?b.addClass("sm-button-text-hidden"):b.removeClass("sm-button-text-hidden")},c.positionPanelWrapper=function(){c.panelarea.css("border-top",c.headernavarea.outerHeight()+"px solid white"),c.panelarea.css("border-bottom",c.footernavarea.outerHeight()+"px solid white")},c.setMainPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.mainpanel;if(a===d)return!1;var e=b.transition;if(c.panelarea.append(a.element),e){if("slideleft"===e||"slideright"===e){c.isAnimating=!0;var f=c.windowWidth,g=("slideleft"===e?"":"-")+f+"px",h=("slideleft"===e?"-":"")+f+"px",i=("slideleft"===e?"-":"")+f+"px",j=("slideleft"===e?"":"-")+f+"px";a.element.css({left:g,right:h}),a.element.removeClass("sm-panel-hidden"),d.element.animate({left:i,right:j},c.config.defaultAnimationSpeed),a.element.animate({left:"0px",right:"0px"},c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.setMainPanel(a)})}}else d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-primary"),d&&d.element.css({width:"",left:"",right:""}),d&&d.element.detach(),a.element.addClass("sm-panel-primary").removeClass("sm-panel-hidden"),c.mainpanel=a,c.processResponsiveElements()},c.addLeftPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.leftpanels.indexOf(a);if(a===c.mainpanel)return!1;if(-1!==d)return!1;a.position=b.position,a.displaymode=b.displaymode||"push";var e;b.replace===!0&&c.leftpanels.length&&(e=0===a.position||a.position&&"edge"!==a.position?c.leftpanels[a.position]:c.leftpanels[c.leftpanels.length-1],e&&c.removeLeftPanel(e)),a.preferredwidth=parseInt(a.xmlDefinition&&a.xmlDefinition.attr("preferredwidth")||c.config.defaultLeftPanelWidth,10),0===a.position||a.position&&"edge"!==a.position?(c.leftpanels.length<a.position&&(a.position=c.leftpanels.length),c.leftpanels.splice(a.position,0,a)):c.leftpanels.push(a),c.panelarea.append(a.element),a.element.addClass("sm-panel-left").removeClass("sm-panel-hidden"),b.preventProcessing||c.processResponsiveElements()},c.removeLeftPanel=function(a,b){if(c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.leftpanels.indexOf(a);return-1===d?!1:(b||(b={}),a.element.detach(),a.element.addClass("sm-panel-hidden").removeClass("sm-panel-left sm-panel-left-sliding"),a.element.css({width:"",left:"",right:""}),c.leftpanels.splice(d,1),c.mainpanel.element.removeClass("sm-panel-primary-fit sm-panel-primary-pushed sm-panel-primary-pushing"),c.mainpanel.element.css({left:"","border-left":""}),void(b.preventProcessing||c.processResponsiveElements()))},c.setLeftPanel=function(a,b){c.hideLeftPanel({preventProcessing:!0}),c.addLeftPanel(a,b)},c.hideLeftPanel=function(a){var b=[];g.each(c.leftpanels,function(){b.push(this)}),g.each(b,function(){c.removeLeftPanel(this)}),a&&a.preventProcessing||c.processResponsiveElements()},c.toggleLeftPanel=function(a,b){b||(b={}),"string"==typeof a&&(a=c.panelMap[a]),-1!==c.leftpanels.indexOf(a)?c.removeLeftPanel(a,b):c.addLeftPanel(a,b)},c.setTopPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.toppanel;if(a===d)return!1;if(a===c.mainpanel)return!1;var e=b.transition;d&&(e=null),d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-top"),c.toppanelarea.append(a.element),e?"slide"===e&&(c.isAnimating=!0,a.element.addClass("sm-panel-top-sliding").removeClass("sm-panel-hidden").hide(),a.element.slideDown(c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.setTopPanel(a)})):(d&&d.element.detach(),a.element.addClass("sm-panel-top").removeClass("sm-panel-hidden sm-panel-top-sliding"),c.toppanel=a)},c.hideTopPanel=function(a){if(a||(a={}),c.isAnimating)return!1;var b=c.toppanel;return b?void(a.transition?"slide"===a.transition&&(c.isAnimating=!0,b.element.addClass("sm-panel-top-sliding"),b.element.slideUp(c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.hideTopPanel()})):(b&&b.element.detach(),b&&b.element.addClass("sm-panel-hidden").removeClass("sm-panel-top sm-panel-top-sliding"),c.toppanel=null)):!1},c.toggleTopPanel=function(a,b){b||(b={}),"string"==typeof a&&(a=c.panelMap[a]),a===c.toppanel?c.hideTopPanel(b):c.setTopPanel(a,b)},c.setPopupPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),a instanceof g&&(a={element:a}),!a.element)return!1;var d=c.popuppanel;if(a===d)return!1;if(a===c.mainpanel)return!1;var e=b.transition;if(b.title&&(c.popuptitle.empty(),"string"==typeof b.title?c.popuptitle.text(b.title):b.title&&b.title(c.popuptitle)),d&&(e=null),d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-popup"),d&&d.element.css({width:"",left:"",right:""}),a.element.addClass("sm-panel-popup").removeClass("sm-panel-hidden"),c.popupcontent.append(a.element),b.noPadding?c.popupcontent.css("padding","0px"):c.popupcontent.css("padding",""),e){if("slideleft"===e||"slideright"===e){c.isAnimating=!0;var f=c.windowWidth,h=("slideleft"===e?"":"-")+f+"px",i=("slideleft"===e?"-":"")+f+"px";c.popupcontentwrapper.css({left:h,right:i}),c.popupwrapper.removeClass("sm-popupwrapper-hidden"),c.popupcontentwrapper.animate({left:"0px",right:"0px"},c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.setPopupPanel(a)})}}else d&&d.element.detach(),c.popupwrapper.removeClass("sm-popupwrapper-hidden"),c.popuppanel=a},c.hidePopupPanel=function(a){if(a||(a={}),c.isAnimating)return!1;var b=c.popuppanel;return b?(b&&b.element.detach(),b&&b.element.addClass("sm-panel-hidden").removeClass("sm-panel-popup"),b&&b.element.css({width:"",left:"",right:""}),c.popuppanel=null,c.popuptitle.empty(),void c.popupwrapper.addClass("sm-popupwrapper-hidden")):!1},c.toggleSetupMenu=function(){c.toggleTopPanel("skuidmobilesetupmenu",{transition:"slide"}),c.processResponsiveArea(c.panelMap.skuidmobilesetupmenu.element)},c.addTransition=function(a,b){a.removeClass(function(a,b){return(b.match(/\bsm-transition-\S+/g)||[]).join(" ")}),a.addClass("sm-transition-"+b)},c.processStylesNode=function(a,b){var c={};a.children().each(function(){var a=g(this);c[a.attr("property")]=a.attr("value")}),b.element.css(c)},c.processInteractionsNode=f.processInteractionsNode,c.processInteraction=f.processInteractionNode,c.runActionsNode=e.runActionsNode,c.runAction=e.runActionNode,e.register({setLeftPanel:function(a){c.setLeftPanel(a.attr("panel"),{transition:"slide"})},hideLeftPanel:function(){c.hideLeftPanel({transition:"slide"})},toggleLeftPanel:function(a){c.toggleLeftPanel(a.attr("panel"),{transition:"slide",position:a.attr("position"),replace:"true"===a.attr("replace")})},toggleSetupMenu:function(){c.toggleSetupMenu()},setMainPanel:function(b){a.mobile.setMainPanel(b.attr("panel"))},setPopupPanel:function(a,b,f){c.setPopupPanel(a.attr("panel"),{transition:"slideleft",title:d.mergeAsTextInContext(a.attr("title"),e._getContextToUse(b,f))})},hidePopupPanel:function(){c.hidePopupPanel()}})}(skuid),function(a){var b=a.$,c=function(a){this.options=a||{},this.element=a.element||b("<div>");var c=b("<div>").addClass("sm-button-inner");this.element.addClass("list"===a.style?"sm-liststyle":"sm-navstyle"),a.icon&&(this.icon=b("<i>").addClass("sm-button-icon fa "+a.icon+" fa-fw fa-1x"),a.iconColor&&this.icon.css("color",a.iconColor)),a.label&&(this.text=b("<div>").addClass("sm-button-text").text(a.label)),a.buttonset&&this.element.addClass("sm-buttonset-"+a.buttonset),this.icon&&c.append(this.icon),this.text&&c.append(this.text),this.element.append(c),a.tooltip&&this.element.skootip(a.tooltip,{position:{my:"left center",at:"right center",collision:"flip",using:function(a,c){b(this).css(a).addClass(c.vertical).addClass(c.horizontal),b("<div>").addClass("tooltip-arrow").appendTo(this)}},show:!1,hide:!1})};c.prototype.startProcessing=function(){this.icon&&this.icon.addClass("fa-refresh fa-spin"),this.element.addClass("sm-processing"),this.icon&&this.icon.removeClass(this.options.icon)},c.prototype.stopProcessing=function(){this.icon&&this.icon.addClass(this.options.icon),this.element.removeClass("sm-processing"),this.icon&&this.icon.removeClass("fa-refresh fa-spin")},a.mobile.ui={Button:c}}(skuid);